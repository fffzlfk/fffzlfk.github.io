<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>算法（第四版） | fffzlfk's Blog</title><meta name=keywords content="Java,Academic"><meta name=description content="The solution of algs4&rsquo;s exercise"><meta name=author content="fffzlfk"><link rel=canonical href=https://fffzlfk.github.io/posts/algorithm4th/><link crossorigin=anonymous href=/assets/css/stylesheet.3b1cc03af9890a9e14762cb10779f50b165a8e12a4ff763213eef0019f3771fb.css integrity="sha256-OxzAOvmJCp4UdiyxB3n1CxZajhKk/3YyE+7wAZ83cfs=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.ab916b8151320cc693135f5df9fe4b75e6e4754d8f0dff5782df332cacd1ba8e.js integrity="sha256-q5FrgVEyDMaTE19d+f5LdebkdU2PDf9Xgt8zLKzRuo4=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://fffzlfk.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://fffzlfk.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://fffzlfk.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://fffzlfk.github.io/apple_touch_icon.png><link rel=mask-icon href=https://fffzlfk.github.io/favicon.ico><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css integrity=sha384-MlJdn/WNKDGXveldHDdyRP1R4CTHr3FeuDNfhsLPYrq2t0UBkUdK2jyTnXPEK1NQ crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.js integrity=sha384-VQ8d8WVFw0yHhCk5E8I86oOhv48xLpnDZx5T9GogA/Y84DcCKWXDmSDfn13bzFZY crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/contrib/auto-render.min.js integrity=sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR crossorigin=anonymous></script>
<script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}],throwOnError:!1})})</script><meta property="og:title" content="算法（第四版）"><meta property="og:description" content="The solution of algs4&rsquo;s exercise"><meta property="og:type" content="article"><meta property="og:url" content="https://fffzlfk.github.io/posts/algorithm4th/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-10-09T00:00:00+00:00"><meta property="article:modified_time" content="2020-10-09T00:00:00+00:00"><meta property="og:site_name" content="fffzlfk's Blog"><meta name=twitter:card content="summary"><meta name=twitter:title content="算法（第四版）"><meta name=twitter:description content="The solution of algs4&rsquo;s exercise"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://fffzlfk.github.io/posts/"},{"@type":"ListItem","position":3,"name":"算法（第四版）","item":"https://fffzlfk.github.io/posts/algorithm4th/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"算法（第四版）","name":"算法（第四版）","description":"The solution of algs4\u0026rsquo;s exercise","keywords":["Java","Academic"],"articleBody":"Union-Find quickfind Java implementation public class QuickFindUF { private int[] id; private int count; public QuickFindUF(int n) { id = new int[n]; for (int i = 0; i \u003c n; i++) id[i] = i; count = n; } public int count() { return count; } public int find(int p) { return id[p]; } public boolean connected(int p, int q) { return find(p) == find(q); } public void union(int p, int q) { int pid = find(p); int qid = find(q); if (pid != qid) { for (int i = 0; i \u003c id.length; i++) if (id[i] == pid) { id[i] = qid; } } count--; } public static void main(String[] args) { Scanner in = new Scanner(System.in); QuickFindUF uf = new QuickFindUF(10); while (in.hasNext()) { int p = in.nextInt(), q = in.nextInt(); if (uf.connected(p, q)) continue; uf.union(p, q); } } } analysis The find() operation is certainly quick, as it only accesses the id[] array once in order to complete the operation. But quick-find is typically not useful for large problems because union() needs to scan through the whole id[] array for each input pair.\nquick-union implementation import java.util.Scanner; public class QuickUnionUF { private int[] id; private int count; public QuickUnionUF(int n) { id = new int[n]; for (int i = 0; i \u003c n; i++) id[i] = i; count = n; } public int count() { return count; } public int find(int p) { while (p != id[p]) { p = id[p]; } return p; } public boolean connected(int p, int q) { return find(p) == find(q); } public void union(int p, int q) { int pRoot = find(p); int qRoot = find(q); if (pRoot != qRoot) { id[pRoot] = qRoot; } else return; count--; } public static void main(String[] args) { Scanner in = new Scanner(System.in); QuickUnionUF uf = new QuickUnionUF(10); while (in.hasNext()) { int p = in.nextInt(), q = in.nextInt(); if (uf.connected(p, q)) continue; uf.union(p, q); } } } quick-union worst case Weighted quick-union import java.util.Scanner; public class WeightedQuickUnionUF { private int[] id; private int[] sz; private int count; public WeightedQuickUnionUF(int N) { count = N; id = new int[N]; sz = new int[N]; for (int i = 0; i \u003c N; i++) { id[i] = i; } for (int i = 0; i \u003c N; i++) sz[i] = 1; } public int find(int p) { while (p != id[p]) { id[p] = id[id[p]]; // path compression by halving p = id[p]; } return p; } public boolean connected(int p, int q) { return find(p) == find(q); } public void union(int p, int q) { int i = find(p); int j = find(q); if (i == j) return; if (sz[i] \u003c sz[j]) { id[i] = j; sz[j] += sz[i]; } else { id[j] = i; sz[i] += sz[j]; } count--; } public static void main(String[] args) { Scanner in = new Scanner(System.in); WeightedQuickUnionUF uf = new WeightedQuickUnionUF(10); while (in.hasNext()) { int p = in.nextInt(), q = in.nextInt(); if (uf.connected(p, q)) continue; uf.union(p, q); } } } Performance characteristics of union-find algorithms algorithm constructor union find quick-find N N 1 quick-union N tree height tree height weighted quick-union N lgN lgN weighted quick-union with path compression N very, very nearly, but not quite 1 same as union impossible N 1 1 Analysis of Algorithms Scientific method The very same approach that scientists use to understand the natural world is effective for studying the running time of programs.\nObserve some feature of the natural world, generally with precise measurement. Hypothesize a model that is consistent with observations. Predict events using the hypothesis. Verify the predictions by making further observations. Valitate by repeating until the hypothesis and observations agree. Mathematical models Tilde approximations. We use tilde approximations, where we throw away low-order terms that complicate formulas. We write ~f(N) to represent any function that when divided by f(N) approaches 1 as N grows. We write g(N)~f(N) to indicate that g(N)/f(N) approaches 1 as N grows. Order-of-growth classifications. Most often, we work with tilde approximations of the form g(N)~af(N) where $ f(N) = N^b log_c N $ and refer to f(N) as the The order of growth of g(N). We use just a few structural primitives (statements, conditionals, loops, nesting, and method calls) to implement algorithms, so very often the order of growth of the cost is one of just a few functions of the problem size N. function tilde approximation order of growth $ \\frac{N^3}{6}-\\frac{N^2}{2}+\\frac N 3 $ $~\\frac{N^3}{6} $ $N^3$ $ \\frac{N^3}{2}-\\frac N 2$ $ ~\\frac{N^2}{2} $ $N^2$ $lgN+1 $ $~lgN$ $lgN$ 3 ~3 1 Cost model. We focus attention on properties of algorithms by articulating a cost model that defines the basic operations. For example, an appropriate cost model for the 3-sum problem is the number of times we access an array entry, for read or write. Commonly-used Notations in the Theory of Algorithms notation provides example shorthand for used to Big Theta asympatotic order of growth $ \\Theta (N^2) $ $\\frac 1 2 N^2, 5N^2+22NlogN+3N$ classify algorithms Big Oh $\\Theta (N^2)$and smaller $O(N^2)$ $10N^2,\\ 100N, 22NlogN+3N $ develop upper bounds Big Omega $\\Theta (N^2)$and larger $\\Omega (N^2)$ $\\frac 1 2 N^2, N^5, N^3+22NlogN+3N $ develop lower bounds 1.4.6 Give the order of growth (as a function of N ) of the running times of each of the following code fragments:\nint sum = 0; for (int n = N; n \u003e 0; n /= 2) for(int i = 0; i \u003c n; i++) sum++; $$ N+\\frac N 2+\\frac N 4+\\frac N 8+…+1=2N-1\\ \\ \\sim 2N $$ 所以是线性\nint sum = 0; for (int i = 1 i \u003c N; i *= 2) for (int j = 0; j \u003c i; j++) sum++; $$ 1+2+4+8+…+2^{\\lfloor lgN \\rfloor}=2^{\\lfloor lgN \\rfloor + 1}-1\\ \\ \\sim 2N$$ 所以是线性\nint sum = 0; for (int i = 1 i \u003c N; i *= 2) for (int j = 0; j \u003c N; j++) sum++; $$ NlgN $$ 线性对数\n1.4.15 Faster 3-sum. As a warmup, develop an implementation TwoSumFaster that uses a linear algorithm to count the pairs that sum to zero after the array is sorted (in stead of the binary-search-based linearithmic algorithm). Then apply a similar idea to develop a quadratic algorithm for the 3-sum problem.\npublic static int twoSumFaster(int[] a) { int lo = 0, hi = a.length - 1; int cnt = 0; while (lo \u003c hi) { if (a[lo] + a[hi] == 0) { cnt++; lo++; hi--; } else if (a[lo] + a[hi] \u003e 0) hi--; else lo++; } return cnt; } public static int threeSumFaster(int[] a) { int cnt = 0; for (int i = 0; i \u003c a.length; i++) { int lo = i + 1, hi = a.length - 1; while (lo \u003c hi) { if (a[i] + a[lo] + a[hi] == 0) { cnt++; lo++; hi--; } else if (a[i] + a[lo] + a[hi] \u003e 0) hi--; else lo++; } } return cnt; } MegerSort Implementation public class Merge { private static boolean isSorted(Comparable[] a, int lo, int hi) { for (int i = lo + 1; i \u003c= hi; i++) if (less(a[i], a[i - 1])) return false; return true; } private static boolean less(Comparable v, Comparable w) { return v.compareTo(w) \u003c 0; } private static void merge(Comparable[] a, Comparable[] aux, int lo, int mid, int hi) { assert isSorted(a, lo, mid); assert isSorted(a, mid + 1, hi); for (int k = lo; k \u003c= hi; k++) aux[k] = a[k]; int i = lo, j = mid + 1; for (int k = lo; k \u003c= hi; k++) { if (i \u003e mid) a[k] = aux[j++]; else if (j \u003e hi) a[k] = aux[i++]; else if (less(aux[j], aux[i])) a[k] = aux[j++]; else a[k] = aux[i++]; } assert isSorted(a, lo, hi); } private static void sort(Comparable[] a, Comparable[] aux, int lo, int hi) { if (hi \u003c= lo) return; int mid = lo + (hi - lo) / 2; sort(aux, a, lo, mid); sort(aux, a, mid+1, hi); merge(a, aux, lo, mid, hi); } public static void sort(Comparable[] a) { Comparable[] aux = new Comparable[a.length]; sort(a, aux, 0, a.length - 1); } public static void main(String[] args) { int N = StdIn.readInt(); Comparable[] a = new Comparable[N]; for (int i = 0; i \u003c N; i++) a[i] = StdRandom.uniform(-10000,10000); Stopwatch stopwatch = new Stopwatch(); sort(a); for (var i : a) { System.out.print(i + \" \"); } System.out.println(); System.out.println(stopwatch.elapsedTime()); } } Empirical analysis The number of compares $C(N)$ and array accesses $A(N)$ to mergesort an array of size N satisfy the recurrences:\n$$ C(N) \\le C(\\lceil{\\frac N 2}\\rceil) + C(\\lfloor{\\frac N 2}\\rfloor) + N\\ \\ for N \u003e 1,with \\ C(1)=0. $$ $$ A(N) \\le A(\\lceil{\\frac N 2}\\rceil) + A(\\lfloor{\\frac N 2}\\rfloor) + 6N\\ \\ for N \u003e 1,with \\ A(1)=0. $$ we solve the recurrence when $ N $ is a power of 2. $$ D(N) = 2D(\\frac N 2) + N, for N \u003e 1, with\\ D(1) = 0. $$\nDivide-and-conquer recurrence: proof by picture\nproof by expansion\n$$ \\begin{aligned} D(N)\u0026=2D(N/2)+N \\cr {D(N)} /{N} \u0026= 2D(N / 2)/N + 1\\cr \u0026= D(N/2)/(N/2)+1 \\cr \u0026= D(N/4)/(N/4) + 1 + 1\\cr \u0026= D(N/8)/(N/8) + 1 + 1 + 1\\cr …\\cr \u0026= D(N/N)/(N/N)+1+1+…+1\\cr \u0026= lgN \\end{aligned} $$\nproof by induction\nBase case: $N = 1$ Induction hypothesis: $D(N)=Nlg(N)$. Goal: showthat $ D(2N) = (2N)lg(2N).$ $$ \\begin{aligned} D(2N) \u0026= 2D(N)+2N \\cr \u0026= 2NlgN+2N \\cr \u0026= 2N(lgN+1) \\cr \u0026= 2Nlg(2N) \\end{aligned} $$\npractical improvements private static void sort(Comparable[] a, Comparable[] aux, int lo, int hi) { // Use insertion sort for samll subarrays. final int CUTOFF = 7; if (hi \u003c= lo + CUTOFF - 1) { Insertion.sort(a, lo, hi); return; } int mid = lo + (hi - lo) / 2; sort(a, aux, lo, mid); sort(a, aux, mid + 1, hi); // Stop if already sorted. if (!less(a[mid+1], a[mid])) return; merge(a, aux, lo, mid, hi); } Eliminate the copy to the auxiliary array.\nprivate static void merge(Comparable[] a,Comparable[] aux, int lo, int mid, int hi) { int i = lo, j = mid + 1; for (int k = lo; k \u003c= hi; k++) { if (i \u003e mid) aux[k] = a[j++]; else if (j \u003e hi) aux[k] = a[i++]; else if (less(a[j], a[i])) aux[k] =a[j++]; else aux[k] = a[i++]; } } private static void sort(Comparable[] a,Comparable[] aux, int lo, int hi) { if (hi \u003c= lo) return; int mid = lo + (hi - lo) / 2; //switch soles of aux[] and a[] sort(aux, a, lo, mid); sort(aux, a, mid+1, hi); merge(a, aux, lo, mid, hi); } Bottom-up mergesort Implementation private static void merge(Comparable[] a, Comparable[] aux, int lo, int mid, int hi) { for (int k = lo; k \u003c= hi; k++) aux[k] = a[k]; int i = lo, j = mid + 1; for (int k = lo; k \u003c= hi; k++) { if (i \u003e mid) a[k] = aux[j++]; else if (j \u003e hi) a[k] = aux[i++]; else if (less(aux[j], aux[i])) a[k]= aux[j++]; else a[k] = aux[i++]; } } public static void sort(Comparable[] a) { int N = a.length; Comparable[] aux = new Comparable[N]; for (int sz = 1; sz \u003c N; sz = sz + sz) for (int lo = 0; lo \u003c N - sz; lo +=sz + sz) merge(a, aux, lo, lo + sz -1,Math.min(lo+sz+sz-1, N-1)); } public static void main(String[] args) { int N = StdIn.readInt(); Comparable[] a = new Comparable[N]; for (int i = 0; i \u003c N; i++) a[i] = StdRandom.uniform(-1000010000); Stopwatch stopwatch = new Stopwatch(); sort(a); for (var i : a) { System.out.print(i + \" \"); } System.out.println(); System.out.println(stopwatch.elapsedTim()); } Sorting Complexity Model of computation: decision tree. Cost model: # compares. Upper bound: $\\sim NlgN $from mergesort Lower bound: ? Optimal algorithm: ? Compare-based lower bound for sorting Proposition. Any Compare-based sorting algorothm must use at least $lg(N!)\\sim NlogN $(Stirling formula) compares in the worst-case.\nPf.\nAssume array consists of $N$ distinct values $a_1$ through $ a_n $. Worst case dictated by height $h$ of decision tree. Binary tree of height $h$ has at most $2^h$ leaves. $N! $different orderings $\\Rightarrow$ at least $ N!$ leaves. $$ \\begin{aligned} 2^h \\ge ＃leaves \\ge N! \\cr \\Rightarrow h \\ge lg(N!)\\sim NlgN \\end{aligned}$$\nStability Insertion sort is stable: Equal items never move fast each other. private static void insertionSort(Comparable[] a) { int N = a.length; for (int i = 0; i \u003c N; i++) { for (int j = i; j \u003e 0 \u0026\u0026 less(a[j], a[j - 1]); j--) exch(a, j, j - 1); } } Selection sort is not stable: Long-distance exchange might move an item past some equal item. private static void selectionSort(Comparable[] a) { int N = a.length; for (int i = 0; i \u003c N; i++) { int min = i; for (int j = i + 1; j \u003c N; j++) if (less(a[j], a[min])) min = j; exch(a, i, min); } } Shellsort is not stable: Long-distence exchange. private static void shellSort(Comparable[] a) { int N = a.length; int h = 1; while (h \u003c N / 3) h = 3 * h + 1; while (h \u003e= 1) { for (int i = h; i \u003c N; i++) { for (int j = i; j \u003e h \u0026\u0026 less(a[j], a[j - h]); j -= h) exch(a, j, j - h); } h /= 3; } } Mergesort is stable.: Suffices to verify that merge operation is table. 2.2.2 Give traces, in the style of the trace given with Algorithm 2.4, showing how the keys E A S Y Q U E S T I O N are sorted with top-down mergesort.\na[] lo mid hi 0 1 2 3 4 5 6 7 8 9 10 11 E A S Y Q U E S T I O N 0 0 1 A E S Y Q U E S T I O N 0 1 2 A E S Y Q U E S T I O N 3 3 4 A E S Q Y U E S T I O N 3 4 5 A E S Q U Y E S T I O N 0 2 5 A E Q S U Y E S T I O N 6 6 7 A E Q S U Y E S T I O N 6 7 8 A E Q S U Y E S T I O N 9 9 10 A E Q S U Y E S T I O N 9 10 11 A E Q S U Y E S T I N O 6 8 11 A E Q S U Y E I N O S T 0 5 11 A E E I N O Q S S T U Y A E E I N O Q S S T U Y 2.2.3 Answer Exercise 2.2.2 for bottom-up mergesort.\na[] lo mid hi 0 1 2 3 4 5 6 7 8 9 10 11 E A S Y Q U E S T I O N 0 0 1 A E S Y Q U E S T I O N 2 2 3 A E S Y Q U E S T I O N 4 4 5 A E S Y Q U E S T I O N 6 6 7 A E S Y Q U E S T I O N 8 8 9 A E S Y Q U E S I T O N 10 10 11 A E S Y Q U E S I T N O 0 1 3 A E S Y Q U E S I T N O 4 5 7 A E S Y E Q S U I T N O 8 9 11 A E S Y E Q S U I N O T 0 3 7 A E E Q S S U Y I N O T 0 7 11 A E E I N O Q S S T U Y A E E I N O Q S S T U Y 2.2.4 Does the abstract in-place merge produce proper output if and only if the two input subarrays are in sorted order? Prove your answer, or provide a counterexample.(是否当且仅当两个输入的数组都有序时原地归并的抽象方法才能得到正确的结果？证明你的结论，或者给出一个反例。)\n是的，只有当两个输入数组都有序时采用原地归并才能得到正确的结果。 反例：数组1：[4, 2, 3],数组2：[1, 5, 8];\n按归并算法归并后得到[1,4,2,3,5,8]; 可以看到归并后元素的相对位置不变，故得到错误的结果。 2.2.5 Give the sequence of subarray sizes in the merges performed by both the top-down and the bottom-up mergesort algorithms, for N = 39. (当输入数组的大小N=39时，给出自顶向下和自底向上的归并排序中各归并子数组的大小及顺序。)\n自顶向下 2, 3, 2, 5, 2, 3, 2, 5, 10, 2, 3, 2, 5, 2, 3, 2, 5, 10, 20, 2, 3, 2, 5, 2, 3, 2, 5, 10, 2, 3, 2, 5, 2, 2, 4, 9, 19, 39\n自底向上 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 4, 4, 4, 4, 4, 4, 4, 4, 4, 3, 8, 8, 8, 8, 7, 16, 16, 32, 39\nQuickSort quicksort Basic plan:\nShuffle the array Partition so that, for some j entry a[j] in place no larger entry to the left of j no smaller entry to the right of j Sort each piece recursively. Java implementation public class Quick { private static boolean less(Comparable v, Comparable w) { return v.compareTo(w) \u003c 0; } private static void exch(Comparable[] a, int i, int j) { Comparable t = a[i]; a[i] = a[j]; a[j] = t; } private static int partition(Comparable[] a, int lo, int hi) { int i = lo, j = hi + 1; while (true) { while (less(a[++i], a[lo])) if (i == hi) break; while (less(a[lo], a[--j])) if (j == lo) break; if (i \u003e= j) break; exch(a, i, j); } exch(a, lo, j); return j; } private static void sort(Comparable[] a) { StdRandom.shuffle(a); sort(a, 0, a.length - 1); } private static void sort(Comparable[] a, int lo, int hi) { if (lo \u003e= hi) return; int j = partition(a, lo, hi); sort(a, lo, j - 1); sort(a, j + 1, hi); } } average-case analysis $C_N $ satisfies the recurrence $C_0 = C_1=0$ and for $ N\\ge 2 $:\n$$ C_N = (N + 1) + (\\frac{C_0+C_{N-1}}{N})+ (\\frac{C_1+C_{N-2}}{N})+ … +(\\frac{C_{N-1}+C_{0{N}}}) $$\nMultiply both sides by N and collect terms: $$ NC_N = N(N+1)+2(C_0+C_1+…+C_{N-1}) $$\nSubstract this from the same equation for $N - 1$: $$ NC_N-(N-1)C_{N-1}=2N+2C_{N-1} $$\nRearrage terms and devide by $N(N+1)$: $$ \\frac{C_N}{N+1} = \\frac{C_{N-1{N}}} + \\frac{2}{N+1} $$\nRepeatedly apply above equation: $$ \\begin{aligned} \\frac{C_N}{N+1} \u0026= \\frac{C_{N-1}}{N}+\\frac{2}{N+1} \\cr \u0026= \\frac{C_{N-2}}{N-1}+\\frac{2}{N}+\\frac{2}{N+1} \\cr \u0026= \\frac{C_{N-3}}{N-2}+\\frac{2}{N-1}+\\frac{2}{N}+\\frac{2}{N+1} \\cr \u0026= \\frac 2 3 + \\frac 2 4 + \\frac 2 5 +…+\\frac 2 {N+1} \\end{aligned} $$\nApproximate sum by an integral: $$ \\begin{aligned} C_N \u0026= 2(N+1)(\\frac 1 3 + \\frac 1 4 + \\frac 1 5 +…+ \\frac{1}{N+1}) \\cr \u0026 \\sim 2(N+1) \\int_{3}^{N+1}{\\frac{1}{x}dx} \\end{aligned} $$\nFinally, the desired result: $$ C_N \\sim 2(N+1)lnN \\sim 1.39NlgN $$\n3-way quicksort template \u003ctypename T\u003e void threeWayQuickSort(T a[], int lo, int hi) { if (hi \u003c= lo) return; int lt = lo, gt = hi; T v = a[lo]; int i = lo; while (i \u003c= gt) { if (a[i] \u003c v) swap(a[lt++], a[i++]); else if (a[i] \u003e v) swap(a[gt--], a[i]); else i++; } threeWayQuickSort(a, lo, lt - 1); threeWayQuickSort(a, gt + 1, hi); } 2.3.1 Show, in the style of the trace given with partition(), how that method patitions the array E A S Y Q U E S T I O N.\ni j 0 1 2 3 4 5 6 7 8 9 10 11 0 12 E A S Y Q U E S T I O N 2 6 E A S Y Q U E S T I O N 2 6 E A E Y Q U S S T I O N 3 2 E A E Y Q U S S T I O N 2 E A E Y Q U S S T I O N 2.3.2 Show, in the style of the quicksort trace given in this section, how quicksort sorts the array E A S Y Q U E S T I O N (for the purposes of this exercise, ignore the initial shuffle).\n2.3.3 What is the maximum number of times during the execution of Quick.sort() that the largest item can be exchanged, for an array of length N ? (对于长度为N的数组，在Quick.sort()执行时，其最大的元素最多会被交换多少次？)\n在Quick.sort()中，一个元素被交换可分为两种情况：\n该元素是枢轴，在partition最后一步和j交换 该元素在本次partition中不是枢轴，出现在了枢轴错的一侧，需要被交换到另一侧 如果该元素是枢轴，那么在交换后它的位置就固定下来了，之后不再涉及交换，因此要使交换次数最大，这个元素应该是在每次partition时都位于枢轴错误的一侧，因为是最大的元素，所以应该总是在枢轴的左侧。 为了使得partition的次数尽可能的多，需要使得每次移动的距离短，这里我们先考虑每次移动一位，如数组[5,9,1,6,7]： 枢轴为5，交换后变为[5,1,9,6,7] 枢轴交换，变为[1,5,9,6,7] 我们发现在下一次partition中最大元素9会成为枢轴，不再被交换 所以考虑每次移动两位，如数组[2,10,4,1,6,3,8,5,7,9] 枢轴为2，交换后[2,1,4,10,6,3,8,5,7,9] 枢轴交换，变为[1,2,4,10,6,3,8,5,7,9] 枢轴为4，交换后[1,2,4,3,6,10,8,5,7,9] 枢轴交换，变为[1,2,3,4,6,10,8,5,7,9] 枢轴为6，交换后[1,2,3,4,6,5,8,10,7,9] 枢轴交换，变为[1,2,3,4,5,6,8,10,7,9] 枢轴为8，交换后[1,2,3,4,5,6,8,7,10,9] 枢轴交换，变为[1,2,3,4,5,6,7,8,10,9] 枢轴为10，交换后[1,2,3,4,5,6,7,8,9,10] 在上面这个N=10的数组中，“10”这个最大的元素一共被交换了5次，所以我们可以认为对于N个元素的数组，在执行Quick.sort()时最大元素最多会被交换N/2次。 2.3.4 Suppose that the initial random shuffle is omitted. Give six arrays of ten elements for which Quick.sort() uses the worst-case number of compares.\n如果始终选第一个元素作为枢轴的话，要使比较次数达到最坏情况的话，输入数组应为升序。比较次数达到$ N + N-1 + N-2 + N-3 +…+1 = \\frac{N(N+1)}{2} \\sim N^2/2 $ 例如：\n[1,2,3,4,5,6,7,8,9,10] [2,4,6,8,10,12,14,16,18,20] [-1,1,3,5,7,9,11,13,15,17] [10,20,30,40,50,60,70,80,90,100] [5,10,15,20,25,30,35,40,45,50] [0,2,3,4,6,7,8,9,10,12] 2.3.5 Give a code fragment that sorts an array that is known to consist of items having just two distinct keys.\nstatic void sort(Comparable[] a) { int lo = 0, hi = a.length - 1; int i = 0; while (i \u003c= hi) { int tmp = a[i].compareTo(a[lo]); if (tmp \u003c 0) exch(a, lo++, i++); else if (tmp \u003e 0) exch(a, i, hi--); else i++; } } Priority Queues API binary-heap Java implementation public class MaxPQ\u003cKey extends Comparable\u003cKey\u003e\u003e { private Key[] pq; private int N = 0; public MaxPQ(int maxN) { pq = (Key[]) new Comparable[maxN + 1]; } public boolean isEmpty() { return N == 0; } public int size() { return N; } public void insert(Key v) { pq[++N] = v; swim(N); } public Key delMax() { Key max = pq[1]; exch(1, N--); sink(1); pq[N+1] = null; return max; } private boolean less(int i, int j) { return pq[i].compareTo(pq[j]) \u003c 0; } private void exch(int i, int j) { Key tmp = pq[i]; pq[i] = pq[j]; pq[j] = tmp; } private void swim(int k) { while (k \u003e 1 \u0026\u0026 less(k / 2, k)) { exch(k / 2, k); k /= 2; } } private void sink(int k) { while (2 * k \u003c= N) { int j = 2 * k; if (j \u003c N \u0026\u0026 less(j, j + 1)) j++; if (!less(k, j)) break; exch(k, j); k = j; } } } heapsort Basic plan for in-place sort Create max-heap with all N keys. Repatedly remove the maximum key. Java implementation public class Heap { public static void sort(Comparable[] a) { int N = a.length; for (int k = N / 2; k \u003e= 1; k--) sink(a, k, N); while (N \u003e 1) { exch(a, 1, N); sink(a, 1, --N); } } private static boolean less(Comparable a[], int i, int j) { return a[i - 1].compareTo(a[j - 1]) \u003c 0; } private static void exch(Comparable a[], int i, int j) { Comparable t = a[i - 1]; a[i - 1] = a[j - 1]; a[j - 1] = t; } private static void sink(Comparable[] a, int k, int N) { while (2 * k \u003c= N) { int j = 2 * k; if (j \u003c N \u0026\u0026 less(a, j, j + 1)) j++; if (!less(a, k, j)) break; exch(a, k, j); k = j; } } } mathematical analysis Proposition. Heap construction uses $ \\le 2N $ compares and exchanges.\nProposition. Heapsort uses $ \\le 2NlgN $ compares and exchanges.\nSignificance. In-place sorting algorithm with $ NlgN $ worst-case.\nMergesort: no, linear extra space. Quicksort: no, quadratic time in worst case. Heapsort: yes! Bottom line. Heapsort is optimal for both time and space but:\nInner loop longer than quicksort’s. Makes poor use of cache memory. Not stable. sorting-algorithms: summary 2.4.2 Criticize the following idea: To implement find the maximum in constant time, why not use a stack or a queue, but keep track of the maximum value inserted so far, then return that value for find the maximum?\n如果用这种方法，当最大元素被删除之后，不能在常量时间内更新最大元素\n2.4.3 Provide priority-queue implementations that support insert and remove the maximum, one for each of the following underlying data structures: unordered array, ordered array, unordered linked list, and linked list. Give a table of the worst-case bounds for each operation for each of your four implementations.\n数组实现 public abstract class ArrayPQ\u003cKey extends Comparable\u003cKey\u003e\u003e { protected Key[] pq; protected int n; public ArrayPQ(int capacity) { pq = (Key[]) new Comparable[capacity]; n = 0; } public boolean isEmpty() {return n == 0;} public int size() {return n;} public abstract void insert(Key x); public abstract Key delMax(); protected boolean less(int i, int j) {return pq[i].compareTo(pq[j]) \u003c 0; } protected void exch(int i, int j) { Key t = pq[i]; pq[i] = pq[j]; pq[j] = t; } public static void main(String[] args) { OrderedArrayMaxPQ pq = new OrderedArrayMaxPQ(10); pq.insert(\"this\"); pq.insert(\"is\"); pq.insert(\"a\"); pq.insert(\"test\"); while (!pq.isEmpty()) System.out.println(pq.delMax()); } } class UnorderedArrayMaxPQ\u003cKey extends Comparable\u003cKey\u003e\u003e extends ArrayPQ\u003cKey\u003e { public UnorderedArrayMaxPQ(int capacity) { super(capacity); } @Override public void insert(Key x) { pq[n++] = x; } @Override public Key delMax() { int max = 0; for (int i = 1; i \u003c n; i++) { if (less(max, i)) max = i; exch(max, n-1); } return pq[--n]; } } class OrderedArrayMaxPQ\u003cKey extends Comparable\u003cKey\u003e\u003e extends ArrayPQ\u003cKey\u003e{ public OrderedArrayMaxPQ(int capacity) { super(capacity); } @Override public void insert(Key x) { int i = n - 1; while (i \u003e= 0 \u0026\u0026 x.compareTo(pq[i]) \u003c 0) { pq[i+1] = pq[i]; i--; } pq[i+1] = x; n++; } @Override public Key delMax() { return pq[--n]; } } 链表实现 public abstract class LinkedListPQ\u003cKey extends Comparable\u003cKey\u003e\u003e { protected LinkedList\u003cKey\u003e pq; public LinkedListPQ() { pq = new LinkedList\u003cKey\u003e(); } public boolean isEmpty() { return pq.size() == 0; } public int size() { return pq.size(); } public abstract void insert(Key x); public abstract Key delMax(); protected boolean less(Key a, Key b) { return a.compareTo(b) \u003c 0; } public static void main(String[] args) { UnorderedLinkedMaxPQ pq = new UnorderedLinkedMaxPQ(); pq.insert(\"this\"); pq.insert(\"is\"); pq.insert(\"a\"); pq.insert(\"test\"); while (!pq.isEmpty()) System.out.println(pq.delMax()); } } class UnorderedLinkedMaxPQ\u003cKey extends Comparable\u003cKey\u003e\u003e extends LinkedListPQ\u003cKey\u003e { @Override public void insert(Key x) { pq.addLast(x); } @Override public Key delMax() { int i = 0; int idx = 0; var max = pq.getFirst(); for (var e : pq) { if (less(max, e)) { max = e; idx = i; } i++; } pq.remove(idx); return max; } } class OrderedLinkedMaxPQ\u003cKey extends Comparable\u003cKey\u003e\u003e extends LinkedListPQ\u003cKey\u003e { public OrderedLinkedMaxPQ() { super(); } @Override public void insert(Key x) { int i = 0; Iterator it = pq.iterator(); while (it.hasNext()) { if (less(x, (Key) it.next())) break; i++; } pq.add(i, x); System.out.println(i + \" eee \"); } @Override public Key delMax() { return pq.removeLast(); } } the worst-case bounds insert() delMax() 无序数组 1 N 有序数组 N 1 无序链表 1 N 有序链表 N 1 2.4.5 Give the heap that results when the keys E A S Y Q U E S T I O N are inserted in that order into an initially empty max-oriented heap.\n2.4.7 The largest item in a heap must appear in position 1, and the second largest must be in position 2 or position 3. Give the list of positions in a heap of size 31 where the kth largest (i) can appear, and (ii) cannot appear, for k=2, 3, 4 (assuming the values to be distinct).\nk = 2：可能出现在2，3；不可能出现在1, 4~31 k = 3：可能出现在2，3，4，5，6，7；不可能出现在1,8~31 k = 4：可能出现在2，3，4，5，6，7，8，9，10，11，12，13，14，15，不可能出现在1，16~31 第k大元素只可能出现在深度不大于k的位置($ position \\le 2^k-1 ,k \\ge 2$)\n2.4.9 Draw all of the different heaps that can be made from the five keys A B C D E, then draw all of the different heaps that can be made from the five keys A A A B B.\nA B C D E 最大堆 最小堆 A A A B B 2.4.11 Suppose that your application will have a huge number of insert operations, but only a few remove the maximum operations. Which priority-queue implementation do you think would be most effective: heap, unordered array, or ordered array?\n因为有大量的insert操作和很少的delMax操作，而heap, unordered array, ordered array实现的Priority Queue insert操作的花费时间的数量级分别为lgN, 1, N, 所以unordered array是最有效的。\n2.4.12 Suppose that your application will have a huge number of find the maximum operations, but a relatively small number of insert and remove the maximum operations. Which priority-queue implementation do you think would be most effective: heap, unordered array, or ordered array?\n大量的查找最大元素，heap和ordered array查找最大元素都是常量时间，但heap插入和删除最大元素都是lgN，而ordered array插入和删除分别是N和常量时间，综合下来，heap是最有效的。\nUNDIRECTED GRAPHS depth-first-search public class DepthFirstPaths { private boolean[] marked; private int[] edgeTo; private int s; public DepthFirstPaths(Graph G,int s) { marked = new boolean[G.V()]; edgeTo = new int[G.V()]; Arrays.fill(marked, false); this.s = s; dfs(G, s); } private void dfs(Graph G, int v) { marked[v] = true; for (int w : G.adj(v)) { if (!marked[w]) { dfs(G, w); edgeTo[w] = v; } } } public boolean hasPathTo(int v) { return marked[v]; } public Iterable\u003cInteger\u003e pathTo(int v) { if (!hasPathTo(v)) return null; Stack\u003cInteger\u003e path = new Stack\u003c\u003e(); for (int x = v; x != s; x = edgeTo[x]) path.push(x); path.push(s); return path; } public static void main(String[] args) { int V = StdIn.readInt(); Graph g = new Graph(V); int E = StdIn.readInt(); for (int i = 0; i \u003c E; i++) { g.addEdge(StdIn.readInt(), StdIn.readInt()); } DepthFirstPaths dfp = new DepthFirstPaths(g, 0); for (var i : dfp.pathTo(3)) { System.out.println(i); } } } breadth-first-search public class BreadthFirstPaths { private boolean[] marked; private int[] edgeTo; private int s; public BreadthFirstPaths(Graph G, int s) { marked = new boolean[G.V()]; edgeTo = new int[G.V()]; this.s = s; bfs(G, s); } private void bfs(Graph G, int s) { Queue\u003cInteger\u003e Q = new Queue\u003c\u003e(); Q.enqueue(s); marked[s] = true; while (!Q.isEmpty()) { int v = Q.dequeue(); for (int w : G.adj(v)) { if (!marked[w]) { Q.enqueue(w); marked[w] = true; edgeTo[w] = v; } } } } public boolean hasPathTo(int v) { return marked[v]; } public Iterable\u003cInteger\u003e pathTo(int v) { if (!hasPathTo(v)) return null; Stack\u003cInteger\u003e path = new Stack\u003c\u003e(); for (int i = v; i != s; i = edgeTo[i]) path.push(i); path.push(s); return path; } public static void main(String[] args) { int V = StdIn.readInt(); Graph g = new Graph(V); int E = StdIn.readInt(); for (int i = 0; i \u003c E; i++) { g.addEdge(StdIn.readInt(), StdIn.readInt()); } BreadthFirstPaths bfp = new BreadthFirstPaths(g, 0); for (var i : bfp.pathTo(3)) { System.out.println(i); } } } connected components public class CC { private boolean[] marked; private int[] id; private int count; public CC(Graph G) { marked = new boolean[G.V()]; id = new int[G.V()]; for (int v = 0; v \u003c G.V(); v++) { if (!marked[v]) { dfs(G, v); count++; } } } public int count() { return count; } public int id(int v) { return id[v]; } private void dfs(Graph G, int v) { marked[v] = true; id[v] = count; for (int w : G.adj(v)) { if (!marked[w]) dfs(G, w); } } public static void main(String[] args) { Graph G = new Graph(StdIn.readInt()); int E = StdIn.readInt(); for (int i = 0; i \u003c E; i++) G.addEdge(StdIn.readInt(), StdIn.readInt()); CC cc = new CC(G); System.out.println(cc.count); } } Minimum Spanning Trees Greedy algorithm Cut property Def: A cut in a graph is a partition of its vertices into two(nonempty) sets.\nDef: A Crossing edge connects a vertex in one set with a vertex in the other.\nCut property. Give any cut, the crossing edge of min weight is in the MST\nPf. Suppose the min-weight crossing edge e is not in the MST Adding e to the MST creates a cycle Some other edge f in cycle must be a crossing edge Removing f and adding e is also a spanning tree Since weight of e is less than the weight of f,that spanning tree is lower weight Contradiction Kruskal’s algorithm Consider edges in ascending order of weight.\nAdd next edge to tree T unless so doing would create a cycle. public class KruskalMST { private Queue\u003cEdge\u003e mst = new Queue\u003c\u003e(); private double weight; public KruskalMST(EdgeWeightedGraph G) { weight = 0; MinPQ\u003cEdge\u003e pq = new MinPQ\u003c\u003e(); for (var e : G.edges()) { pq.insert(e); } UF uf = new UF(G.V()); while (!pq.isEmpty() \u0026\u0026 mst.size() \u003c G.V() - 1) { Edge e = pq.delMin(); int v = e.either(), w = e.other(v); if (!uf.connected(v, w)) { uf.union(v, w); mst.enqueue(e); weight += e.weight(); } } } public Iterable\u003cEdge\u003e edges() { return mst; } public double weight() { return weight; } } Prim’s algorithm Start with vertex 0 and greedy grow tree T Add to T the min weight with exactly one endpoint in T Repeat until V-1 edges LazyPrim Implementation public class LazyPrimMST { private boolean[] marked; private Queue\u003cEdge\u003e mst; private MinPQ\u003cEdge\u003e pq; public LazyPrimMST(EdgeWeightedGraph G) { pq = new MinPQ\u003c\u003e(); mst = new Queue\u003c\u003e(); marked = new boolean[G.V()]; visit(G, 0); while (!pq.isEmpty() \u0026\u0026 mst.size() \u003c G.V() - 1) { Edge e = pq.delMin(); int v = e.either(), w = e.other(v); if (marked[v] \u0026\u0026 marked[w]) continue; mst.enqueue(e); if (!marked[v]) visit(G, v); if (!marked[w]) visit(G, w); } } private void visit(EdgeWeightedGraph G, int v) { marked[v] = true; for (Edge e : G.adj(v)) { if (!marked[e.other(v)]) { pq.insert(e); } } } public Iterable\u003cEdge\u003e mst() { return mst; } } Indexed priority queue implementation Start as same code as MinPQ Maintain parallel arrays keys[], pq[], and qp[] so that: keys[i] is the priority of i pq[i] is the index of the key in heap position i qp[i] is the heap position of the key with index i Use swim(qp[i]) implement decreaseKey(i, key). EagerPrim Implementation import edu.princeton.cs.algs4.*; public class PrimMST { private Edge[] edgeTo; private double[] distTo; private boolean[] marked; private IndexMinPQ\u003cDouble\u003e pq; public PrimMST(EdgeWeightedGraph G) { edgeTo = new Edge[G.V()]; distTo = new double[G.V()]; marked = new boolean[G.V()]; for (int v = 0; v \u003c G.V(); v++) distTo[v] = Double.POSITIVE_INFINITY; pq = new IndexMinPQ\u003c\u003e(G.V()); distTo[0] = 0.0; pq.insert(0, 0.0); while (!pq.isEmpty()) visit(G, pq.delMin()); } private void visit(EdgeWeightedGraph G, int v) { marked[v] = true; for (Edge e : G.adj(v)) { int w = e.other(v); if (marked[w]) continue; if (e.weight() \u003c distTo[w]) { edgeTo[w] = e; distTo[w] = e.weight(); if (pq.contains(w)) pq.change(w, distTo[w]); else pq.insert(w, distTo[w]); } } } public Iterable\u003cEdge\u003e edges() { Queue\u003cEdge\u003e mst = new Queue\u003c\u003e(); for (int v = 0; v \u003c edgeTo.length; v++) { Edge e = edgeTo[v]; if (e != null) { mst.enqueue(e); } } return mst; } public double weight() { double weight = 0.0; for (Edge e : edges()) { weight += e.weight(); } return weight; } } 4.3.2 Draw all of the MSTs of graph depicted at right (all edge weights are equal).\n4.3.3 Show that if a graph’s edges all have distinct weights, the MST is unique\n假设无向图G有两棵不同的最小生成树T1和T2 e是在T1或T2中（但不是同时在两棵树中）最小权值的边，不妨假设e在T1中 将e添加到T2中会创建一个环C 在C中至少存在一条边f（但不在T1中，否则会产生环） 因为e是在T1或T2中（但不是同时在两棵树中）最小权值的边，并且每条边权值都不同 所以有e.weight \u003c f.weight 用e代替f，将会产生比原来T2权值更小的生成树，产生了矛盾 4.3.13 Give a counterexample that shows why the following strategy does not necessarily find the MST: ‘Start with any vertex as a single-vertex MST, then add V-1 edges to it, always taking next a min-weight edge incident to the vertex most recently added to the MST.’\nShortest Paths shortest-paths properties Data structures for single-source shortest paths Goal. Find the shortest-paths from s to every other vertex. Observation. A shortest-paths tree (SPT) solution exists. Why? Consequence. Can represent the SPT with two vertex-indexed arrays: distTo[v] is length of shortest path from s to v edgeTo[v] is last edge on shortest path from s to v Edge relaxation Relax edge e = v-\u003ew distTo[v] is length of shortest known path from s to v distTo[w] is length of shortest known path from s to w edgeTo[w] is last edge on shortest known path from s to w if e = v-\u003ew gives shorter path to w through v, update both distTo[w] and edgeTo[w] Shortest-paths optimality conditions Proposition. Let G be an edge-weighted digraph. Then distTo[] are the shortest path distances from s iff: distTo[s] = 0 For each vertex v, distTo[v] is the length of some path from s to v For each edge e = v-\u003ew, distTo[w] \u003c= distTo[v] + e.weight(). Pf. suppose that distTo[w] \u003e distTo[v] + e.weight() for some edge e = v-\u003ew. Then, e gives a path from s to w (through v) of length less than distTo[w]. distTo[v1] \u003c= distTo[v0] + e1.weight() distTo[v2] \u003c= distTo[v1] + e2.weight() … distTo[vk] \u003c= distTo[v(k-1)] + ek.weight() Add inequalities; simplify; and substitude distTo[v0] = distTo[s] = 0: distTo[w] = distTo[vk] \u003c= e1.weight() + e2.weight() + … + ek.weight() Thus, distTo[w] is the weight of shortest path to w Genertic shortest-paths algorithm Proposition. Genertic algorithm computes SPT(if it exists) from s. Pf sketch Throughout algorithm, distTo[v] is the length of a simple path from s to v (and edgeTo[v] is last edge on path) Each successful relaxation decreases distTo[v] from some v The entry distTo[v] can decrease at most a finite number of times Efficient implementataions How to choose which edge to relax? Ex 1. Dijkstra’s algorithm (nonnegative weights) Ex 2. Topological sort algorithm (no directed cycles) Ex 3. Bellman-Ford algorithm (no negative cycles) Dijkstra’s algorithm Dijkstra’s algorithm Demo correctness proof Proposition. Dijkstra’s algorithm computes a SPT in any edge-weighted diagraph with nonnegative weights.\nPf.\nEach edge e = v-\u003ew is relaxed exactly once (when v is relaxed), leaving distTo[w] \u003c= distTo[v] + e.weight() Inequality hold until algorithm terminates because: distTo[w] cannot increase \u003c- distTo[] values are monotone decreasing distTo[v] will not change \u003c- we choose lowest distTo[] value at each step (and edge weights are nonnegative) Thus, opun termination, shortest-paths optimality conditions hold Java implementation public class DijkstraSP { private DirectedEdge[] edgeTo; private double[] distTo; private IndexMinPQ\u003cDouble\u003e pq; public DijkstraSP(EdgeWeightedDigraph G, int s) { edgeTo = new DirectedEdge[G.V()]; distTo = new double[G.V()]; pq = new IndexMinPQ\u003cDouble\u003e(G.V()); for (int v = 0; v \u003c G.V(); v++) distTo[v] = Double.POSITIVE_INFINITY; distTo[s] = 0.0; pq.insert(s, 0.0); while (!pq.isEmpty()) { int v = pq.delMin(); for (DirectedEdge e : G.adj(v)) relax(e); } } private void relax(DirectedEdge e) { int v = e.from(), w = e.to(); if (distTo[w] \u003e distTo[v] + e.weight()) { distTo[w] = distTo[v] + e.weight(); edgeTo[w] = e; if (pq.contains(w)) pq.decreaseKey(w, distTo[w]); else pq.insert(w, distTo[w]); } } public double distTo(int v) { return distTo[v]; } public Iterable\u003cDirectedEdge\u003e pathTo(int v) { Stack\u003cDirectedEdge\u003e path = new Stack\u003c\u003e(); for (DirectedEdge e = edgeTo[v]; e != null; e = edgeTo[e.from()]) path.push(e); return path; } } edge-weighted DAGs Acyclic shortest paths demo Shortest paths in edge-weighted DAGs Proposition. Topological sort algorithm computes SPT in any (edge weights can be negative!) edge-weighted DAG in time proportional to E + V Pf. Each edge e = v-\u003ew is relaxed exactly once (when v is relaxed), leaving distTo[w] \u003c= distTo[v] + e.weight() Inequality holds until algorithm terminates because: distTo[w] cannot increase \u003c- distTo[] values are monotone decreasing distTo[v] will not change \u003c- because of topological order, no edge pointing to v will be relaxed after v is relaxed Thus, upon termination, shortest-paths optimality conditions hold Java Implementation public class AcyclicSP { private DirectedEdge[] edgeTo; private double[] distTo; public AcyclicSP(EdgeWeightedDigraph G, int s) { edgeTo = new DirectedEdge[G.V()]; distTo = new double[G.V()]; for (int v = 0; v \u003c G.V(); v++) distTo[v] = Double.POSITIVE_INFINITY; distTo[s] = 0.0; Topological topological = new Topological(G); for (int v : topological.order()) for (DirectedEdge e : G.adj(v)) relax(e); } private void relax(DirectedEdge e) { int v = e.from(), w = e.to(); if (distTo[w] \u003e distTo[v] + e.weight()) { distTo[w] = distTo[v] + e.weight(); edgeTo[w] = e; } } public Iterable\u003cDirectedEdge\u003e pathTo(int v) { Stack\u003cDirectedEdge\u003e path = new Stack\u003c\u003e(); for (DirectedEdge e = edgeTo[v]; e != null; e = edgeTo[e.from()]) path.push(e); return path; } } negative weights Def. A negative cycle is a directed cycle whose sum of edge weights is negative. Proposition. A SPT exists iff no negative cycles. Bellman-Ford algorithm: analysis Initialize distTo[s] = 0 and distTo[v] = $ \\infty $ for all other vertices.\nRepeat V times:\nRelax each edge. Proposition. Dynamic programming algorithm computes SPT in any edge-weighted digraph with no negative cycles in time proportional to $E\\times V$\nPf idea. After pass i, found shortest path containing at most i edges.\nBellman-Ford algorithm: practical improvement Observation. If distTo[v] does not change during pass i, no need to relax any edge pointing from v in pass i+1.\nFIFO implementation. Maintain queue of vertices whose distTo[] changed.\nOverall effect.\nThe running time is still proportional to $E \\times V $ in worst case. But much faster than that in practice. Bellman-Ford Java implementation public class BellmanFordSP { private double[] distTo; private DirectedEdge[] edgeTo; private Queue\u003cInteger\u003e queue; private boolean[] onQueue; public BellmanFordSP(EdgeWeightedDigraph G, int s) { distTo = new double[G.V()]; onQueue = new boolean[G.V()]; edgeTo = new DirectedEdge[G.V()]; for (int v = 0; v \u003c G.V(); v++) distTo[v] = Double.POSITIVE_INFINITY; distTo[s] = 0.0; queue = new Queue\u003c\u003e(); queue.enqueue(s); onQueue[s] = true; while (!queue.isEmpty()) { int v = queue.dequeue(); onQueue[v] = false; relax(G, v); } } private void relax(EdgeWeightedDigraph G, int v) { for (DirectedEdge e : G.adj(v)) { int w = e.to(); if (distTo[w] \u003e distTo[v] + e.weight()) { distTo[w] = distTo[v] + e.weight(); edgeTo[w] = e; if (!onQueue[w]) { queue.enqueue(w); onQueue[w] = true; } } } } public Iterable\u003cDirectedEdge\u003e pathTo(int v) { Stack\u003cDirectedEdge\u003e path = new Stack\u003c\u003e(); for (DirectedEdge e = edgeTo[v]; e != null; e = edgeTo[e.from()]) path.push(e); return path; } } Single source shortest-path implementation: cost summary algorithm restriction typical case worst case extra case topological sort no directed cycles E + V E + V V Dijkstra (binary heap) no negative weights ElogV ElogV V Bellman-Ford no negative cycles EV EV V Bellman-Ford(queue-based) no negative cycles E + V EV V 4.4.1 True or false. Adding a constant to every edge weight does not change the solution to the single-source shortest-paths problem.\nFalse. 假设一条最短路径的长度是15, 且一共有五条边，而另外一条简单路径的长度为20，由两条边组成，当每条边的权值都增加5之后，原来长度15的路径长度变为40，原来长度为20的路径长度变为30，可以看到最短路径改变了。\n4.4.5 Change the direction of edge 0-\u003e2 in tinyEWD.txt (see page 644). Draw two different SPTs that are rooted at 2 for this modified edge-weighted digraph. 4.5.9 The table below, from an old published road map, purports to give the length of the shortest routes connecting the cities. It contains an error. Correct the table. Also, add a table that shows how to achieve the shortest routes.\nProvidence Westerly New London Norwich Providence 53 54 48 Westerly 53 18 30 New London 54 18 12 Norwich 48 30 12 给Providence、Westerly、New London、Norwich 分别编号为0、1、2、3\n最短路径：\nProvidence Westerly New London Norwich Providence 0-1 0-2 0-3 Westerly 1-0 1-2 1-2、2-3 New London 2-0 2-1 2-3 Norwich 3-0 3-2、2-1 3-2 String sorts key-indexed counting Proposition. Key-indexed counting uses $ ~ 11N+4R $ array accesses to sort a N items whose keys are integers between 0 and R-1.\nProposition. Key-indexed counting uses extra space proportional to N + R\nStable.\npublic class CountingSort { public static void sort(int[] a, int R) { int N = a.length; int[] count = new int[R+1]; int[] aux = new int[N]; for (int i = 0; i \u003c N; i++) count[a[i]+1]++; // count[a[i]+1] = count[a[i+1]] + 1 for (int r = 0; r \u003c R; r++) count[r+1] += count[r]; // 第一个位置 for (int i = 0; i \u003c N; i++) aux[count[a[i]]++] = a[i]; // aux[count[a[i]] = count[a[i]]+1] = a[i] for (int i = 0; i \u003c N; i++) a[i] = aux[i]; } public static void main(String[] args) { String s = \"dacffbdbfbea\"; int[] a = new int[s.length()]; for (int i = 0; i \u003c a.length; i++) a[i] = s.charAt(i)-'a'; sort(a, 26); for (var e : a) { System.out.printf(\"%c \", e+'a'); } } } LSD radix sort Least-significant-digit-first string sort Consider characters from right to left. Stably sort using dth character as the key (using key-indexed counting). public class LSD { public static void sort(String[] a, int W) { int R = 256; int N = a.length; String[] aux = new String[N]; for (int d = W-1; d \u003e= 0; d--) { int[] count = new int[R+1]; for (int i = 0; i \u003c N; i++) count[a[i].charAt(d)+1]++; for (int r = 0; r \u003c R; r++) count[r+1] += count[r]; for (int i = 0; i \u003c N; i++) aux[count[a[i].charAt(d)]++] = a[i]; for (int i = 0; i \u003c N; i++) a[i] = aux[i]; } } public static void main(String[] args) { In in = new In(\"D:\\\\Java_test\\\\test1\\\\src\\\\StringSort\\\\strings.txt\"); String[] a = in.readAllStrings(); int N = a.length; int w = a[0].length(); for (int i = 1; i \u003c N; i++) assert a[i].length() == w : \"String must have fixed length\"; sort(a, w); for (var e : a) System.out.println(e); } } Summary of the performence of sorting algorithms MSD radix sort Most-significant-digit-first srting sort Partition array into R pieces according to first character (using key-indexed counting). Recursively sort all strings that start with each character (key-indexed counts delineate subarrays to sort). Implementation public class MSD { final static int R = 256; public static void sort(String[] a) { String[] aux = new String[a.length]; sort(a, aux, 0, a.length-1, 0); } private static void sort(String[] a, String[] aux, int lo, int hi, int d) { if (hi \u003c= lo) return; int[] count = new int[R+2]; for (int i = lo; i \u003c= hi; i++) count[charAt(a[i], d)+2]++; for (int r = 0; r \u003c R + 1; r++) count[r+1] += count[r]; for (int i = lo; i \u003c= hi; i++) aux[count[charAt(a[i], d)+1]++] = a[i]; for (int i = lo; i \u003c= hi; i++) a[i] = aux[i - lo]; for (int r = 0; r \u003c R; r++) sort(a, aux, lo+count[r], lo+count[r+1]-1, d+1); } private static int charAt(String s, int d) { if (s.length() \u003e d) return s.charAt(d); else return -1; } public static void main(String[] args) { In in = new In(\"D:\\\\Java_test\\\\test1\\\\src\\\\StringSort\\\\strings.txt\"); String[] a = in.readAllStrings(); sort(a); for (var e : a) System.out.println(e); } } suffix arrays Longest repeated substring: Java implementation public class LRS { public static String lrs(String s) { int N = s.length(); String[] suffixes = new String[N]; for (int i = 0; i \u003c N; i++) suffixes[i] = s.substring(i, N); Arrays.sort(suffixes); String lrs = \"\"; for (int i = 0; i \u003c N - 1; i++) { int len = lcp(suffixes[i], suffixes[i+1]); if (len \u003e lrs.length()) lrs = suffixes[i].substring(0, len); } return lrs; } private static int lcp(String s, String t) { int n = Math.min(s.length(), t.length()); for (int i = 0; i \u003c n; i++) if (s.charAt(i) != t.charAt(i)) return i; return n; } public static void main(String[] args) { String s = \"aacaagtttacaagc\"; System.out.println(lrs(s)); } } ","wordCount":"7592","inLanguage":"en","datePublished":"2020-10-09T00:00:00Z","dateModified":"2020-10-09T00:00:00Z","author":{"@type":"Person","name":"fffzlfk"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://fffzlfk.github.io/posts/algorithm4th/"},"publisher":{"@type":"Organization","name":"fffzlfk's Blog","logo":{"@type":"ImageObject","url":"https://fffzlfk.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://fffzlfk.github.io accesskey=h title="fffzlfk's Blog (Alt + H)"><img src=https://fffzlfk.github.io/android-chrome-512x512.png alt aria-label=logo height=35>fffzlfk's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://github.com/fffzlfk title=GitHub><span>GitHub</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li><li><a href=https://fffzlfk.github.io/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://fffzlfk.github.io/archives title=Archive><span>Archive</span></a></li><li><a href=https://fffzlfk.github.io/about/ title=About><span>About</span></a></li><li><a href=https://fffzlfk.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://fffzlfk.github.io>Home</a>&nbsp;»&nbsp;<a href=https://fffzlfk.github.io/posts/>Posts</a></div><h1 class=post-title>算法（第四版）</h1><div class=post-meta><span title='2020-10-09 00:00:00 +0000 UTC'>October 9, 2020</span>&nbsp;·&nbsp;36 min&nbsp;·&nbsp;fffzlfk&nbsp;|&nbsp;<a href=https://github.com/fffzlfk/fffzlfk.github.io/blob/master/content/posts/Algorithm%284th%29.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#union-find aria-label=Union-Find>Union-Find</a><ul><li><a href=#quickfind aria-label=quickfind>quickfind</a><ul><li><a href=#java-implementation aria-label="Java implementation">Java implementation</a></li><li><a href=#analysis aria-label=analysis>analysis</a></li></ul></li><li><a href=#quick-union aria-label=quick-union>quick-union</a><ul><li><a href=#implementation aria-label=implementation>implementation</a></li><li><a href=#quick-union-worst-case aria-label="quick-union worst case">quick-union worst case</a></li></ul></li><li><a href=#weighted-quick-union aria-label="Weighted quick-union">Weighted quick-union</a></li><li><a href=#performance-characteristics-of-union-find-algorithms aria-label="Performance characteristics of union-find algorithms">Performance characteristics of union-find algorithms</a></li></ul></li><li><a href=#analysis-of-algorithms aria-label="Analysis of Algorithms">Analysis of Algorithms</a><ul><li><a href=#scientific-method aria-label="Scientific method">Scientific method</a></li><li><a href=#mathematical-models aria-label="Mathematical models">Mathematical models</a></li><li><a href=#commonly-used-notations-in-the-theory-of-algorithms aria-label="Commonly-used Notations in the Theory of Algorithms">Commonly-used Notations in the Theory of Algorithms</a></li><li><a href=#146 aria-label=1.4.6>1.4.6</a></li><li><a href=#1415 aria-label=1.4.15>1.4.15</a></li></ul></li><li><a href=#megersort aria-label=MegerSort>MegerSort</a><ul><li><a href=#implementation-1 aria-label=Implementation>Implementation</a></li><li><a href=#empirical-analysis aria-label="Empirical analysis">Empirical analysis</a><ul><li><a href=#divide-and-conquer-recurrence aria-label="Divide-and-conquer recurrence:">Divide-and-conquer recurrence:</a></li></ul></li><li><a href=#practical-improvements aria-label="practical improvements">practical improvements</a></li><li><a href=#bottom-up-mergesort aria-label="Bottom-up mergesort">Bottom-up mergesort</a><ul><li><a href=#implementation-2 aria-label=Implementation>Implementation</a></li></ul></li><li><a href=#sorting-complexity aria-label="Sorting Complexity">Sorting Complexity</a><ul><li><a href=#compare-based-lower-bound-for-sorting aria-label="Compare-based lower bound for sorting">Compare-based lower bound for sorting</a></li></ul></li><li><a href=#stability aria-label=Stability>Stability</a></li><li><a href=#222 aria-label=2.2.2>2.2.2</a></li><li><a href=#223 aria-label=2.2.3>2.2.3</a></li><li><a href=#224 aria-label=2.2.4>2.2.4</a></li><li><a href=#225 aria-label=2.2.5>2.2.5</a><ul><li><a href=#%e8%87%aa%e9%a1%b6%e5%90%91%e4%b8%8b aria-label=自顶向下>自顶向下</a></li><li><a href=#%e8%87%aa%e5%ba%95%e5%90%91%e4%b8%8a aria-label=自底向上>自底向上</a></li></ul></li></ul></li><li><a href=#quicksort aria-label=QuickSort>QuickSort</a><ul><li><a href=#quicksort-1 aria-label=quicksort>quicksort</a><ul><li><a href=#java-implementation-1 aria-label="Java implementation">Java implementation</a></li></ul></li><li><a href=#average-case-analysis aria-label="average-case analysis">average-case analysis</a></li><li><a href=#3-way-quicksort aria-label="3-way quicksort">3-way quicksort</a></li><li><a href=#231 aria-label=2.3.1>2.3.1</a></li><li><a href=#232 aria-label=2.3.2>2.3.2</a></li><li><a href=#233 aria-label=2.3.3>2.3.3</a></li><li><a href=#234 aria-label=2.3.4>2.3.4</a></li><li><a href=#235 aria-label=2.3.5>2.3.5</a></li></ul></li><li><a href=#priority-queues aria-label="Priority Queues">Priority Queues</a><ul><li><a href=#api aria-label=API>API</a></li><li><a href=#binary-heap aria-label=binary-heap>binary-heap</a><ul><li><a href=#java-implementation-2 aria-label="Java implementation">Java implementation</a></li></ul></li><li><a href=#heapsort aria-label=heapsort>heapsort</a><ul><li><a href=#basic-plan-for-in-place-sort aria-label="Basic plan for in-place sort">Basic plan for in-place sort</a></li><li><a href=#java-implementation-3 aria-label="Java implementation">Java implementation</a></li><li><a href=#mathematical-analysis aria-label="mathematical analysis">mathematical analysis</a></li><li><a href=#sorting-algorithms-summary aria-label="sorting-algorithms: summary">sorting-algorithms: summary</a></li></ul></li><li><a href=#242 aria-label=2.4.2>2.4.2</a></li><li><a href=#243 aria-label=2.4.3>2.4.3</a><ul><li><a href=#%e6%95%b0%e7%bb%84%e5%ae%9e%e7%8e%b0 aria-label=数组实现>数组实现</a></li><li><a href=#%e9%93%be%e8%a1%a8%e5%ae%9e%e7%8e%b0 aria-label=链表实现>链表实现</a></li><li><a href=#the-worst-case-bounds aria-label="the worst-case bounds">the worst-case bounds</a></li></ul></li><li><a href=#245 aria-label=2.4.5>2.4.5</a></li><li><a href=#247 aria-label=2.4.7>2.4.7</a></li><li><a href=#249 aria-label=2.4.9>2.4.9</a><ul><li><a href=#a-b-c-d-e aria-label="A B C D E">A B C D E</a></li><li><a href=#a-a-a-b-b aria-label="A A A B B">A A A B B</a></li></ul></li><li><a href=#2411 aria-label=2.4.11>2.4.11</a></li><li><a href=#2412 aria-label=2.4.12>2.4.12</a></li></ul></li><li><a href=#undirected-graphs aria-label="UNDIRECTED GRAPHS">UNDIRECTED GRAPHS</a><ul><li><a href=#depth-first-search aria-label=depth-first-search>depth-first-search</a></li><li><a href=#breadth-first-search aria-label=breadth-first-search>breadth-first-search</a></li><li><a href=#connected-components aria-label="connected components">connected components</a></li></ul></li><li><a href=#minimum-spanning-trees aria-label="Minimum Spanning Trees">Minimum Spanning Trees</a><ul><li><a href=#greedy-algorithm aria-label="Greedy algorithm">Greedy algorithm</a><ul><li><a href=#cut-property aria-label="Cut property">Cut property</a></li></ul></li><li><a href=#kruskals-algorithm aria-label="Kruskal&amp;rsquo;s algorithm">Kruskal&rsquo;s algorithm</a></li><li><a href=#prims-algorithm aria-label="Prim&amp;rsquo;s algorithm">Prim&rsquo;s algorithm</a><ul><li><a href=#lazyprim-implementation aria-label="LazyPrim Implementation">LazyPrim Implementation</a></li><li><a href=#indexed-priority-queue-implementation aria-label="Indexed priority queue implementation">Indexed priority queue implementation</a></li><li><a href=#eagerprim-implementation aria-label="EagerPrim Implementation">EagerPrim Implementation</a></li></ul></li><li><a href=#432 aria-label=4.3.2>4.3.2</a></li><li><a href=#433 aria-label=4.3.3>4.3.3</a></li><li><a href=#4313 aria-label=4.3.13>4.3.13</a></li></ul></li><li><a href=#shortest-paths aria-label="Shortest Paths">Shortest Paths</a><ul><li><a href=#shortest-paths-properties aria-label="shortest-paths properties">shortest-paths properties</a><ul><li><a href=#data-structures-for-single-source-shortest-paths aria-label="Data structures for single-source shortest paths">Data structures for single-source shortest paths</a></li><li><a href=#edge-relaxation aria-label="Edge relaxation">Edge relaxation</a></li><li><a href=#shortest-paths-optimality-conditions aria-label="Shortest-paths optimality conditions">Shortest-paths optimality conditions</a></li><li><a href=#genertic-shortest-paths-algorithm aria-label="Genertic shortest-paths algorithm">Genertic shortest-paths algorithm</a></li></ul></li><li><a href=#dijkstras-algorithm aria-label="Dijkstra&amp;rsquo;s algorithm">Dijkstra&rsquo;s algorithm</a><ul><li><a href=#dijkstras-algorithm-demo aria-label="Dijkstra&amp;rsquo;s algorithm Demo">Dijkstra&rsquo;s algorithm Demo</a></li><li><a href=#correctness-proof aria-label="correctness proof">correctness proof</a></li><li><a href=#java-implementation-4 aria-label="Java implementation">Java implementation</a></li></ul></li><li><a href=#edge-weighted-dags aria-label="edge-weighted DAGs">edge-weighted DAGs</a><ul><li><a href=#acyclic-shortest-paths-demo aria-label="Acyclic shortest paths demo">Acyclic shortest paths demo</a></li><li><a href=#shortest-paths-in-edge-weighted-dags aria-label="Shortest paths in edge-weighted DAGs">Shortest paths in edge-weighted DAGs</a></li><li><a href=#java-implementation-5 aria-label="Java Implementation">Java Implementation</a></li></ul></li><li><a href=#negative-weights aria-label="negative weights">negative weights</a><ul><li><a href=#bellman-ford-algorithm-analysis aria-label="Bellman-Ford algorithm: analysis">Bellman-Ford algorithm: analysis</a></li><li><a href=#bellman-ford-algorithm-practical-improvement aria-label="Bellman-Ford algorithm: practical improvement">Bellman-Ford algorithm: practical improvement</a></li><li><a href=#bellman-ford-java-implementation aria-label="Bellman-Ford Java implementation">Bellman-Ford Java implementation</a></li><li><a href=#single-source-shortest-path-implementation-cost-summary aria-label="Single source shortest-path implementation: cost summary">Single source shortest-path implementation: cost summary</a></li></ul></li><li><a href=#441 aria-label=4.4.1>4.4.1</a></li><li><a href=#445 aria-label=4.4.5>4.4.5</a></li><li><a href=#459 aria-label=4.5.9>4.5.9</a></li></ul></li><li><a href=#string-sorts aria-label="String sorts">String sorts</a><ul><li><a href=#key-indexed-counting aria-label="key-indexed counting">key-indexed counting</a></li><li><a href=#lsd-radix-sort aria-label="LSD radix sort">LSD radix sort</a><ul><li><a href=#least-significant-digit-first-string-sort aria-label="Least-significant-digit-first string sort">Least-significant-digit-first string sort</a></li><li><a href=#summary-of-the-performence-of-sorting-algorithms aria-label="Summary of the performence of sorting algorithms">Summary of the performence of sorting algorithms</a></li></ul></li><li><a href=#msd-radix-sort aria-label="MSD radix sort">MSD radix sort</a><ul><li><a href=#most-significant-digit-first-srting-sort aria-label="Most-significant-digit-first srting sort">Most-significant-digit-first srting sort</a></li><li><a href=#implementation-3 aria-label=Implementation>Implementation</a></li></ul></li><li><a href=#suffix-arrays aria-label="suffix arrays">suffix arrays</a><ul><li><a href=#longest-repeated-substring-java-implementation aria-label="Longest repeated substring: Java implementation">Longest repeated substring: Java implementation</a></li></ul></li></ul></li></ul></div></details></div><div class=post-content><h2 id=union-find>Union-Find<a hidden class=anchor aria-hidden=true href=#union-find>#</a></h2><h3 id=quickfind>quickfind<a hidden class=anchor aria-hidden=true href=#quickfind>#</a></h3><h4 id=java-implementation>Java implementation<a hidden class=anchor aria-hidden=true href=#java-implementation>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>QuickFindUF</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>int</span><span style=color:#f92672>[]</span> id<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>int</span> count<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#a6e22e>QuickFindUF</span><span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> n<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        id <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#66d9ef>int</span><span style=color:#f92672>[</span>n<span style=color:#f92672>];</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> 0<span style=color:#f92672>;</span> i <span style=color:#f92672>&lt;</span> n<span style=color:#f92672>;</span> i<span style=color:#f92672>++)</span>
</span></span><span style=display:flex><span>            id<span style=color:#f92672>[</span>i<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> i<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        count <span style=color:#f92672>=</span> n<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>int</span> <span style=color:#a6e22e>count</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> count<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>int</span> <span style=color:#a6e22e>find</span><span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> p<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> id<span style=color:#f92672>[</span>p<span style=color:#f92672>];</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>boolean</span> <span style=color:#a6e22e>connected</span><span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> p<span style=color:#f92672>,</span> <span style=color:#66d9ef>int</span> q<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> find<span style=color:#f92672>(</span>p<span style=color:#f92672>)</span> <span style=color:#f92672>==</span> find<span style=color:#f92672>(</span>q<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>union</span><span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> p<span style=color:#f92672>,</span> <span style=color:#66d9ef>int</span> q<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> pid <span style=color:#f92672>=</span> find<span style=color:#f92672>(</span>p<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> qid <span style=color:#f92672>=</span> find<span style=color:#f92672>(</span>q<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>pid <span style=color:#f92672>!=</span> qid<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> 0<span style=color:#f92672>;</span> i <span style=color:#f92672>&lt;</span> id<span style=color:#f92672>.</span><span style=color:#a6e22e>length</span><span style=color:#f92672>;</span> i<span style=color:#f92672>++)</span>
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>id<span style=color:#f92672>[</span>i<span style=color:#f92672>]</span> <span style=color:#f92672>==</span> pid<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                    id<span style=color:#f92672>[</span>i<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> qid<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>        count<span style=color:#f92672>--;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>main</span><span style=color:#f92672>(</span>String<span style=color:#f92672>[]</span> args<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        Scanner in <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Scanner<span style=color:#f92672>(</span>System<span style=color:#f92672>.</span><span style=color:#a6e22e>in</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        QuickFindUF uf <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> QuickFindUF<span style=color:#f92672>(</span>10<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>while</span> <span style=color:#f92672>(</span>in<span style=color:#f92672>.</span><span style=color:#a6e22e>hasNext</span><span style=color:#f92672>())</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>int</span> p <span style=color:#f92672>=</span> in<span style=color:#f92672>.</span><span style=color:#a6e22e>nextInt</span><span style=color:#f92672>(),</span> q <span style=color:#f92672>=</span> in<span style=color:#f92672>.</span><span style=color:#a6e22e>nextInt</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>uf<span style=color:#f92672>.</span><span style=color:#a6e22e>connected</span><span style=color:#f92672>(</span>p<span style=color:#f92672>,</span> q<span style=color:#f92672>))</span> <span style=color:#66d9ef>continue</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>            uf<span style=color:#f92672>.</span><span style=color:#a6e22e>union</span><span style=color:#f92672>(</span>p<span style=color:#f92672>,</span> q<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><h4 id=analysis>analysis<a hidden class=anchor aria-hidden=true href=#analysis>#</a></h4><p>The find() operation is certainly quick, as it only accesses the id[] array once in order to complete the operation. But quick-find is typically not useful for large problems because union() needs to scan through the whole id[] array for each input pair.</p><h3 id=quick-union>quick-union<a hidden class=anchor aria-hidden=true href=#quick-union>#</a></h3><h4 id=implementation>implementation<a hidden class=anchor aria-hidden=true href=#implementation>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#f92672>import</span> java.util.Scanner<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>QuickUnionUF</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>int</span><span style=color:#f92672>[]</span> id<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>int</span> count<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#a6e22e>QuickUnionUF</span><span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> n<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        id <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#66d9ef>int</span><span style=color:#f92672>[</span>n<span style=color:#f92672>];</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> 0<span style=color:#f92672>;</span> i <span style=color:#f92672>&lt;</span> n<span style=color:#f92672>;</span> i<span style=color:#f92672>++)</span>
</span></span><span style=display:flex><span>            id<span style=color:#f92672>[</span>i<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> i<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        count <span style=color:#f92672>=</span> n<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>int</span> <span style=color:#a6e22e>count</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> count<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>int</span> <span style=color:#a6e22e>find</span><span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> p<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>while</span> <span style=color:#f92672>(</span>p <span style=color:#f92672>!=</span> id<span style=color:#f92672>[</span>p<span style=color:#f92672>])</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            p <span style=color:#f92672>=</span> id<span style=color:#f92672>[</span>p<span style=color:#f92672>];</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> p<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>boolean</span> <span style=color:#a6e22e>connected</span><span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> p<span style=color:#f92672>,</span> <span style=color:#66d9ef>int</span> q<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> find<span style=color:#f92672>(</span>p<span style=color:#f92672>)</span> <span style=color:#f92672>==</span> find<span style=color:#f92672>(</span>q<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>union</span><span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> p<span style=color:#f92672>,</span> <span style=color:#66d9ef>int</span> q<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> pRoot <span style=color:#f92672>=</span> find<span style=color:#f92672>(</span>p<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> qRoot <span style=color:#f92672>=</span> find<span style=color:#f92672>(</span>q<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>pRoot <span style=color:#f92672>!=</span> qRoot<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            id<span style=color:#f92672>[</span>pRoot<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> qRoot<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span> <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>return</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        count<span style=color:#f92672>--;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>main</span><span style=color:#f92672>(</span>String<span style=color:#f92672>[]</span> args<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        Scanner in <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Scanner<span style=color:#f92672>(</span>System<span style=color:#f92672>.</span><span style=color:#a6e22e>in</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        QuickUnionUF uf <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> QuickUnionUF<span style=color:#f92672>(</span>10<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>while</span> <span style=color:#f92672>(</span>in<span style=color:#f92672>.</span><span style=color:#a6e22e>hasNext</span><span style=color:#f92672>())</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>int</span> p <span style=color:#f92672>=</span> in<span style=color:#f92672>.</span><span style=color:#a6e22e>nextInt</span><span style=color:#f92672>(),</span> q <span style=color:#f92672>=</span> in<span style=color:#f92672>.</span><span style=color:#a6e22e>nextInt</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>uf<span style=color:#f92672>.</span><span style=color:#a6e22e>connected</span><span style=color:#f92672>(</span>p<span style=color:#f92672>,</span> q<span style=color:#f92672>))</span> <span style=color:#66d9ef>continue</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>            uf<span style=color:#f92672>.</span><span style=color:#a6e22e>union</span><span style=color:#f92672>(</span>p<span style=color:#f92672>,</span> q<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><h4 id=quick-union-worst-case>quick-union worst case<a hidden class=anchor aria-hidden=true href=#quick-union-worst-case>#</a></h4><p><div class=render-image><img loading=lazy src=https://s1.ax1x.com/2020/11/01/B0Esk8.png alt></div></p><h3 id=weighted-quick-union>Weighted quick-union<a hidden class=anchor aria-hidden=true href=#weighted-quick-union>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#f92672>import</span> java.util.Scanner<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>WeightedQuickUnionUF</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>int</span><span style=color:#f92672>[]</span> id<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>int</span><span style=color:#f92672>[]</span> sz<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>int</span> count<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#a6e22e>WeightedQuickUnionUF</span><span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> N<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        count <span style=color:#f92672>=</span> N<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        id <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#66d9ef>int</span><span style=color:#f92672>[</span>N<span style=color:#f92672>];</span>
</span></span><span style=display:flex><span>        sz <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#66d9ef>int</span><span style=color:#f92672>[</span>N<span style=color:#f92672>];</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> 0<span style=color:#f92672>;</span> i <span style=color:#f92672>&lt;</span> N<span style=color:#f92672>;</span> i<span style=color:#f92672>++)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            id<span style=color:#f92672>[</span>i<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> i<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> 0<span style=color:#f92672>;</span> i <span style=color:#f92672>&lt;</span> N<span style=color:#f92672>;</span> i<span style=color:#f92672>++)</span>
</span></span><span style=display:flex><span>            sz<span style=color:#f92672>[</span>i<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> 1<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>int</span> <span style=color:#a6e22e>find</span><span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> p<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>while</span> <span style=color:#f92672>(</span>p <span style=color:#f92672>!=</span> id<span style=color:#f92672>[</span>p<span style=color:#f92672>])</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            id<span style=color:#f92672>[</span>p<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> id<span style=color:#f92672>[</span>id<span style=color:#f92672>[</span>p<span style=color:#f92672>]];</span> <span style=color:#75715e>// path compression by halving
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            p <span style=color:#f92672>=</span> id<span style=color:#f92672>[</span>p<span style=color:#f92672>];</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> p<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>boolean</span> <span style=color:#a6e22e>connected</span><span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> p<span style=color:#f92672>,</span> <span style=color:#66d9ef>int</span> q<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> find<span style=color:#f92672>(</span>p<span style=color:#f92672>)</span> <span style=color:#f92672>==</span> find<span style=color:#f92672>(</span>q<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>union</span><span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> p<span style=color:#f92672>,</span> <span style=color:#66d9ef>int</span> q<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> find<span style=color:#f92672>(</span>p<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> j <span style=color:#f92672>=</span> find<span style=color:#f92672>(</span>q<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>i <span style=color:#f92672>==</span> j<span style=color:#f92672>)</span> <span style=color:#66d9ef>return</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>sz<span style=color:#f92672>[</span>i<span style=color:#f92672>]</span> <span style=color:#f92672>&lt;</span> sz<span style=color:#f92672>[</span>j<span style=color:#f92672>])</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            id<span style=color:#f92672>[</span>i<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> j<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>            sz<span style=color:#f92672>[</span>j<span style=color:#f92672>]</span> <span style=color:#f92672>+=</span> sz<span style=color:#f92672>[</span>i<span style=color:#f92672>];</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span> <span style=color:#66d9ef>else</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            id<span style=color:#f92672>[</span>j<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> i<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>            sz<span style=color:#f92672>[</span>i<span style=color:#f92672>]</span> <span style=color:#f92672>+=</span> sz<span style=color:#f92672>[</span>j<span style=color:#f92672>];</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>        count<span style=color:#f92672>--;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>main</span><span style=color:#f92672>(</span>String<span style=color:#f92672>[]</span> args<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        Scanner in <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Scanner<span style=color:#f92672>(</span>System<span style=color:#f92672>.</span><span style=color:#a6e22e>in</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        WeightedQuickUnionUF uf <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> WeightedQuickUnionUF<span style=color:#f92672>(</span>10<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>while</span> <span style=color:#f92672>(</span>in<span style=color:#f92672>.</span><span style=color:#a6e22e>hasNext</span><span style=color:#f92672>())</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>int</span> p <span style=color:#f92672>=</span> in<span style=color:#f92672>.</span><span style=color:#a6e22e>nextInt</span><span style=color:#f92672>(),</span> q <span style=color:#f92672>=</span> in<span style=color:#f92672>.</span><span style=color:#a6e22e>nextInt</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>uf<span style=color:#f92672>.</span><span style=color:#a6e22e>connected</span><span style=color:#f92672>(</span>p<span style=color:#f92672>,</span> q<span style=color:#f92672>))</span> <span style=color:#66d9ef>continue</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>            uf<span style=color:#f92672>.</span><span style=color:#a6e22e>union</span><span style=color:#f92672>(</span>p<span style=color:#f92672>,</span> q<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><h3 id=performance-characteristics-of-union-find-algorithms>Performance characteristics of union-find algorithms<a hidden class=anchor aria-hidden=true href=#performance-characteristics-of-union-find-algorithms>#</a></h3><table><thead><tr><th>algorithm</th><th>constructor</th><th>union</th><th>find</th></tr></thead><tbody><tr><td>quick-find</td><td>N</td><td>N</td><td>1</td></tr><tr><td>quick-union</td><td>N</td><td>tree height</td><td>tree height</td></tr><tr><td>weighted quick-union</td><td>N</td><td>lgN</td><td>lgN</td></tr><tr><td>weighted quick-union with path compression</td><td>N</td><td>very, very nearly, but not quite 1</td><td>same as union</td></tr><tr><td>impossible</td><td>N</td><td>1</td><td>1</td></tr></tbody></table><h2 id=analysis-of-algorithms>Analysis of Algorithms<a hidden class=anchor aria-hidden=true href=#analysis-of-algorithms>#</a></h2><h3 id=scientific-method>Scientific method<a hidden class=anchor aria-hidden=true href=#scientific-method>#</a></h3><p>The very same approach that scientists use to understand the natural world is effective for studying the running time of programs.</p><ul><li><em>Observe</em> some feature of the natural world, generally with precise measurement.</li><li><em>Hypothesize</em> a model that is consistent with observations.</li><li><em>Predict</em> events using the hypothesis.</li><li><em>Verify</em> the predictions by making further observations.</li><li><em>Valitate</em> by repeating until the hypothesis and observations agree.</li></ul><h3 id=mathematical-models>Mathematical models<a hidden class=anchor aria-hidden=true href=#mathematical-models>#</a></h3><ul><li><em>Tilde approximations.</em> We use tilde approximations, where we throw away low-order terms that complicate formulas. We write <em>~f(N)</em> to represent any function that when divided by <em>f(N)</em> approaches 1 as <em>N</em> grows. We write <em>g(N)~f(N)</em> to indicate that <em>g(N)/f(N)</em> approaches 1 as <em>N</em> grows.</li><li><em>Order-of-growth classifications.</em> Most often, we work with tilde approximations of the form <em>g(N)~af(N)</em> where $ f(N) = N^b log_c N $ and refer to f(N) as the The order of growth of g(N). We use just a few structural primitives (statements, conditionals, loops, nesting, and method calls) to implement algorithms, so very often the order of growth of the cost is one of just a few functions of the problem size N.</li></ul><table><thead><tr><th>function</th><th>tilde approximation</th><th>order of growth</th></tr></thead><tbody><tr><td>$ \frac{N^3}{6}-\frac{N^2}{2}+\frac N 3 $</td><td>$~\frac{N^3}{6} $</td><td>$N^3$</td></tr><tr><td>$ \frac{N^3}{2}-\frac N 2$</td><td>$ ~\frac{N^2}{2} $</td><td>$N^2$</td></tr><tr><td>$lgN+1 $</td><td>$~lgN$</td><td>$lgN$</td></tr><tr><td>3</td><td>~3</td><td>1</td></tr></tbody></table><ul><li><em>Cost model.</em> We focus attention on properties of algorithms by articulating a cost model that defines the basic operations. For example, an appropriate cost model for the 3-sum problem is the number of times we access an array entry, for read or write.</li></ul><h3 id=commonly-used-notations-in-the-theory-of-algorithms>Commonly-used Notations in the Theory of Algorithms<a hidden class=anchor aria-hidden=true href=#commonly-used-notations-in-the-theory-of-algorithms>#</a></h3><table><thead><tr><th>notation</th><th>provides</th><th>example</th><th>shorthand for</th><th>used to</th></tr></thead><tbody><tr><td>Big Theta</td><td>asympatotic order of growth</td><td>$ \Theta (N^2) $</td><td>$\frac 1 2 N^2, 5N^2+22NlogN+3N$</td><td>classify algorithms</td></tr><tr><td>Big Oh</td><td>$\Theta (N^2)$and smaller</td><td>$O(N^2)$</td><td>$10N^2,\ 100N, 22NlogN+3N $</td><td>develop upper bounds</td></tr><tr><td>Big Omega</td><td>$\Theta (N^2)$and larger</td><td>$\Omega (N^2)$</td><td>$\frac 1 2 N^2, N^5, N^3+22NlogN+3N $</td><td>develop lower bounds</td></tr></tbody></table><h3 id=146>1.4.6<a hidden class=anchor aria-hidden=true href=#146>#</a></h3><p>Give the order of growth (as a function of N ) of the running times of each of the following code fragments:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>int</span> sum <span style=color:#f92672>=</span> 0<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> n <span style=color:#f92672>=</span> N<span style=color:#f92672>;</span> n <span style=color:#f92672>&gt;</span> 0<span style=color:#f92672>;</span> n <span style=color:#f92672>/=</span> 2<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>for</span><span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> 0<span style=color:#f92672>;</span> i <span style=color:#f92672>&lt;</span> n<span style=color:#f92672>;</span> i<span style=color:#f92672>++)</span>
</span></span><span style=display:flex><span>      sum<span style=color:#f92672>++;</span>
</span></span></code></pre></div><p>$$ N+\frac N 2+\frac N 4+\frac N 8+&mldr;+1=2N-1\ \ \sim 2N $$
所以是线性</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>int</span> sum <span style=color:#f92672>=</span> 0<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> 1 i <span style=color:#f92672>&lt;</span> N<span style=color:#f92672>;</span> i <span style=color:#f92672>*=</span> 2<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> j <span style=color:#f92672>=</span> 0<span style=color:#f92672>;</span> j <span style=color:#f92672>&lt;</span> i<span style=color:#f92672>;</span> j<span style=color:#f92672>++)</span>
</span></span><span style=display:flex><span>    sum<span style=color:#f92672>++;</span>
</span></span></code></pre></div><p>$$ 1+2+4+8+&mldr;+2^{\lfloor lgN \rfloor}=2^{\lfloor lgN \rfloor + 1}-1\ \ \sim 2N$$
所以是线性</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>int</span> sum <span style=color:#f92672>=</span> 0<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> 1 i <span style=color:#f92672>&lt;</span> N<span style=color:#f92672>;</span> i <span style=color:#f92672>*=</span> 2<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> j <span style=color:#f92672>=</span> 0<span style=color:#f92672>;</span> j <span style=color:#f92672>&lt;</span> N<span style=color:#f92672>;</span> j<span style=color:#f92672>++)</span>
</span></span><span style=display:flex><span>    sum<span style=color:#f92672>++;</span>
</span></span></code></pre></div><p>$$ NlgN $$ 线性对数</p><h3 id=1415>1.4.15<a hidden class=anchor aria-hidden=true href=#1415>#</a></h3><p>Faster 3-sum. As a warmup, develop an implementation TwoSumFaster that uses a linear algorithm to count the pairs that sum to zero after the array is sorted (in stead of the binary-search-based linearithmic algorithm). Then apply a similar idea to develop a quadratic algorithm for the 3-sum problem.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>int</span> <span style=color:#a6e22e>twoSumFaster</span><span style=color:#f92672>(</span><span style=color:#66d9ef>int</span><span style=color:#f92672>[]</span> a<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> lo <span style=color:#f92672>=</span> 0<span style=color:#f92672>,</span> hi <span style=color:#f92672>=</span> a<span style=color:#f92672>.</span><span style=color:#a6e22e>length</span> <span style=color:#f92672>-</span> 1<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> cnt <span style=color:#f92672>=</span> 0<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>while</span> <span style=color:#f92672>(</span>lo <span style=color:#f92672>&lt;</span> hi<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>a<span style=color:#f92672>[</span>lo<span style=color:#f92672>]</span> <span style=color:#f92672>+</span> a<span style=color:#f92672>[</span>hi<span style=color:#f92672>]</span> <span style=color:#f92672>==</span> 0<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            cnt<span style=color:#f92672>++;</span>
</span></span><span style=display:flex><span>            lo<span style=color:#f92672>++;</span>
</span></span><span style=display:flex><span>            hi<span style=color:#f92672>--;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span> <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>a<span style=color:#f92672>[</span>lo<span style=color:#f92672>]</span> <span style=color:#f92672>+</span> a<span style=color:#f92672>[</span>hi<span style=color:#f92672>]</span> <span style=color:#f92672>&gt;</span> 0<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>            hi<span style=color:#f92672>--;</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>            lo<span style=color:#f92672>++;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> cnt<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>int</span> <span style=color:#a6e22e>threeSumFaster</span><span style=color:#f92672>(</span><span style=color:#66d9ef>int</span><span style=color:#f92672>[]</span> a<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> cnt <span style=color:#f92672>=</span> 0<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> 0<span style=color:#f92672>;</span> i <span style=color:#f92672>&lt;</span> a<span style=color:#f92672>.</span><span style=color:#a6e22e>length</span><span style=color:#f92672>;</span> i<span style=color:#f92672>++)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> lo <span style=color:#f92672>=</span> i <span style=color:#f92672>+</span> 1<span style=color:#f92672>,</span> hi <span style=color:#f92672>=</span> a<span style=color:#f92672>.</span><span style=color:#a6e22e>length</span> <span style=color:#f92672>-</span> 1<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>while</span> <span style=color:#f92672>(</span>lo <span style=color:#f92672>&lt;</span> hi<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>a<span style=color:#f92672>[</span>i<span style=color:#f92672>]</span> <span style=color:#f92672>+</span> a<span style=color:#f92672>[</span>lo<span style=color:#f92672>]</span> <span style=color:#f92672>+</span> a<span style=color:#f92672>[</span>hi<span style=color:#f92672>]</span> <span style=color:#f92672>==</span> 0<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                cnt<span style=color:#f92672>++;</span>
</span></span><span style=display:flex><span>                lo<span style=color:#f92672>++;</span>
</span></span><span style=display:flex><span>                hi<span style=color:#f92672>--;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>}</span> <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>a<span style=color:#f92672>[</span>i<span style=color:#f92672>]</span> <span style=color:#f92672>+</span> a<span style=color:#f92672>[</span>lo<span style=color:#f92672>]</span> <span style=color:#f92672>+</span> a<span style=color:#f92672>[</span>hi<span style=color:#f92672>]</span> <span style=color:#f92672>&gt;</span> 0<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>                hi<span style=color:#f92672>--;</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>                lo<span style=color:#f92672>++;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> cnt<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><h2 id=megersort>MegerSort<a hidden class=anchor aria-hidden=true href=#megersort>#</a></h2><h3 id=implementation-1>Implementation<a hidden class=anchor aria-hidden=true href=#implementation-1>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Merge</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>boolean</span> <span style=color:#a6e22e>isSorted</span><span style=color:#f92672>(</span>Comparable<span style=color:#f92672>[]</span> a<span style=color:#f92672>,</span> <span style=color:#66d9ef>int</span> lo<span style=color:#f92672>,</span> <span style=color:#66d9ef>int</span> hi<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> lo <span style=color:#f92672>+</span> 1<span style=color:#f92672>;</span> i <span style=color:#f92672>&lt;=</span> hi<span style=color:#f92672>;</span> i<span style=color:#f92672>++)</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>less<span style=color:#f92672>(</span>a<span style=color:#f92672>[</span>i<span style=color:#f92672>],</span> a<span style=color:#f92672>[</span>i <span style=color:#f92672>-</span> 1<span style=color:#f92672>]))</span> <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>false</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>true</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>boolean</span> <span style=color:#a6e22e>less</span><span style=color:#f92672>(</span>Comparable v<span style=color:#f92672>,</span> Comparable w<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> v<span style=color:#f92672>.</span><span style=color:#a6e22e>compareTo</span><span style=color:#f92672>(</span>w<span style=color:#f92672>)</span> <span style=color:#f92672>&lt;</span> 0<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>merge</span><span style=color:#f92672>(</span>Comparable<span style=color:#f92672>[]</span> a<span style=color:#f92672>,</span> Comparable<span style=color:#f92672>[]</span> aux<span style=color:#f92672>,</span> <span style=color:#66d9ef>int</span> lo<span style=color:#f92672>,</span> <span style=color:#66d9ef>int</span> mid<span style=color:#f92672>,</span> <span style=color:#66d9ef>int</span> hi<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>assert</span> isSorted<span style=color:#f92672>(</span>a<span style=color:#f92672>,</span> lo<span style=color:#f92672>,</span> mid<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>assert</span> isSorted<span style=color:#f92672>(</span>a<span style=color:#f92672>,</span> mid <span style=color:#f92672>+</span> 1<span style=color:#f92672>,</span> hi<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> k <span style=color:#f92672>=</span> lo<span style=color:#f92672>;</span> k <span style=color:#f92672>&lt;=</span> hi<span style=color:#f92672>;</span> k<span style=color:#f92672>++)</span>
</span></span><span style=display:flex><span>            aux<span style=color:#f92672>[</span>k<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> a<span style=color:#f92672>[</span>k<span style=color:#f92672>];</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> lo<span style=color:#f92672>,</span> j <span style=color:#f92672>=</span> mid <span style=color:#f92672>+</span> 1<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> k <span style=color:#f92672>=</span> lo<span style=color:#f92672>;</span> k <span style=color:#f92672>&lt;=</span> hi<span style=color:#f92672>;</span> k<span style=color:#f92672>++)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>i <span style=color:#f92672>&gt;</span> mid<span style=color:#f92672>)</span> a<span style=color:#f92672>[</span>k<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> aux<span style=color:#f92672>[</span>j<span style=color:#f92672>++];</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>j <span style=color:#f92672>&gt;</span> hi<span style=color:#f92672>)</span> a<span style=color:#f92672>[</span>k<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> aux<span style=color:#f92672>[</span>i<span style=color:#f92672>++];</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>less<span style=color:#f92672>(</span>aux<span style=color:#f92672>[</span>j<span style=color:#f92672>],</span> aux<span style=color:#f92672>[</span>i<span style=color:#f92672>]))</span> a<span style=color:#f92672>[</span>k<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> aux<span style=color:#f92672>[</span>j<span style=color:#f92672>++];</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>else</span> a<span style=color:#f92672>[</span>k<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> aux<span style=color:#f92672>[</span>i<span style=color:#f92672>++];</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>assert</span> isSorted<span style=color:#f92672>(</span>a<span style=color:#f92672>,</span> lo<span style=color:#f92672>,</span> hi<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>sort</span><span style=color:#f92672>(</span>Comparable<span style=color:#f92672>[]</span> a<span style=color:#f92672>,</span> Comparable<span style=color:#f92672>[]</span> aux<span style=color:#f92672>,</span> <span style=color:#66d9ef>int</span> lo<span style=color:#f92672>,</span> <span style=color:#66d9ef>int</span> hi<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>hi <span style=color:#f92672>&lt;=</span> lo<span style=color:#f92672>)</span> <span style=color:#66d9ef>return</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> mid <span style=color:#f92672>=</span> lo <span style=color:#f92672>+</span> <span style=color:#f92672>(</span>hi <span style=color:#f92672>-</span> lo<span style=color:#f92672>)</span> <span style=color:#f92672>/</span> 2<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        sort<span style=color:#f92672>(</span>aux<span style=color:#f92672>,</span> a<span style=color:#f92672>,</span> lo<span style=color:#f92672>,</span> mid<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        sort<span style=color:#f92672>(</span>aux<span style=color:#f92672>,</span> a<span style=color:#f92672>,</span> mid<span style=color:#f92672>+</span>1<span style=color:#f92672>,</span> hi<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        merge<span style=color:#f92672>(</span>a<span style=color:#f92672>,</span> aux<span style=color:#f92672>,</span> lo<span style=color:#f92672>,</span> mid<span style=color:#f92672>,</span> hi<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>sort</span><span style=color:#f92672>(</span>Comparable<span style=color:#f92672>[]</span> a<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        Comparable<span style=color:#f92672>[]</span> aux <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Comparable<span style=color:#f92672>[</span>a<span style=color:#f92672>.</span><span style=color:#a6e22e>length</span><span style=color:#f92672>];</span>
</span></span><span style=display:flex><span>        sort<span style=color:#f92672>(</span>a<span style=color:#f92672>,</span> aux<span style=color:#f92672>,</span> 0<span style=color:#f92672>,</span> a<span style=color:#f92672>.</span><span style=color:#a6e22e>length</span> <span style=color:#f92672>-</span> 1<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>main</span><span style=color:#f92672>(</span>String<span style=color:#f92672>[]</span> args<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> N <span style=color:#f92672>=</span> StdIn<span style=color:#f92672>.</span><span style=color:#a6e22e>readInt</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>        Comparable<span style=color:#f92672>[]</span> a <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Comparable<span style=color:#f92672>[</span>N<span style=color:#f92672>];</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> 0<span style=color:#f92672>;</span> i <span style=color:#f92672>&lt;</span> N<span style=color:#f92672>;</span> i<span style=color:#f92672>++)</span>
</span></span><span style=display:flex><span>            a<span style=color:#f92672>[</span>i<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> StdRandom<span style=color:#f92672>.</span><span style=color:#a6e22e>uniform</span><span style=color:#f92672>(-</span>10000<span style=color:#f92672>,</span>10000<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        Stopwatch stopwatch <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Stopwatch<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>        sort<span style=color:#f92672>(</span>a<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span>var i <span style=color:#f92672>:</span> a<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>print</span><span style=color:#f92672>(</span>i <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34; &#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>        System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>println</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>        System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>println</span><span style=color:#f92672>(</span>stopwatch<span style=color:#f92672>.</span><span style=color:#a6e22e>elapsedTime</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><h3 id=empirical-analysis>Empirical analysis<a hidden class=anchor aria-hidden=true href=#empirical-analysis>#</a></h3><p>The number of compares $C(N)$ and array accesses $A(N)$ to mergesort an array of size N satisfy the recurrences:<br>$$ C(N) \le C(\lceil{\frac N 2}\rceil) + C(\lfloor{\frac N 2}\rfloor) + N\ \ for N > 1,with \ C(1)=0. $$
$$
A(N) \le A(\lceil{\frac N 2}\rceil) + A(\lfloor{\frac N 2}\rfloor) + 6N\ \ for N > 1,with \ A(1)=0.
$$
we solve the recurrence when $ N $ is a power of 2.
$$ D(N) = 2D(\frac N 2) + N, for N > 1, with\ D(1) = 0. $$</p><h4 id=divide-and-conquer-recurrence>Divide-and-conquer recurrence:<a hidden class=anchor aria-hidden=true href=#divide-and-conquer-recurrence>#</a></h4><ol><li><p>proof by picture</p><p><div class=render-image><img loading=lazy src=/img/merge-pic.png alt></div></p></li><li><p>proof by expansion</p><p>$$
\begin{aligned}
D(N)&=2D(N/2)+N \cr
{D(N)} /{N} &= 2D(N / 2)/N + 1\cr
&= D(N/2)/(N/2)+1 \cr
&= D(N/4)/(N/4) + 1 + 1\cr
&= D(N/8)/(N/8) + 1 + 1 + 1\cr
&mldr;\cr
&= D(N/N)/(N/N)+1+1+&mldr;+1\cr
&= lgN
\end{aligned}
$$</p></li><li><p>proof by induction</p><ul><li>Base case: $N = 1$</li><li>Induction hypothesis: $D(N)=Nlg(N)$.</li><li>Goal: showthat $ D(2N) = (2N)lg(2N).$</li></ul><p>$$
\begin{aligned}
D(2N) &= 2D(N)+2N \cr
&= 2NlgN+2N \cr
&= 2N(lgN+1) \cr
&= 2Nlg(2N)
\end{aligned}
$$</p></li></ol><h3 id=practical-improvements>practical improvements<a hidden class=anchor aria-hidden=true href=#practical-improvements>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>sort</span><span style=color:#f92672>(</span>Comparable<span style=color:#f92672>[]</span> a<span style=color:#f92672>,</span> Comparable<span style=color:#f92672>[]</span> aux<span style=color:#f92672>,</span> <span style=color:#66d9ef>int</span> lo<span style=color:#f92672>,</span> <span style=color:#66d9ef>int</span> hi<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Use insertion sort for samll subarrays.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>final</span> <span style=color:#66d9ef>int</span> CUTOFF <span style=color:#f92672>=</span> 7<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>hi <span style=color:#f92672>&lt;=</span> lo <span style=color:#f92672>+</span> CUTOFF <span style=color:#f92672>-</span> 1<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        Insertion<span style=color:#f92672>.</span><span style=color:#a6e22e>sort</span><span style=color:#f92672>(</span>a<span style=color:#f92672>,</span> lo<span style=color:#f92672>,</span> hi<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> mid <span style=color:#f92672>=</span> lo <span style=color:#f92672>+</span> <span style=color:#f92672>(</span>hi <span style=color:#f92672>-</span> lo<span style=color:#f92672>)</span> <span style=color:#f92672>/</span> 2<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    sort<span style=color:#f92672>(</span>a<span style=color:#f92672>,</span> aux<span style=color:#f92672>,</span> lo<span style=color:#f92672>,</span> mid<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    sort<span style=color:#f92672>(</span>a<span style=color:#f92672>,</span> aux<span style=color:#f92672>,</span> mid <span style=color:#f92672>+</span> 1<span style=color:#f92672>,</span> hi<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Stop if already sorted.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>if</span> <span style=color:#f92672>(!</span>less<span style=color:#f92672>(</span>a<span style=color:#f92672>[</span>mid<span style=color:#f92672>+</span>1<span style=color:#f92672>],</span> a<span style=color:#f92672>[</span>mid<span style=color:#f92672>]))</span> <span style=color:#66d9ef>return</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    merge<span style=color:#f92672>(</span>a<span style=color:#f92672>,</span> aux<span style=color:#f92672>,</span> lo<span style=color:#f92672>,</span> mid<span style=color:#f92672>,</span> hi<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><p>Eliminate the copy to the auxiliary array.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>merge</span><span style=color:#f92672>(</span>Comparable<span style=color:#f92672>[]</span> a<span style=color:#f92672>,</span>Comparable<span style=color:#f92672>[]</span> aux<span style=color:#f92672>,</span> <span style=color:#66d9ef>int</span> lo<span style=color:#f92672>,</span> <span style=color:#66d9ef>int</span> mid<span style=color:#f92672>,</span> <span style=color:#66d9ef>int</span> hi<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> lo<span style=color:#f92672>,</span> j <span style=color:#f92672>=</span> mid <span style=color:#f92672>+</span> 1<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> k <span style=color:#f92672>=</span> lo<span style=color:#f92672>;</span> k <span style=color:#f92672>&lt;=</span> hi<span style=color:#f92672>;</span> k<span style=color:#f92672>++)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>i <span style=color:#f92672>&gt;</span> mid<span style=color:#f92672>)</span> aux<span style=color:#f92672>[</span>k<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> a<span style=color:#f92672>[</span>j<span style=color:#f92672>++];</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>j <span style=color:#f92672>&gt;</span> hi<span style=color:#f92672>)</span> aux<span style=color:#f92672>[</span>k<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> a<span style=color:#f92672>[</span>i<span style=color:#f92672>++];</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>less<span style=color:#f92672>(</span>a<span style=color:#f92672>[</span>j<span style=color:#f92672>],</span> a<span style=color:#f92672>[</span>i<span style=color:#f92672>]))</span> aux<span style=color:#f92672>[</span>k<span style=color:#f92672>]</span> <span style=color:#f92672>=</span>a<span style=color:#f92672>[</span>j<span style=color:#f92672>++];</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span> aux<span style=color:#f92672>[</span>k<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> a<span style=color:#f92672>[</span>i<span style=color:#f92672>++];</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>sort</span><span style=color:#f92672>(</span>Comparable<span style=color:#f92672>[]</span> a<span style=color:#f92672>,</span>Comparable<span style=color:#f92672>[]</span> aux<span style=color:#f92672>,</span> <span style=color:#66d9ef>int</span> lo<span style=color:#f92672>,</span> <span style=color:#66d9ef>int</span> hi<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>hi <span style=color:#f92672>&lt;=</span> lo<span style=color:#f92672>)</span> <span style=color:#66d9ef>return</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> mid <span style=color:#f92672>=</span> lo <span style=color:#f92672>+</span> <span style=color:#f92672>(</span>hi <span style=color:#f92672>-</span> lo<span style=color:#f92672>)</span> <span style=color:#f92672>/</span> 2<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>//switch soles of aux[] and a[]
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    sort<span style=color:#f92672>(</span>aux<span style=color:#f92672>,</span> a<span style=color:#f92672>,</span> lo<span style=color:#f92672>,</span> mid<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    sort<span style=color:#f92672>(</span>aux<span style=color:#f92672>,</span> a<span style=color:#f92672>,</span> mid<span style=color:#f92672>+</span>1<span style=color:#f92672>,</span> hi<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    merge<span style=color:#f92672>(</span>a<span style=color:#f92672>,</span> aux<span style=color:#f92672>,</span> lo<span style=color:#f92672>,</span> mid<span style=color:#f92672>,</span> hi<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><h3 id=bottom-up-mergesort>Bottom-up mergesort<a hidden class=anchor aria-hidden=true href=#bottom-up-mergesort>#</a></h3><h4 id=implementation-2>Implementation<a hidden class=anchor aria-hidden=true href=#implementation-2>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>merge</span><span style=color:#f92672>(</span>Comparable<span style=color:#f92672>[]</span> a<span style=color:#f92672>,</span> Comparable<span style=color:#f92672>[]</span> aux<span style=color:#f92672>,</span> <span style=color:#66d9ef>int</span> lo<span style=color:#f92672>,</span> <span style=color:#66d9ef>int</span> mid<span style=color:#f92672>,</span> <span style=color:#66d9ef>int</span> hi<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> k <span style=color:#f92672>=</span> lo<span style=color:#f92672>;</span> k <span style=color:#f92672>&lt;=</span> hi<span style=color:#f92672>;</span> k<span style=color:#f92672>++)</span>
</span></span><span style=display:flex><span>        aux<span style=color:#f92672>[</span>k<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> a<span style=color:#f92672>[</span>k<span style=color:#f92672>];</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> lo<span style=color:#f92672>,</span> j <span style=color:#f92672>=</span> mid <span style=color:#f92672>+</span> 1<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> k <span style=color:#f92672>=</span> lo<span style=color:#f92672>;</span> k <span style=color:#f92672>&lt;=</span> hi<span style=color:#f92672>;</span> k<span style=color:#f92672>++)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>i <span style=color:#f92672>&gt;</span> mid<span style=color:#f92672>)</span> a<span style=color:#f92672>[</span>k<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> aux<span style=color:#f92672>[</span>j<span style=color:#f92672>++];</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>j <span style=color:#f92672>&gt;</span> hi<span style=color:#f92672>)</span> a<span style=color:#f92672>[</span>k<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> aux<span style=color:#f92672>[</span>i<span style=color:#f92672>++];</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>less<span style=color:#f92672>(</span>aux<span style=color:#f92672>[</span>j<span style=color:#f92672>],</span> aux<span style=color:#f92672>[</span>i<span style=color:#f92672>]))</span> a<span style=color:#f92672>[</span>k<span style=color:#f92672>]=</span> aux<span style=color:#f92672>[</span>j<span style=color:#f92672>++];</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span> a<span style=color:#f92672>[</span>k<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> aux<span style=color:#f92672>[</span>i<span style=color:#f92672>++];</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>sort</span><span style=color:#f92672>(</span>Comparable<span style=color:#f92672>[]</span> a<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> N <span style=color:#f92672>=</span> a<span style=color:#f92672>.</span><span style=color:#a6e22e>length</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    Comparable<span style=color:#f92672>[]</span> aux <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Comparable<span style=color:#f92672>[</span>N<span style=color:#f92672>];</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> sz <span style=color:#f92672>=</span> 1<span style=color:#f92672>;</span> sz <span style=color:#f92672>&lt;</span> N<span style=color:#f92672>;</span> sz <span style=color:#f92672>=</span> sz <span style=color:#f92672>+</span> sz<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> lo <span style=color:#f92672>=</span> 0<span style=color:#f92672>;</span> lo <span style=color:#f92672>&lt;</span> N <span style=color:#f92672>-</span> sz<span style=color:#f92672>;</span> lo <span style=color:#f92672>+=</span>sz <span style=color:#f92672>+</span> sz<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>            merge<span style=color:#f92672>(</span>a<span style=color:#f92672>,</span> aux<span style=color:#f92672>,</span> lo<span style=color:#f92672>,</span> lo <span style=color:#f92672>+</span> sz <span style=color:#f92672>-</span>1<span style=color:#f92672>,</span>Math<span style=color:#f92672>.</span><span style=color:#a6e22e>min</span><span style=color:#f92672>(</span>lo<span style=color:#f92672>+</span>sz<span style=color:#f92672>+</span>sz<span style=color:#f92672>-</span>1<span style=color:#f92672>,</span> N<span style=color:#f92672>-</span>1<span style=color:#f92672>));</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>main</span><span style=color:#f92672>(</span>String<span style=color:#f92672>[]</span> args<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> N <span style=color:#f92672>=</span> StdIn<span style=color:#f92672>.</span><span style=color:#a6e22e>readInt</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>    Comparable<span style=color:#f92672>[]</span> a <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Comparable<span style=color:#f92672>[</span>N<span style=color:#f92672>];</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> 0<span style=color:#f92672>;</span> i <span style=color:#f92672>&lt;</span> N<span style=color:#f92672>;</span> i<span style=color:#f92672>++)</span>
</span></span><span style=display:flex><span>        a<span style=color:#f92672>[</span>i<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> StdRandom<span style=color:#f92672>.</span><span style=color:#a6e22e>uniform</span><span style=color:#f92672>(-</span>1000010000<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    Stopwatch stopwatch <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Stopwatch<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>    sort<span style=color:#f92672>(</span>a<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span>var i <span style=color:#f92672>:</span> a<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>print</span><span style=color:#f92672>(</span>i <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34; &#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>println</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>    System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>println</span><span style=color:#f92672>(</span>stopwatch<span style=color:#f92672>.</span><span style=color:#a6e22e>elapsedTim</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><h3 id=sorting-complexity>Sorting Complexity<a hidden class=anchor aria-hidden=true href=#sorting-complexity>#</a></h3><ul><li>Model of computation: decision tree.</li><li>Cost model: # compares.</li><li>Upper bound: $\sim NlgN $from mergesort</li><li>Lower bound: ?</li><li>Optimal algorithm: ?</li></ul><h4 id=compare-based-lower-bound-for-sorting>Compare-based lower bound for sorting<a hidden class=anchor aria-hidden=true href=#compare-based-lower-bound-for-sorting>#</a></h4><ul><li><p>Proposition. Any Compare-based sorting algorothm must use at least $lg(N!)\sim NlogN $(Stirling formula) compares in the worst-case.</p></li><li><p>Pf.</p><ul><li>Assume array consists of $N$ distinct values $a_1$ through $ a_n $.</li><li>Worst case dictated by height $h$ of decision tree.</li><li>Binary tree of height $h$ has at most $2^h$ leaves.</li><li>$N! $different orderings $\Rightarrow$ at least $ N!$ leaves.</li></ul><p>$$
\begin{aligned}
2^h \ge ＃leaves \ge N! \cr
\Rightarrow h \ge lg(N!)\sim NlgN
\end{aligned}$$</p></li></ul><h3 id=stability>Stability<a hidden class=anchor aria-hidden=true href=#stability>#</a></h3><ul><li>Insertion sort is <strong>stable</strong>: Equal items never move fast each other.<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>insertionSort</span><span style=color:#f92672>(</span>Comparable<span style=color:#f92672>[]</span> a<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> N <span style=color:#f92672>=</span> a<span style=color:#f92672>.</span><span style=color:#a6e22e>length</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> 0<span style=color:#f92672>;</span> i <span style=color:#f92672>&lt;</span> N<span style=color:#f92672>;</span> i<span style=color:#f92672>++)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> j <span style=color:#f92672>=</span> i<span style=color:#f92672>;</span> j <span style=color:#f92672>&gt;</span> 0 <span style=color:#f92672>&amp;&amp;</span> less<span style=color:#f92672>(</span>a<span style=color:#f92672>[</span>j<span style=color:#f92672>],</span> a<span style=color:#f92672>[</span>j <span style=color:#f92672>-</span> 1<span style=color:#f92672>]);</span> j<span style=color:#f92672>--)</span>
</span></span><span style=display:flex><span>            exch<span style=color:#f92672>(</span>a<span style=color:#f92672>,</span> j<span style=color:#f92672>,</span> j <span style=color:#f92672>-</span> 1<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div></li><li>Selection sort is <strong>not</strong> stable: Long-distance exchange might move an item past some equal item.<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>selectionSort</span><span style=color:#f92672>(</span>Comparable<span style=color:#f92672>[]</span> a<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> N <span style=color:#f92672>=</span> a<span style=color:#f92672>.</span><span style=color:#a6e22e>length</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> 0<span style=color:#f92672>;</span> i <span style=color:#f92672>&lt;</span> N<span style=color:#f92672>;</span> i<span style=color:#f92672>++)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> min <span style=color:#f92672>=</span> i<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> j <span style=color:#f92672>=</span> i <span style=color:#f92672>+</span> 1<span style=color:#f92672>;</span> j <span style=color:#f92672>&lt;</span> N<span style=color:#f92672>;</span> j<span style=color:#f92672>++)</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>less<span style=color:#f92672>(</span>a<span style=color:#f92672>[</span>j<span style=color:#f92672>],</span> a<span style=color:#f92672>[</span>min<span style=color:#f92672>]))</span>
</span></span><span style=display:flex><span>                min <span style=color:#f92672>=</span> j<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        exch<span style=color:#f92672>(</span>a<span style=color:#f92672>,</span> i<span style=color:#f92672>,</span> min<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div></li><li>Shellsort is <strong>not</strong> stable: Long-distence exchange.<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>shellSort</span><span style=color:#f92672>(</span>Comparable<span style=color:#f92672>[]</span> a<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> N <span style=color:#f92672>=</span> a<span style=color:#f92672>.</span><span style=color:#a6e22e>length</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> h <span style=color:#f92672>=</span> 1<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>while</span> <span style=color:#f92672>(</span>h <span style=color:#f92672>&lt;</span> N <span style=color:#f92672>/</span> 3<span style=color:#f92672>)</span> h <span style=color:#f92672>=</span> 3 <span style=color:#f92672>*</span> h <span style=color:#f92672>+</span> 1<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>while</span> <span style=color:#f92672>(</span>h <span style=color:#f92672>&gt;=</span> 1<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> h<span style=color:#f92672>;</span> i <span style=color:#f92672>&lt;</span> N<span style=color:#f92672>;</span> i<span style=color:#f92672>++)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> j <span style=color:#f92672>=</span> i<span style=color:#f92672>;</span> j <span style=color:#f92672>&gt;</span> h <span style=color:#f92672>&amp;&amp;</span> less<span style=color:#f92672>(</span>a<span style=color:#f92672>[</span>j<span style=color:#f92672>],</span> a<span style=color:#f92672>[</span>j <span style=color:#f92672>-</span> h<span style=color:#f92672>]);</span> j <span style=color:#f92672>-=</span> h<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>                exch<span style=color:#f92672>(</span>a<span style=color:#f92672>,</span> j<span style=color:#f92672>,</span> j <span style=color:#f92672>-</span> h<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>        h <span style=color:#f92672>/=</span> 3<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div></li><li>Mergesort is <strong>stable</strong>.: Suffices to verify that merge operation is table.</li></ul><h3 id=222>2.2.2<a hidden class=anchor aria-hidden=true href=#222>#</a></h3><p>Give traces, in the style of the trace given with Algorithm 2.4, showing how the
keys E A S Y Q U E S T I O N are sorted with top-down mergesort.</p><table><thead><tr><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th>a[]</th><th></th><th></th><th></th><th></th><th></th><th></th><th></th></tr></thead><tbody><tr><td>lo</td><td>mid</td><td>hi</td><td>0</td><td>1</td><td>2</td><td>3</td><td>4</td><td>5</td><td>6</td><td>7</td><td>8</td><td>9</td><td>10</td><td>11</td></tr><tr><td></td><td></td><td></td><td>E</td><td>A</td><td>S</td><td>Y</td><td>Q</td><td>U</td><td>E</td><td>S</td><td>T</td><td>I</td><td>O</td><td>N</td></tr><tr><td>0</td><td>0</td><td>1</td><td><strong>A</strong></td><td><strong>E</strong></td><td>S</td><td>Y</td><td>Q</td><td>U</td><td>E</td><td>S</td><td>T</td><td>I</td><td>O</td><td>N</td></tr><tr><td>0</td><td>1</td><td>2</td><td><strong>A</strong></td><td><strong>E</strong></td><td><strong>S</strong></td><td>Y</td><td>Q</td><td>U</td><td>E</td><td>S</td><td>T</td><td>I</td><td>O</td><td>N</td></tr><tr><td>3</td><td>3</td><td>4</td><td>A</td><td>E</td><td>S</td><td><strong>Q</strong></td><td><strong>Y</strong></td><td>U</td><td>E</td><td>S</td><td>T</td><td>I</td><td>O</td><td>N</td></tr><tr><td>3</td><td>4</td><td>5</td><td>A</td><td>E</td><td>S</td><td><strong>Q</strong></td><td><strong>U</strong></td><td><strong>Y</strong></td><td>E</td><td>S</td><td>T</td><td>I</td><td>O</td><td>N</td></tr><tr><td>0</td><td>2</td><td>5</td><td><strong>A</strong></td><td><strong>E</strong></td><td><strong>Q</strong></td><td><strong>S</strong></td><td><strong>U</strong></td><td><strong>Y</strong></td><td>E</td><td>S</td><td>T</td><td>I</td><td>O</td><td>N</td></tr><tr><td>6</td><td>6</td><td>7</td><td>A</td><td>E</td><td>Q</td><td>S</td><td>U</td><td>Y</td><td><strong>E</strong></td><td><strong>S</strong></td><td>T</td><td>I</td><td>O</td><td>N</td></tr><tr><td>6</td><td>7</td><td>8</td><td>A</td><td>E</td><td>Q</td><td>S</td><td>U</td><td>Y</td><td><strong>E</strong></td><td><strong>S</strong></td><td><strong>T</strong></td><td>I</td><td>O</td><td>N</td></tr><tr><td>9</td><td>9</td><td>10</td><td>A</td><td>E</td><td>Q</td><td>S</td><td>U</td><td>Y</td><td>E</td><td>S</td><td>T</td><td><strong>I</strong></td><td><strong>O</strong></td><td>N</td></tr><tr><td>9</td><td>10</td><td>11</td><td>A</td><td>E</td><td>Q</td><td>S</td><td>U</td><td>Y</td><td>E</td><td>S</td><td>T</td><td><strong>I</strong></td><td><strong>N</strong></td><td><strong>O</strong></td></tr><tr><td>6</td><td>8</td><td>11</td><td>A</td><td>E</td><td>Q</td><td>S</td><td>U</td><td>Y</td><td><strong>E</strong></td><td><strong>I</strong></td><td><strong>N</strong></td><td><strong>O</strong></td><td><strong>S</strong></td><td><strong>T</strong></td></tr><tr><td>0</td><td>5</td><td>11</td><td><strong>A</strong></td><td><strong>E</strong></td><td><strong>E</strong></td><td><strong>I</strong></td><td><strong>N</strong></td><td><strong>O</strong></td><td><strong>Q</strong></td><td><strong>S</strong></td><td><strong>S</strong></td><td><strong>T</strong></td><td><strong>U</strong></td><td><strong>Y</strong></td></tr><tr><td></td><td></td><td></td><td>A</td><td>E</td><td>E</td><td>I</td><td>N</td><td>O</td><td>Q</td><td>S</td><td>S</td><td>T</td><td>U</td><td>Y</td></tr></tbody></table><h3 id=223>2.2.3<a hidden class=anchor aria-hidden=true href=#223>#</a></h3><p>Answer Exercise 2.2.2 for bottom-up mergesort.</p><table><thead><tr><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th>a[]</th><th></th><th></th><th></th><th></th><th></th><th></th><th></th></tr></thead><tbody><tr><td>lo</td><td>mid</td><td>hi</td><td>0</td><td>1</td><td>2</td><td>3</td><td>4</td><td>5</td><td>6</td><td>7</td><td>8</td><td>9</td><td>10</td><td>11</td></tr><tr><td></td><td></td><td></td><td>E</td><td>A</td><td>S</td><td>Y</td><td>Q</td><td>U</td><td>E</td><td>S</td><td>T</td><td>I</td><td>O</td><td>N</td></tr><tr><td>0</td><td>0</td><td>1</td><td><strong>A</strong></td><td><strong>E</strong></td><td>S</td><td>Y</td><td>Q</td><td>U</td><td>E</td><td>S</td><td>T</td><td>I</td><td>O</td><td>N</td></tr><tr><td>2</td><td>2</td><td>3</td><td>A</td><td>E</td><td><strong>S</strong></td><td><strong>Y</strong></td><td>Q</td><td>U</td><td>E</td><td>S</td><td>T</td><td>I</td><td>O</td><td>N</td></tr><tr><td>4</td><td>4</td><td>5</td><td>A</td><td>E</td><td>S</td><td>Y</td><td><strong>Q</strong></td><td><strong>U</strong></td><td>E</td><td>S</td><td>T</td><td>I</td><td>O</td><td>N</td></tr><tr><td>6</td><td>6</td><td>7</td><td>A</td><td>E</td><td>S</td><td>Y</td><td>Q</td><td>U</td><td><strong>E</strong></td><td><strong>S</strong></td><td>T</td><td>I</td><td>O</td><td>N</td></tr><tr><td>8</td><td>8</td><td>9</td><td>A</td><td>E</td><td>S</td><td>Y</td><td>Q</td><td>U</td><td>E</td><td>S</td><td><strong>I</strong></td><td><strong>T</strong></td><td>O</td><td>N</td></tr><tr><td>10</td><td>10</td><td>11</td><td>A</td><td>E</td><td>S</td><td>Y</td><td>Q</td><td>U</td><td>E</td><td>S</td><td>I</td><td>T</td><td><strong>N</strong></td><td><strong>O</strong></td></tr><tr><td>0</td><td>1</td><td>3</td><td><strong>A</strong></td><td><strong>E</strong></td><td><strong>S</strong></td><td><strong>Y</strong></td><td>Q</td><td>U</td><td>E</td><td>S</td><td>I</td><td>T</td><td>N</td><td>O</td></tr><tr><td>4</td><td>5</td><td>7</td><td>A</td><td>E</td><td>S</td><td>Y</td><td><strong>E</strong></td><td><strong>Q</strong></td><td><strong>S</strong></td><td><strong>U</strong></td><td>I</td><td>T</td><td>N</td><td>O</td></tr><tr><td>8</td><td>9</td><td>11</td><td>A</td><td>E</td><td>S</td><td>Y</td><td>E</td><td>Q</td><td>S</td><td>U</td><td><strong>I</strong></td><td><strong>N</strong></td><td><strong>O</strong></td><td><strong>T</strong></td></tr><tr><td>0</td><td>3</td><td>7</td><td><strong>A</strong></td><td><strong>E</strong></td><td><strong>E</strong></td><td><strong>Q</strong></td><td><strong>S</strong></td><td><strong>S</strong></td><td><strong>U</strong></td><td><strong>Y</strong></td><td><strong>I</strong></td><td>N</td><td>O</td><td>T</td></tr><tr><td>0</td><td>7</td><td>11</td><td><strong>A</strong></td><td><strong>E</strong></td><td><strong>E</strong></td><td><strong>I</strong></td><td><strong>N</strong></td><td><strong>O</strong></td><td><strong>Q</strong></td><td><strong>S</strong></td><td><strong>S</strong></td><td><strong>T</strong></td><td><strong>U</strong></td><td><strong>Y</strong></td></tr><tr><td></td><td></td><td></td><td>A</td><td>E</td><td>E</td><td>I</td><td>N</td><td>O</td><td>Q</td><td>S</td><td>S</td><td>T</td><td>U</td><td>Y</td></tr></tbody></table><h3 id=224>2.2.4<a hidden class=anchor aria-hidden=true href=#224>#</a></h3><p>Does the abstract in-place merge produce proper output if and only if the two input subarrays are in sorted order? Prove your answer, or provide a counterexample.(是否当且仅当两个输入的数组都有序时原地归并的抽象方法才能得到正确的结果？证明你的结论，或者给出一个反例。)</p><ul><li>是的，只有当两个输入数组都有序时采用原地归并才能得到正确的结果。</li><li>反例：数组1：[4, 2, 3],数组2：[1, 5, 8];<br>按归并算法归并后得到[1,4,2,3,5,8]; 可以看到归并后元素的相对位置不变，故得到错误的结果。</li></ul><h3 id=225>2.2.5<a hidden class=anchor aria-hidden=true href=#225>#</a></h3><p>Give the sequence of subarray sizes in the merges performed by both the top-down and the bottom-up mergesort algorithms, for N = 39.
(当输入数组的大小N=39时，给出自顶向下和自底向上的归并排序中各归并子数组的大小及顺序。)</p><h4 id=自顶向下>自顶向下<a hidden class=anchor aria-hidden=true href=#自顶向下>#</a></h4><p>2, 3, 2, 5, 2, 3, 2, 5, 10, 2, 3, 2, 5, 2, 3, 2, 5, 10, 20, 2, 3, 2, 5, 2, 3, 2, 5, 10, 2, 3, 2, 5, 2, 2, 4, 9, 19, 39</p><h4 id=自底向上>自底向上<a hidden class=anchor aria-hidden=true href=#自底向上>#</a></h4><p>2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 4, 4, 4, 4, 4, 4, 4, 4, 4, 3, 8, 8, 8, 8, 7, 16, 16, 32, 39</p><h2 id=quicksort>QuickSort<a hidden class=anchor aria-hidden=true href=#quicksort>#</a></h2><h3 id=quicksort-1>quicksort<a hidden class=anchor aria-hidden=true href=#quicksort-1>#</a></h3><p>Basic plan:</p><ul><li><strong>Shuffle</strong> the array</li><li><strong>Partition</strong> so that, for some j<ul><li>entry a[j] in place</li><li>no larger entry to the left of j</li><li>no smaller entry to the right of j</li></ul></li><li><strong>Sort</strong> each piece recursively.</li></ul><h4 id=java-implementation-1>Java implementation<a hidden class=anchor aria-hidden=true href=#java-implementation-1>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Quick</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>boolean</span> <span style=color:#a6e22e>less</span><span style=color:#f92672>(</span>Comparable v<span style=color:#f92672>,</span> Comparable w<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> v<span style=color:#f92672>.</span><span style=color:#a6e22e>compareTo</span><span style=color:#f92672>(</span>w<span style=color:#f92672>)</span> <span style=color:#f92672>&lt;</span> 0<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>exch</span><span style=color:#f92672>(</span>Comparable<span style=color:#f92672>[]</span> a<span style=color:#f92672>,</span> <span style=color:#66d9ef>int</span> i<span style=color:#f92672>,</span> <span style=color:#66d9ef>int</span> j<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        Comparable t <span style=color:#f92672>=</span> a<span style=color:#f92672>[</span>i<span style=color:#f92672>];</span>
</span></span><span style=display:flex><span>        a<span style=color:#f92672>[</span>i<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> a<span style=color:#f92672>[</span>j<span style=color:#f92672>];</span>
</span></span><span style=display:flex><span>        a<span style=color:#f92672>[</span>j<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> t<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>int</span> <span style=color:#a6e22e>partition</span><span style=color:#f92672>(</span>Comparable<span style=color:#f92672>[]</span> a<span style=color:#f92672>,</span> <span style=color:#66d9ef>int</span> lo<span style=color:#f92672>,</span> <span style=color:#66d9ef>int</span> hi<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> lo<span style=color:#f92672>,</span> j <span style=color:#f92672>=</span> hi <span style=color:#f92672>+</span> 1<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>while</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>true</span><span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>while</span> <span style=color:#f92672>(</span>less<span style=color:#f92672>(</span>a<span style=color:#f92672>[++</span>i<span style=color:#f92672>],</span> a<span style=color:#f92672>[</span>lo<span style=color:#f92672>]))</span>
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>i <span style=color:#f92672>==</span> hi<span style=color:#f92672>)</span> <span style=color:#66d9ef>break</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>while</span> <span style=color:#f92672>(</span>less<span style=color:#f92672>(</span>a<span style=color:#f92672>[</span>lo<span style=color:#f92672>],</span> a<span style=color:#f92672>[--</span>j<span style=color:#f92672>]))</span>
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>j <span style=color:#f92672>==</span> lo<span style=color:#f92672>)</span> <span style=color:#66d9ef>break</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>i <span style=color:#f92672>&gt;=</span> j<span style=color:#f92672>)</span> <span style=color:#66d9ef>break</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>            exch<span style=color:#f92672>(</span>a<span style=color:#f92672>,</span> i<span style=color:#f92672>,</span> j<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>        exch<span style=color:#f92672>(</span>a<span style=color:#f92672>,</span> lo<span style=color:#f92672>,</span> j<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> j<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>sort</span><span style=color:#f92672>(</span>Comparable<span style=color:#f92672>[]</span> a<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        StdRandom<span style=color:#f92672>.</span><span style=color:#a6e22e>shuffle</span><span style=color:#f92672>(</span>a<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        sort<span style=color:#f92672>(</span>a<span style=color:#f92672>,</span> 0<span style=color:#f92672>,</span> a<span style=color:#f92672>.</span><span style=color:#a6e22e>length</span> <span style=color:#f92672>-</span> 1<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>sort</span><span style=color:#f92672>(</span>Comparable<span style=color:#f92672>[]</span> a<span style=color:#f92672>,</span> <span style=color:#66d9ef>int</span> lo<span style=color:#f92672>,</span> <span style=color:#66d9ef>int</span> hi<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>lo <span style=color:#f92672>&gt;=</span> hi<span style=color:#f92672>)</span> <span style=color:#66d9ef>return</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> j <span style=color:#f92672>=</span> partition<span style=color:#f92672>(</span>a<span style=color:#f92672>,</span> lo<span style=color:#f92672>,</span> hi<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        sort<span style=color:#f92672>(</span>a<span style=color:#f92672>,</span> lo<span style=color:#f92672>,</span> j <span style=color:#f92672>-</span> 1<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        sort<span style=color:#f92672>(</span>a<span style=color:#f92672>,</span> j <span style=color:#f92672>+</span> 1<span style=color:#f92672>,</span> hi<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><h3 id=average-case-analysis>average-case analysis<a hidden class=anchor aria-hidden=true href=#average-case-analysis>#</a></h3><p>$C_N $ satisfies the recurrence $C_0 = C_1=0$ and for $ N\ge 2 $:<br>$$ C_N = (N + 1) + (\frac{C_0+C_{N-1}}{N})+ (\frac{C_1+C_{N-2}}{N})+ &mldr; +(\frac{C_{N-1}+C_{0{N}}}) $$</p><ul><li><p>Multiply both sides by N and collect terms:
$$ NC_N = N(N+1)+2(C_0+C_1+&mldr;+C_{N-1}) $$</p></li><li><p>Substract this from the same equation for $N - 1$:
$$ NC_N-(N-1)C_{N-1}=2N+2C_{N-1} $$</p></li><li><p>Rearrage terms and devide by $N(N+1)$:
$$ \frac{C_N}{N+1} = \frac{C_{N-1{N}}} + \frac{2}{N+1} $$</p></li><li><p>Repeatedly apply above equation:
$$
\begin{aligned}
\frac{C_N}{N+1} &= \frac{C_{N-1}}{N}+\frac{2}{N+1} \cr
&= \frac{C_{N-2}}{N-1}+\frac{2}{N}+\frac{2}{N+1} \cr
&= \frac{C_{N-3}}{N-2}+\frac{2}{N-1}+\frac{2}{N}+\frac{2}{N+1} \cr
&= \frac 2 3 + \frac 2 4 + \frac 2 5 +&mldr;+\frac 2 {N+1}
\end{aligned}
$$</p></li><li><p>Approximate sum by an integral:
$$
\begin{aligned}
C_N &= 2(N+1)(\frac 1 3 + \frac 1 4 + \frac 1 5 +&mldr;+ \frac{1}{N+1}) \cr
& \sim 2(N+1) \int_{3}^{N+1}{\frac{1}{x}dx}
\end{aligned}
$$</p></li><li><p>Finally, the desired result:
$$ C_N \sim 2(N+1)lnN \sim 1.39NlgN $$</p></li></ul><h3 id=3-way-quicksort>3-way quicksort<a hidden class=anchor aria-hidden=true href=#3-way-quicksort>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#66d9ef>template</span> <span style=color:#f92672>&lt;</span><span style=color:#66d9ef>typename</span> T<span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>void</span> threeWayQuickSort(T a[], <span style=color:#66d9ef>int</span> lo, <span style=color:#66d9ef>int</span> hi) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (hi <span style=color:#f92672>&lt;=</span> lo) <span style=color:#66d9ef>return</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> lt <span style=color:#f92672>=</span> lo, gt <span style=color:#f92672>=</span> hi;
</span></span><span style=display:flex><span>    T v <span style=color:#f92672>=</span> a[lo];
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> lo;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>while</span> (i <span style=color:#f92672>&lt;=</span> gt) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (a[i] <span style=color:#f92672>&lt;</span> v)
</span></span><span style=display:flex><span>            swap(a[lt<span style=color:#f92672>++</span>], a[i<span style=color:#f92672>++</span>]);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span> <span style=color:#a6e22e>if</span> (a[i] <span style=color:#f92672>&gt;</span> v)
</span></span><span style=display:flex><span>            swap(a[gt<span style=color:#f92672>--</span>], a[i]);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>            i<span style=color:#f92672>++</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    threeWayQuickSort(a, lo, lt <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>    threeWayQuickSort(a, gt <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>, hi);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=231>2.3.1<a hidden class=anchor aria-hidden=true href=#231>#</a></h3><p>Show, in the style of the trace given with partition(), how that method patitions the array E A S Y Q U E S T I O N.</p><table><thead><tr><th>i</th><th>j</th><th>0</th><th>1</th><th>2</th><th>3</th><th>4</th><th>5</th><th>6</th><th>7</th><th>8</th><th>9</th><th>10</th><th>11</th></tr></thead><tbody><tr><td>0</td><td>12</td><td>E</td><td>A</td><td>S</td><td>Y</td><td>Q</td><td>U</td><td>E</td><td>S</td><td>T</td><td>I</td><td>O</td><td>N</td></tr><tr><td>2</td><td>6</td><td>E</td><td>A</td><td>S</td><td>Y</td><td>Q</td><td>U</td><td>E</td><td>S</td><td>T</td><td>I</td><td>O</td><td>N</td></tr><tr><td>2</td><td>6</td><td>E</td><td>A</td><td><strong>E</strong></td><td>Y</td><td>Q</td><td>U</td><td><strong>S</strong></td><td>S</td><td>T</td><td>I</td><td>O</td><td>N</td></tr><tr><td>3</td><td>2</td><td>E</td><td>A</td><td>E</td><td>Y</td><td>Q</td><td>U</td><td>S</td><td>S</td><td>T</td><td>I</td><td>O</td><td>N</td></tr><tr><td></td><td>2</td><td><strong>E</strong></td><td>A</td><td><strong>E</strong></td><td>Y</td><td>Q</td><td>U</td><td>S</td><td>S</td><td>T</td><td>I</td><td>O</td><td>N</td></tr></tbody></table><h3 id=232>2.3.2<a hidden class=anchor aria-hidden=true href=#232>#</a></h3><p>Show, in the style of the quicksort trace given in this section, how quicksort sorts the array E A S Y Q U E S T I O N (for the purposes of this exercise, ignore the initial shuffle).</p><p><div class=render-image><img loading=lazy src=https://s1.ax1x.com/2020/10/27/BlExEV.png alt></div></p><h3 id=233>2.3.3<a hidden class=anchor aria-hidden=true href=#233>#</a></h3><p>What is the maximum number of times during the execution of Quick.sort() that the largest item can be exchanged, for an array of length N ?
(对于长度为N的数组，在Quick.sort()执行时，其最大的元素最多会被交换多少次？)</p><p>在Quick.sort()中，一个元素被交换可分为两种情况：</p><ol><li>该元素是枢轴，在partition最后一步和j交换</li><li>该元素在本次partition中不是枢轴，出现在了枢轴错的一侧，需要被交换到另一侧</li></ol><ul><li>如果该元素是枢轴，那么在交换后它的位置就固定下来了，之后不再涉及交换，因此要使交换次数最大，这个元素应该是在每次partition时都位于枢轴错误的一侧，因为是最大的元素，所以应该总是在枢轴的左侧。</li><li>为了使得partition的次数尽可能的多，需要使得每次移动的距离短，这里我们先考虑每次移动一位，如数组[5,9,1,6,7]：<ul><li>枢轴为5，交换后变为[5,1,9,6,7]</li><li>枢轴交换，变为[1,5,9,6,7]</li><li>我们发现在下一次partition中最大元素9会成为枢轴，不再被交换</li></ul></li><li>所以考虑每次移动两位，如数组[2,10,4,1,6,3,8,5,7,9]<ul><li>枢轴为2，交换后[2,1,4,10,6,3,8,5,7,9]</li><li>枢轴交换，变为[1,2,4,10,6,3,8,5,7,9]</li><li>枢轴为4，交换后[1,2,4,3,6,10,8,5,7,9]</li><li>枢轴交换，变为[1,2,3,4,6,10,8,5,7,9]</li><li>枢轴为6，交换后[1,2,3,4,6,5,8,10,7,9]</li><li>枢轴交换，变为[1,2,3,4,5,6,8,10,7,9]</li><li>枢轴为8，交换后[1,2,3,4,5,6,8,7,10,9]</li><li>枢轴交换，变为[1,2,3,4,5,6,7,8,10,9]</li><li>枢轴为10，交换后[1,2,3,4,5,6,7,8,9,10]</li></ul></li><li>在上面这个N=10的数组中，“10”这个最大的元素一共被交换了5次，所以我们可以认为对于N个元素的数组，在执行Quick.sort()时最大元素最多会被交换N/2次。</li></ul><h3 id=234>2.3.4<a hidden class=anchor aria-hidden=true href=#234>#</a></h3><p>Suppose that the initial random shuffle is omitted. Give six arrays of ten elements
for which Quick.sort() uses the worst-case number of compares.</p><p>如果始终选第一个元素作为枢轴的话，要使比较次数达到最坏情况的话，输入数组应为升序。比较次数达到$ N + N-1 + N-2 + N-3 +&mldr;+1 = \frac{N(N+1)}{2} \sim N^2/2 $
例如：</p><ul><li>[1,2,3,4,5,6,7,8,9,10]</li><li>[2,4,6,8,10,12,14,16,18,20]</li><li>[-1,1,3,5,7,9,11,13,15,17]</li><li>[10,20,30,40,50,60,70,80,90,100]</li><li>[5,10,15,20,25,30,35,40,45,50]</li><li>[0,2,3,4,6,7,8,9,10,12]</li></ul><h3 id=235>2.3.5<a hidden class=anchor aria-hidden=true href=#235>#</a></h3><p>Give a code fragment that sorts an array that is known to consist of items having
just two distinct keys.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>sort</span><span style=color:#f92672>(</span>Comparable<span style=color:#f92672>[]</span> a<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> lo <span style=color:#f92672>=</span> 0<span style=color:#f92672>,</span> hi <span style=color:#f92672>=</span> a<span style=color:#f92672>.</span><span style=color:#a6e22e>length</span> <span style=color:#f92672>-</span> 1<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> 0<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>while</span> <span style=color:#f92672>(</span>i <span style=color:#f92672>&lt;=</span> hi<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> tmp <span style=color:#f92672>=</span> a<span style=color:#f92672>[</span>i<span style=color:#f92672>].</span><span style=color:#a6e22e>compareTo</span><span style=color:#f92672>(</span>a<span style=color:#f92672>[</span>lo<span style=color:#f92672>]);</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>tmp <span style=color:#f92672>&lt;</span> 0<span style=color:#f92672>)</span> exch<span style=color:#f92672>(</span>a<span style=color:#f92672>,</span> lo<span style=color:#f92672>++,</span> i<span style=color:#f92672>++);</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>tmp <span style=color:#f92672>&gt;</span> 0<span style=color:#f92672>)</span> exch<span style=color:#f92672>(</span>a<span style=color:#f92672>,</span> i<span style=color:#f92672>,</span> hi<span style=color:#f92672>--);</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span> i<span style=color:#f92672>++;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><h2 id=priority-queues>Priority Queues<a hidden class=anchor aria-hidden=true href=#priority-queues>#</a></h2><h3 id=api>API<a hidden class=anchor aria-hidden=true href=#api>#</a></h3><p><div class=render-image><img loading=lazy src=https://s1.ax1x.com/2020/11/05/BWuxX9.png alt></div></p><h3 id=binary-heap>binary-heap<a hidden class=anchor aria-hidden=true href=#binary-heap>#</a></h3><h4 id=java-implementation-2>Java implementation<a hidden class=anchor aria-hidden=true href=#java-implementation-2>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>MaxPQ</span><span style=color:#f92672>&lt;</span>Key <span style=color:#66d9ef>extends</span> Comparable<span style=color:#f92672>&lt;</span>Key<span style=color:#f92672>&gt;&gt;</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> Key<span style=color:#f92672>[]</span> pq<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>int</span> N <span style=color:#f92672>=</span> 0<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#a6e22e>MaxPQ</span><span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> maxN<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        pq <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>Key<span style=color:#f92672>[])</span> <span style=color:#66d9ef>new</span> Comparable<span style=color:#f92672>[</span>maxN <span style=color:#f92672>+</span> 1<span style=color:#f92672>];</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>boolean</span> <span style=color:#a6e22e>isEmpty</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> N <span style=color:#f92672>==</span> 0<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>int</span> <span style=color:#a6e22e>size</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> N<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>insert</span><span style=color:#f92672>(</span>Key v<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        pq<span style=color:#f92672>[++</span>N<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> v<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        swim<span style=color:#f92672>(</span>N<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> Key <span style=color:#a6e22e>delMax</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        Key max <span style=color:#f92672>=</span> pq<span style=color:#f92672>[</span>1<span style=color:#f92672>];</span>
</span></span><span style=display:flex><span>        exch<span style=color:#f92672>(</span>1<span style=color:#f92672>,</span> N<span style=color:#f92672>--);</span>
</span></span><span style=display:flex><span>        sink<span style=color:#f92672>(</span>1<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        pq<span style=color:#f92672>[</span>N<span style=color:#f92672>+</span>1<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>null</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> max<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>boolean</span> <span style=color:#a6e22e>less</span><span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> i<span style=color:#f92672>,</span> <span style=color:#66d9ef>int</span> j<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> pq<span style=color:#f92672>[</span>i<span style=color:#f92672>].</span><span style=color:#a6e22e>compareTo</span><span style=color:#f92672>(</span>pq<span style=color:#f92672>[</span>j<span style=color:#f92672>])</span> <span style=color:#f92672>&lt;</span> 0<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>exch</span><span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> i<span style=color:#f92672>,</span> <span style=color:#66d9ef>int</span> j<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        Key tmp <span style=color:#f92672>=</span> pq<span style=color:#f92672>[</span>i<span style=color:#f92672>];</span>
</span></span><span style=display:flex><span>        pq<span style=color:#f92672>[</span>i<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> pq<span style=color:#f92672>[</span>j<span style=color:#f92672>];</span>
</span></span><span style=display:flex><span>        pq<span style=color:#f92672>[</span>j<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> tmp<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>swim</span><span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> k<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>while</span> <span style=color:#f92672>(</span>k <span style=color:#f92672>&gt;</span> 1 <span style=color:#f92672>&amp;&amp;</span> less<span style=color:#f92672>(</span>k <span style=color:#f92672>/</span> 2<span style=color:#f92672>,</span> k<span style=color:#f92672>))</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            exch<span style=color:#f92672>(</span>k <span style=color:#f92672>/</span> 2<span style=color:#f92672>,</span> k<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>            k <span style=color:#f92672>/=</span> 2<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>sink</span><span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> k<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>while</span> <span style=color:#f92672>(</span>2 <span style=color:#f92672>*</span> k <span style=color:#f92672>&lt;=</span> N<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>int</span> j <span style=color:#f92672>=</span> 2 <span style=color:#f92672>*</span> k<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>j <span style=color:#f92672>&lt;</span> N <span style=color:#f92672>&amp;&amp;</span> less<span style=color:#f92672>(</span>j<span style=color:#f92672>,</span> j <span style=color:#f92672>+</span> 1<span style=color:#f92672>))</span> j<span style=color:#f92672>++;</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> <span style=color:#f92672>(!</span>less<span style=color:#f92672>(</span>k<span style=color:#f92672>,</span> j<span style=color:#f92672>))</span> <span style=color:#66d9ef>break</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>            exch<span style=color:#f92672>(</span>k<span style=color:#f92672>,</span> j<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>            k <span style=color:#f92672>=</span> j<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><h3 id=heapsort>heapsort<a hidden class=anchor aria-hidden=true href=#heapsort>#</a></h3><h4 id=basic-plan-for-in-place-sort>Basic plan for in-place sort<a hidden class=anchor aria-hidden=true href=#basic-plan-for-in-place-sort>#</a></h4><ul><li>Create max-heap with all N keys.</li><li>Repatedly remove the maximum key.</li></ul><h4 id=java-implementation-3>Java implementation<a hidden class=anchor aria-hidden=true href=#java-implementation-3>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Heap</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>sort</span><span style=color:#f92672>(</span>Comparable<span style=color:#f92672>[]</span> a<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> N <span style=color:#f92672>=</span> a<span style=color:#f92672>.</span><span style=color:#a6e22e>length</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> k <span style=color:#f92672>=</span> N <span style=color:#f92672>/</span> 2<span style=color:#f92672>;</span> k <span style=color:#f92672>&gt;=</span> 1<span style=color:#f92672>;</span> k<span style=color:#f92672>--)</span>
</span></span><span style=display:flex><span>            sink<span style=color:#f92672>(</span>a<span style=color:#f92672>,</span> k<span style=color:#f92672>,</span> N<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>while</span> <span style=color:#f92672>(</span>N <span style=color:#f92672>&gt;</span> 1<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            exch<span style=color:#f92672>(</span>a<span style=color:#f92672>,</span> 1<span style=color:#f92672>,</span> N<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>            sink<span style=color:#f92672>(</span>a<span style=color:#f92672>,</span> 1<span style=color:#f92672>,</span> <span style=color:#f92672>--</span>N<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>boolean</span> <span style=color:#a6e22e>less</span><span style=color:#f92672>(</span>Comparable a<span style=color:#f92672>[],</span> <span style=color:#66d9ef>int</span> i<span style=color:#f92672>,</span> <span style=color:#66d9ef>int</span> j<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> a<span style=color:#f92672>[</span>i <span style=color:#f92672>-</span> 1<span style=color:#f92672>].</span><span style=color:#a6e22e>compareTo</span><span style=color:#f92672>(</span>a<span style=color:#f92672>[</span>j <span style=color:#f92672>-</span> 1<span style=color:#f92672>])</span> <span style=color:#f92672>&lt;</span> 0<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>exch</span><span style=color:#f92672>(</span>Comparable a<span style=color:#f92672>[],</span> <span style=color:#66d9ef>int</span> i<span style=color:#f92672>,</span> <span style=color:#66d9ef>int</span> j<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        Comparable t <span style=color:#f92672>=</span> a<span style=color:#f92672>[</span>i <span style=color:#f92672>-</span> 1<span style=color:#f92672>];</span>
</span></span><span style=display:flex><span>        a<span style=color:#f92672>[</span>i <span style=color:#f92672>-</span> 1<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> a<span style=color:#f92672>[</span>j <span style=color:#f92672>-</span> 1<span style=color:#f92672>];</span>
</span></span><span style=display:flex><span>        a<span style=color:#f92672>[</span>j <span style=color:#f92672>-</span> 1<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> t<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>sink</span><span style=color:#f92672>(</span>Comparable<span style=color:#f92672>[]</span> a<span style=color:#f92672>,</span> <span style=color:#66d9ef>int</span> k<span style=color:#f92672>,</span> <span style=color:#66d9ef>int</span> N<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>while</span> <span style=color:#f92672>(</span>2 <span style=color:#f92672>*</span> k <span style=color:#f92672>&lt;=</span> N<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>int</span> j <span style=color:#f92672>=</span> 2 <span style=color:#f92672>*</span> k<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>j <span style=color:#f92672>&lt;</span> N <span style=color:#f92672>&amp;&amp;</span> less<span style=color:#f92672>(</span>a<span style=color:#f92672>,</span> j<span style=color:#f92672>,</span> j <span style=color:#f92672>+</span> 1<span style=color:#f92672>))</span> j<span style=color:#f92672>++;</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> <span style=color:#f92672>(!</span>less<span style=color:#f92672>(</span>a<span style=color:#f92672>,</span> k<span style=color:#f92672>,</span> j<span style=color:#f92672>))</span> <span style=color:#66d9ef>break</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>            exch<span style=color:#f92672>(</span>a<span style=color:#f92672>,</span> k<span style=color:#f92672>,</span> j<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>            k <span style=color:#f92672>=</span> j<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><h4 id=mathematical-analysis>mathematical analysis<a hidden class=anchor aria-hidden=true href=#mathematical-analysis>#</a></h4><ul><li><p>Proposition. Heap construction uses $ \le 2N $ compares and exchanges.</p></li><li><p>Proposition. Heapsort uses $ \le 2NlgN $ compares and exchanges.</p></li><li><p>Significance. In-place sorting algorithm with $ NlgN $ worst-case.</p><ul><li>Mergesort: no, linear extra space.</li><li>Quicksort: no, quadratic time in worst case.</li><li>Heapsort: yes!</li></ul></li><li><p>Bottom line. Heapsort is optimal for both time and space but:</p><ul><li>Inner loop longer than quicksort&rsquo;s.</li><li>Makes poor use of cache memory.</li><li>Not stable.</li></ul></li></ul><h4 id=sorting-algorithms-summary>sorting-algorithms: summary<a hidden class=anchor aria-hidden=true href=#sorting-algorithms-summary>#</a></h4><p><div class=render-image><img loading=lazy src=https://s1.ax1x.com/2020/11/06/BWX9N6.png alt></div></p><h3 id=242>2.4.2<a hidden class=anchor aria-hidden=true href=#242>#</a></h3><p>Criticize the following idea: To implement find the maximum in constant time, why not use a stack or a queue, but keep track of the maximum value inserted so far, then return that value for find the maximum?</p><p>如果用这种方法，当最大元素被删除之后，不能在常量时间内更新最大元素</p><h3 id=243>2.4.3<a hidden class=anchor aria-hidden=true href=#243>#</a></h3><p>Provide priority-queue implementations that support insert and remove the maximum, one for each of the following underlying data structures: unordered array, ordered array, unordered linked list, and linked list. Give a table of the worst-case bounds for each operation for each of your four implementations.</p><h4 id=数组实现>数组实现<a hidden class=anchor aria-hidden=true href=#数组实现>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>abstract</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>ArrayPQ</span><span style=color:#f92672>&lt;</span>Key <span style=color:#66d9ef>extends</span> Comparable<span style=color:#f92672>&lt;</span>Key<span style=color:#f92672>&gt;&gt;</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>protected</span> Key<span style=color:#f92672>[]</span> pq<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>protected</span> <span style=color:#66d9ef>int</span> n<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#a6e22e>ArrayPQ</span><span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> capacity<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        pq <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>Key<span style=color:#f92672>[])</span> <span style=color:#66d9ef>new</span> Comparable<span style=color:#f92672>[</span>capacity<span style=color:#f92672>];</span>
</span></span><span style=display:flex><span>        n <span style=color:#f92672>=</span> 0<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>boolean</span> <span style=color:#a6e22e>isEmpty</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span><span style=color:#66d9ef>return</span> n <span style=color:#f92672>==</span> 0<span style=color:#f92672>;}</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>int</span> <span style=color:#a6e22e>size</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span><span style=color:#66d9ef>return</span> n<span style=color:#f92672>;}</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>abstract</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>insert</span><span style=color:#f92672>(</span>Key x<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>abstract</span> Key <span style=color:#a6e22e>delMax</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>protected</span> <span style=color:#66d9ef>boolean</span> <span style=color:#a6e22e>less</span><span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> i<span style=color:#f92672>,</span> <span style=color:#66d9ef>int</span> j<span style=color:#f92672>)</span> <span style=color:#f92672>{</span><span style=color:#66d9ef>return</span> pq<span style=color:#f92672>[</span>i<span style=color:#f92672>].</span><span style=color:#a6e22e>compareTo</span><span style=color:#f92672>(</span>pq<span style=color:#f92672>[</span>j<span style=color:#f92672>])</span> <span style=color:#f92672>&lt;</span> 0<span style=color:#f92672>;</span> <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>protected</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>exch</span><span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> i<span style=color:#f92672>,</span> <span style=color:#66d9ef>int</span> j<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        Key t <span style=color:#f92672>=</span> pq<span style=color:#f92672>[</span>i<span style=color:#f92672>];</span>
</span></span><span style=display:flex><span>        pq<span style=color:#f92672>[</span>i<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> pq<span style=color:#f92672>[</span>j<span style=color:#f92672>];</span>
</span></span><span style=display:flex><span>        pq<span style=color:#f92672>[</span>j<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> t<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>main</span><span style=color:#f92672>(</span>String<span style=color:#f92672>[]</span> args<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        OrderedArrayMaxPQ pq <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> OrderedArrayMaxPQ<span style=color:#f92672>(</span>10<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        pq<span style=color:#f92672>.</span><span style=color:#a6e22e>insert</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;this&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        pq<span style=color:#f92672>.</span><span style=color:#a6e22e>insert</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;is&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        pq<span style=color:#f92672>.</span><span style=color:#a6e22e>insert</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;a&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        pq<span style=color:#f92672>.</span><span style=color:#a6e22e>insert</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;test&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>while</span> <span style=color:#f92672>(!</span>pq<span style=color:#f92672>.</span><span style=color:#a6e22e>isEmpty</span><span style=color:#f92672>())</span>
</span></span><span style=display:flex><span>            System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>println</span><span style=color:#f92672>(</span>pq<span style=color:#f92672>.</span><span style=color:#a6e22e>delMax</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>UnorderedArrayMaxPQ</span><span style=color:#f92672>&lt;</span>Key <span style=color:#66d9ef>extends</span> Comparable<span style=color:#f92672>&lt;</span>Key<span style=color:#f92672>&gt;&gt;</span> <span style=color:#66d9ef>extends</span> ArrayPQ<span style=color:#f92672>&lt;</span>Key<span style=color:#f92672>&gt;</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#a6e22e>UnorderedArrayMaxPQ</span><span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> capacity<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>super</span><span style=color:#f92672>(</span>capacity<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>insert</span><span style=color:#f92672>(</span>Key x<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        pq<span style=color:#f92672>[</span>n<span style=color:#f92672>++]</span> <span style=color:#f92672>=</span> x<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> Key <span style=color:#a6e22e>delMax</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> max <span style=color:#f92672>=</span> 0<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> 1<span style=color:#f92672>;</span> i <span style=color:#f92672>&lt;</span> n<span style=color:#f92672>;</span> i<span style=color:#f92672>++)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>less<span style=color:#f92672>(</span>max<span style=color:#f92672>,</span> i<span style=color:#f92672>))</span> max <span style=color:#f92672>=</span> i<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>            exch<span style=color:#f92672>(</span>max<span style=color:#f92672>,</span> n<span style=color:#f92672>-</span>1<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> pq<span style=color:#f92672>[--</span>n<span style=color:#f92672>];</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>OrderedArrayMaxPQ</span><span style=color:#f92672>&lt;</span>Key <span style=color:#66d9ef>extends</span> Comparable<span style=color:#f92672>&lt;</span>Key<span style=color:#f92672>&gt;&gt;</span> <span style=color:#66d9ef>extends</span> ArrayPQ<span style=color:#f92672>&lt;</span>Key<span style=color:#f92672>&gt;{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#a6e22e>OrderedArrayMaxPQ</span><span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> capacity<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>super</span><span style=color:#f92672>(</span>capacity<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>insert</span><span style=color:#f92672>(</span>Key x<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> n <span style=color:#f92672>-</span> 1<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>while</span> <span style=color:#f92672>(</span>i <span style=color:#f92672>&gt;=</span> 0 <span style=color:#f92672>&amp;&amp;</span> x<span style=color:#f92672>.</span><span style=color:#a6e22e>compareTo</span><span style=color:#f92672>(</span>pq<span style=color:#f92672>[</span>i<span style=color:#f92672>])</span> <span style=color:#f92672>&lt;</span> 0<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            pq<span style=color:#f92672>[</span>i<span style=color:#f92672>+</span>1<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> pq<span style=color:#f92672>[</span>i<span style=color:#f92672>];</span>
</span></span><span style=display:flex><span>            i<span style=color:#f92672>--;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>        pq<span style=color:#f92672>[</span>i<span style=color:#f92672>+</span>1<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> x<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        n<span style=color:#f92672>++;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> Key <span style=color:#a6e22e>delMax</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> pq<span style=color:#f92672>[--</span>n<span style=color:#f92672>];</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><h4 id=链表实现>链表实现<a hidden class=anchor aria-hidden=true href=#链表实现>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>abstract</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>LinkedListPQ</span><span style=color:#f92672>&lt;</span>Key <span style=color:#66d9ef>extends</span> Comparable<span style=color:#f92672>&lt;</span>Key<span style=color:#f92672>&gt;&gt;</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>protected</span> LinkedList<span style=color:#f92672>&lt;</span>Key<span style=color:#f92672>&gt;</span> pq<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#a6e22e>LinkedListPQ</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        pq <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> LinkedList<span style=color:#f92672>&lt;</span>Key<span style=color:#f92672>&gt;();</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>boolean</span> <span style=color:#a6e22e>isEmpty</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> pq<span style=color:#f92672>.</span><span style=color:#a6e22e>size</span><span style=color:#f92672>()</span> <span style=color:#f92672>==</span> 0<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>int</span> <span style=color:#a6e22e>size</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> pq<span style=color:#f92672>.</span><span style=color:#a6e22e>size</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>abstract</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>insert</span><span style=color:#f92672>(</span>Key x<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>abstract</span> Key <span style=color:#a6e22e>delMax</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>protected</span> <span style=color:#66d9ef>boolean</span> <span style=color:#a6e22e>less</span><span style=color:#f92672>(</span>Key a<span style=color:#f92672>,</span> Key b<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> a<span style=color:#f92672>.</span><span style=color:#a6e22e>compareTo</span><span style=color:#f92672>(</span>b<span style=color:#f92672>)</span> <span style=color:#f92672>&lt;</span> 0<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>main</span><span style=color:#f92672>(</span>String<span style=color:#f92672>[]</span> args<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        UnorderedLinkedMaxPQ pq <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> UnorderedLinkedMaxPQ<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>        pq<span style=color:#f92672>.</span><span style=color:#a6e22e>insert</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;this&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        pq<span style=color:#f92672>.</span><span style=color:#a6e22e>insert</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;is&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        pq<span style=color:#f92672>.</span><span style=color:#a6e22e>insert</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;a&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        pq<span style=color:#f92672>.</span><span style=color:#a6e22e>insert</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;test&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>while</span> <span style=color:#f92672>(!</span>pq<span style=color:#f92672>.</span><span style=color:#a6e22e>isEmpty</span><span style=color:#f92672>())</span>
</span></span><span style=display:flex><span>            System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>println</span><span style=color:#f92672>(</span>pq<span style=color:#f92672>.</span><span style=color:#a6e22e>delMax</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>UnorderedLinkedMaxPQ</span><span style=color:#f92672>&lt;</span>Key <span style=color:#66d9ef>extends</span> Comparable<span style=color:#f92672>&lt;</span>Key<span style=color:#f92672>&gt;&gt;</span> <span style=color:#66d9ef>extends</span> LinkedListPQ<span style=color:#f92672>&lt;</span>Key<span style=color:#f92672>&gt;</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>insert</span><span style=color:#f92672>(</span>Key x<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        pq<span style=color:#f92672>.</span><span style=color:#a6e22e>addLast</span><span style=color:#f92672>(</span>x<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> Key <span style=color:#a6e22e>delMax</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> 0<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> idx <span style=color:#f92672>=</span> 0<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        var max <span style=color:#f92672>=</span> pq<span style=color:#f92672>.</span><span style=color:#a6e22e>getFirst</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span>var e <span style=color:#f92672>:</span> pq<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>less<span style=color:#f92672>(</span>max<span style=color:#f92672>,</span> e<span style=color:#f92672>))</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                max <span style=color:#f92672>=</span> e<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>                idx <span style=color:#f92672>=</span> i<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>            i<span style=color:#f92672>++;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>        pq<span style=color:#f92672>.</span><span style=color:#a6e22e>remove</span><span style=color:#f92672>(</span>idx<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> max<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>OrderedLinkedMaxPQ</span><span style=color:#f92672>&lt;</span>Key <span style=color:#66d9ef>extends</span> Comparable<span style=color:#f92672>&lt;</span>Key<span style=color:#f92672>&gt;&gt;</span> <span style=color:#66d9ef>extends</span> LinkedListPQ<span style=color:#f92672>&lt;</span>Key<span style=color:#f92672>&gt;</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#a6e22e>OrderedLinkedMaxPQ</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>super</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>insert</span><span style=color:#f92672>(</span>Key x<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> 0<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        Iterator it <span style=color:#f92672>=</span> pq<span style=color:#f92672>.</span><span style=color:#a6e22e>iterator</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>while</span> <span style=color:#f92672>(</span>it<span style=color:#f92672>.</span><span style=color:#a6e22e>hasNext</span><span style=color:#f92672>())</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>less<span style=color:#f92672>(</span>x<span style=color:#f92672>,</span> <span style=color:#f92672>(</span>Key<span style=color:#f92672>)</span> it<span style=color:#f92672>.</span><span style=color:#a6e22e>next</span><span style=color:#f92672>()))</span> <span style=color:#66d9ef>break</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>            i<span style=color:#f92672>++;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>        pq<span style=color:#f92672>.</span><span style=color:#a6e22e>add</span><span style=color:#f92672>(</span>i<span style=color:#f92672>,</span> x<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>println</span><span style=color:#f92672>(</span>i <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;  eee &#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> Key <span style=color:#a6e22e>delMax</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> pq<span style=color:#f92672>.</span><span style=color:#a6e22e>removeLast</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><h4 id=the-worst-case-bounds>the worst-case bounds<a hidden class=anchor aria-hidden=true href=#the-worst-case-bounds>#</a></h4><table><thead><tr><th></th><th>insert()</th><th>delMax()</th></tr></thead><tbody><tr><td>无序数组</td><td>1</td><td>N</td></tr><tr><td>有序数组</td><td>N</td><td>1</td></tr><tr><td>无序链表</td><td>1</td><td>N</td></tr><tr><td>有序链表</td><td>N</td><td>1</td></tr></tbody></table><h3 id=245>2.4.5<a hidden class=anchor aria-hidden=true href=#245>#</a></h3><p>Give the heap that results when the keys E A S Y Q U E S T I O N are inserted in that order into an initially empty max-oriented heap.</p><p><div class=render-image><img loading=lazy src=https://s1.ax1x.com/2020/11/06/BhYuEF.jpg alt></div></p><h3 id=247>2.4.7<a hidden class=anchor aria-hidden=true href=#247>#</a></h3><p>The largest item in a heap must appear in position 1, and the second largest must be in position 2 or position 3. Give the list of positions in a heap of size 31 where the kth largest (i) can appear, and (ii) cannot appear, for k=2, 3, 4 (assuming the values to be distinct).</p><ul><li>k = 2：可能出现在2，3；不可能出现在1, 4~31</li><li>k = 3：可能出现在2，3，4，5，6，7；不可能出现在1,8~31</li><li>k = 4：可能出现在2，3，4，5，6，7，8，9，10，11，12，13，14，15，不可能出现在1，16~31</li></ul><p>第k大元素只可能出现在深度不大于k的位置($ position \le 2^k-1 ,k \ge 2$)</p><h3 id=249>2.4.9<a hidden class=anchor aria-hidden=true href=#249>#</a></h3><p>Draw all of the different heaps that can be made from the five keys A B C D E, then draw all of the different heaps that can be made from the five keys A A A B B.</p><h4 id=a-b-c-d-e>A B C D E<a hidden class=anchor aria-hidden=true href=#a-b-c-d-e>#</a></h4><ul><li>最大堆<div class=render-image><img loading=lazy src=https://s1.ax1x.com/2020/11/06/BhwOIK.jpg alt></div></li><li>最小堆<div class=render-image><img loading=lazy src=https://s1.ax1x.com/2020/11/06/BhwjPO.jpg alt></div></li></ul><h4 id=a-a-a-b-b>A A A B B<a hidden class=anchor aria-hidden=true href=#a-a-a-b-b>#</a></h4><p><div class=render-image><img loading=lazy src=https://s1.ax1x.com/2020/11/06/BhBAmR.jpg alt></div></p><h3 id=2411>2.4.11<a hidden class=anchor aria-hidden=true href=#2411>#</a></h3><p>Suppose that your application will have a huge number of insert operations, but only a few remove the maximum operations. Which priority-queue implementation do you think would be most effective: heap, unordered array, or ordered array?</p><p>因为有大量的insert操作和很少的delMax操作，而heap, unordered array, ordered array实现的Priority Queue insert操作的花费时间的数量级分别为lgN, 1, N, 所以unordered array是最有效的。</p><h3 id=2412>2.4.12<a hidden class=anchor aria-hidden=true href=#2412>#</a></h3><p>Suppose that your application will have a huge number of find the maximum operations, but a relatively small number of insert and remove the maximum operations. Which priority-queue implementation do you think would be most effective: heap, unordered array, or ordered array?</p><p>大量的查找最大元素，heap和ordered array查找最大元素都是常量时间，但heap插入和删除最大元素都是lgN，而ordered array插入和删除分别是N和常量时间，综合下来，heap是最有效的。</p><h2 id=undirected-graphs>UNDIRECTED GRAPHS<a hidden class=anchor aria-hidden=true href=#undirected-graphs>#</a></h2><h3 id=depth-first-search>depth-first-search<a hidden class=anchor aria-hidden=true href=#depth-first-search>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>DepthFirstPaths</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>boolean</span><span style=color:#f92672>[]</span> marked<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>int</span><span style=color:#f92672>[]</span> edgeTo<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>int</span> s<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#a6e22e>DepthFirstPaths</span><span style=color:#f92672>(</span>Graph G<span style=color:#f92672>,</span><span style=color:#66d9ef>int</span> s<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        marked <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#66d9ef>boolean</span><span style=color:#f92672>[</span>G<span style=color:#f92672>.</span><span style=color:#a6e22e>V</span><span style=color:#f92672>()];</span>
</span></span><span style=display:flex><span>        edgeTo <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#66d9ef>int</span><span style=color:#f92672>[</span>G<span style=color:#f92672>.</span><span style=color:#a6e22e>V</span><span style=color:#f92672>()];</span>
</span></span><span style=display:flex><span>        Arrays<span style=color:#f92672>.</span><span style=color:#a6e22e>fill</span><span style=color:#f92672>(</span>marked<span style=color:#f92672>,</span> <span style=color:#66d9ef>false</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>s</span> <span style=color:#f92672>=</span> s<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        dfs<span style=color:#f92672>(</span>G<span style=color:#f92672>,</span> s<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>dfs</span><span style=color:#f92672>(</span>Graph G<span style=color:#f92672>,</span> <span style=color:#66d9ef>int</span> v<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        marked<span style=color:#f92672>[</span>v<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> w <span style=color:#f92672>:</span> G<span style=color:#f92672>.</span><span style=color:#a6e22e>adj</span><span style=color:#f92672>(</span>v<span style=color:#f92672>))</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> <span style=color:#f92672>(!</span>marked<span style=color:#f92672>[</span>w<span style=color:#f92672>])</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                dfs<span style=color:#f92672>(</span>G<span style=color:#f92672>,</span> w<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>                edgeTo<span style=color:#f92672>[</span>w<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> v<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>boolean</span> <span style=color:#a6e22e>hasPathTo</span><span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> v<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> marked<span style=color:#f92672>[</span>v<span style=color:#f92672>];</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> Iterable<span style=color:#f92672>&lt;</span>Integer<span style=color:#f92672>&gt;</span> <span style=color:#a6e22e>pathTo</span><span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> v<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> <span style=color:#f92672>(!</span>hasPathTo<span style=color:#f92672>(</span>v<span style=color:#f92672>))</span> <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>null</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        Stack<span style=color:#f92672>&lt;</span>Integer<span style=color:#f92672>&gt;</span> path <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Stack<span style=color:#f92672>&lt;&gt;();</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> x <span style=color:#f92672>=</span> v<span style=color:#f92672>;</span> x <span style=color:#f92672>!=</span> s<span style=color:#f92672>;</span> x <span style=color:#f92672>=</span> edgeTo<span style=color:#f92672>[</span>x<span style=color:#f92672>])</span>
</span></span><span style=display:flex><span>            path<span style=color:#f92672>.</span><span style=color:#a6e22e>push</span><span style=color:#f92672>(</span>x<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        path<span style=color:#f92672>.</span><span style=color:#a6e22e>push</span><span style=color:#f92672>(</span>s<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> path<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>main</span><span style=color:#f92672>(</span>String<span style=color:#f92672>[]</span> args<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> V <span style=color:#f92672>=</span> StdIn<span style=color:#f92672>.</span><span style=color:#a6e22e>readInt</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>        Graph g <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Graph<span style=color:#f92672>(</span>V<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> E <span style=color:#f92672>=</span> StdIn<span style=color:#f92672>.</span><span style=color:#a6e22e>readInt</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> 0<span style=color:#f92672>;</span> i <span style=color:#f92672>&lt;</span> E<span style=color:#f92672>;</span> i<span style=color:#f92672>++)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            g<span style=color:#f92672>.</span><span style=color:#a6e22e>addEdge</span><span style=color:#f92672>(</span>StdIn<span style=color:#f92672>.</span><span style=color:#a6e22e>readInt</span><span style=color:#f92672>(),</span> StdIn<span style=color:#f92672>.</span><span style=color:#a6e22e>readInt</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>        DepthFirstPaths dfp <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> DepthFirstPaths<span style=color:#f92672>(</span>g<span style=color:#f92672>,</span> 0<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span>var i <span style=color:#f92672>:</span> dfp<span style=color:#f92672>.</span><span style=color:#a6e22e>pathTo</span><span style=color:#f92672>(</span>3<span style=color:#f92672>))</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>println</span><span style=color:#f92672>(</span>i<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><h3 id=breadth-first-search>breadth-first-search<a hidden class=anchor aria-hidden=true href=#breadth-first-search>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>BreadthFirstPaths</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>boolean</span><span style=color:#f92672>[]</span> marked<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>int</span><span style=color:#f92672>[]</span> edgeTo<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>int</span> s<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#a6e22e>BreadthFirstPaths</span><span style=color:#f92672>(</span>Graph G<span style=color:#f92672>,</span> <span style=color:#66d9ef>int</span> s<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        marked <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#66d9ef>boolean</span><span style=color:#f92672>[</span>G<span style=color:#f92672>.</span><span style=color:#a6e22e>V</span><span style=color:#f92672>()];</span>
</span></span><span style=display:flex><span>        edgeTo <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#66d9ef>int</span><span style=color:#f92672>[</span>G<span style=color:#f92672>.</span><span style=color:#a6e22e>V</span><span style=color:#f92672>()];</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>s</span> <span style=color:#f92672>=</span> s<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        bfs<span style=color:#f92672>(</span>G<span style=color:#f92672>,</span> s<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>bfs</span><span style=color:#f92672>(</span>Graph G<span style=color:#f92672>,</span> <span style=color:#66d9ef>int</span> s<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        Queue<span style=color:#f92672>&lt;</span>Integer<span style=color:#f92672>&gt;</span> Q <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Queue<span style=color:#f92672>&lt;&gt;();</span>
</span></span><span style=display:flex><span>        Q<span style=color:#f92672>.</span><span style=color:#a6e22e>enqueue</span><span style=color:#f92672>(</span>s<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        marked<span style=color:#f92672>[</span>s<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>while</span> <span style=color:#f92672>(!</span>Q<span style=color:#f92672>.</span><span style=color:#a6e22e>isEmpty</span><span style=color:#f92672>())</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>int</span> v <span style=color:#f92672>=</span> Q<span style=color:#f92672>.</span><span style=color:#a6e22e>dequeue</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> w <span style=color:#f92672>:</span> G<span style=color:#f92672>.</span><span style=color:#a6e22e>adj</span><span style=color:#f92672>(</span>v<span style=color:#f92672>))</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> <span style=color:#f92672>(!</span>marked<span style=color:#f92672>[</span>w<span style=color:#f92672>])</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                    Q<span style=color:#f92672>.</span><span style=color:#a6e22e>enqueue</span><span style=color:#f92672>(</span>w<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>                    marked<span style=color:#f92672>[</span>w<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>                    edgeTo<span style=color:#f92672>[</span>w<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> v<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>boolean</span> <span style=color:#a6e22e>hasPathTo</span><span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> v<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> marked<span style=color:#f92672>[</span>v<span style=color:#f92672>];</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> Iterable<span style=color:#f92672>&lt;</span>Integer<span style=color:#f92672>&gt;</span> <span style=color:#a6e22e>pathTo</span><span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> v<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> <span style=color:#f92672>(!</span>hasPathTo<span style=color:#f92672>(</span>v<span style=color:#f92672>))</span> <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>null</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        Stack<span style=color:#f92672>&lt;</span>Integer<span style=color:#f92672>&gt;</span> path <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Stack<span style=color:#f92672>&lt;&gt;();</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> v<span style=color:#f92672>;</span> i <span style=color:#f92672>!=</span> s<span style=color:#f92672>;</span> i <span style=color:#f92672>=</span> edgeTo<span style=color:#f92672>[</span>i<span style=color:#f92672>])</span>
</span></span><span style=display:flex><span>            path<span style=color:#f92672>.</span><span style=color:#a6e22e>push</span><span style=color:#f92672>(</span>i<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        path<span style=color:#f92672>.</span><span style=color:#a6e22e>push</span><span style=color:#f92672>(</span>s<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> path<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>main</span><span style=color:#f92672>(</span>String<span style=color:#f92672>[]</span> args<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> V <span style=color:#f92672>=</span> StdIn<span style=color:#f92672>.</span><span style=color:#a6e22e>readInt</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>        Graph g <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Graph<span style=color:#f92672>(</span>V<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> E <span style=color:#f92672>=</span> StdIn<span style=color:#f92672>.</span><span style=color:#a6e22e>readInt</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> 0<span style=color:#f92672>;</span> i <span style=color:#f92672>&lt;</span> E<span style=color:#f92672>;</span> i<span style=color:#f92672>++)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            g<span style=color:#f92672>.</span><span style=color:#a6e22e>addEdge</span><span style=color:#f92672>(</span>StdIn<span style=color:#f92672>.</span><span style=color:#a6e22e>readInt</span><span style=color:#f92672>(),</span> StdIn<span style=color:#f92672>.</span><span style=color:#a6e22e>readInt</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>        BreadthFirstPaths bfp <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> BreadthFirstPaths<span style=color:#f92672>(</span>g<span style=color:#f92672>,</span> 0<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span>var i <span style=color:#f92672>:</span> bfp<span style=color:#f92672>.</span><span style=color:#a6e22e>pathTo</span><span style=color:#f92672>(</span>3<span style=color:#f92672>))</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>println</span><span style=color:#f92672>(</span>i<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><h3 id=connected-components>connected components<a hidden class=anchor aria-hidden=true href=#connected-components>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>CC</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>boolean</span><span style=color:#f92672>[]</span> marked<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>int</span><span style=color:#f92672>[]</span> id<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>int</span> count<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#a6e22e>CC</span><span style=color:#f92672>(</span>Graph G<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        marked <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#66d9ef>boolean</span><span style=color:#f92672>[</span>G<span style=color:#f92672>.</span><span style=color:#a6e22e>V</span><span style=color:#f92672>()];</span>
</span></span><span style=display:flex><span>        id <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#66d9ef>int</span><span style=color:#f92672>[</span>G<span style=color:#f92672>.</span><span style=color:#a6e22e>V</span><span style=color:#f92672>()];</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> v <span style=color:#f92672>=</span> 0<span style=color:#f92672>;</span> v <span style=color:#f92672>&lt;</span> G<span style=color:#f92672>.</span><span style=color:#a6e22e>V</span><span style=color:#f92672>();</span> v<span style=color:#f92672>++)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> <span style=color:#f92672>(!</span>marked<span style=color:#f92672>[</span>v<span style=color:#f92672>])</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                dfs<span style=color:#f92672>(</span>G<span style=color:#f92672>,</span> v<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>                count<span style=color:#f92672>++;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>int</span> <span style=color:#a6e22e>count</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span> <span style=color:#66d9ef>return</span> count<span style=color:#f92672>;</span> <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>int</span> <span style=color:#a6e22e>id</span><span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> v<span style=color:#f92672>)</span> <span style=color:#f92672>{</span> <span style=color:#66d9ef>return</span> id<span style=color:#f92672>[</span>v<span style=color:#f92672>];</span> <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>dfs</span><span style=color:#f92672>(</span>Graph G<span style=color:#f92672>,</span> <span style=color:#66d9ef>int</span> v<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        marked<span style=color:#f92672>[</span>v<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        id<span style=color:#f92672>[</span>v<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> count<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> w <span style=color:#f92672>:</span> G<span style=color:#f92672>.</span><span style=color:#a6e22e>adj</span><span style=color:#f92672>(</span>v<span style=color:#f92672>))</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> <span style=color:#f92672>(!</span>marked<span style=color:#f92672>[</span>w<span style=color:#f92672>])</span>
</span></span><span style=display:flex><span>                dfs<span style=color:#f92672>(</span>G<span style=color:#f92672>,</span> w<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>main</span><span style=color:#f92672>(</span>String<span style=color:#f92672>[]</span> args<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        Graph G <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Graph<span style=color:#f92672>(</span>StdIn<span style=color:#f92672>.</span><span style=color:#a6e22e>readInt</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> E <span style=color:#f92672>=</span> StdIn<span style=color:#f92672>.</span><span style=color:#a6e22e>readInt</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> 0<span style=color:#f92672>;</span> i <span style=color:#f92672>&lt;</span> E<span style=color:#f92672>;</span> i<span style=color:#f92672>++)</span>
</span></span><span style=display:flex><span>            G<span style=color:#f92672>.</span><span style=color:#a6e22e>addEdge</span><span style=color:#f92672>(</span>StdIn<span style=color:#f92672>.</span><span style=color:#a6e22e>readInt</span><span style=color:#f92672>(),</span> StdIn<span style=color:#f92672>.</span><span style=color:#a6e22e>readInt</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>        CC cc <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> CC<span style=color:#f92672>(</span>G<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>println</span><span style=color:#f92672>(</span>cc<span style=color:#f92672>.</span><span style=color:#a6e22e>count</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><h2 id=minimum-spanning-trees>Minimum Spanning Trees<a hidden class=anchor aria-hidden=true href=#minimum-spanning-trees>#</a></h2><h3 id=greedy-algorithm>Greedy algorithm<a hidden class=anchor aria-hidden=true href=#greedy-algorithm>#</a></h3><h4 id=cut-property>Cut property<a hidden class=anchor aria-hidden=true href=#cut-property>#</a></h4><ul><li><p>Def: A <strong>cut</strong> in a graph is a partition of its vertices into two(nonempty) sets.</p></li><li><p>Def: A <strong>Crossing edge</strong> connects a vertex in one set with a vertex in the other.</p></li><li><p><strong>Cut property</strong>. Give any cut, the crossing edge of min weight is in the MST</p><ul><li>Pf. Suppose the min-weight crossing edge <em>e</em> is not in the MST<ul><li>Adding <em>e</em> to the MST creates a cycle</li><li>Some other edge <em>f</em> in cycle must be a crossing edge</li><li>Removing <em>f</em> and adding <em>e</em> is also a spanning tree</li><li>Since weight of <em>e</em> is less than the weight of <em>f</em>,that spanning tree is lower weight</li><li>Contradiction</li></ul></li></ul></li></ul><h3 id=kruskals-algorithm>Kruskal&rsquo;s algorithm<a hidden class=anchor aria-hidden=true href=#kruskals-algorithm>#</a></h3><p>Consider edges in ascending order of weight.</p><ul><li>Add next edge to tree <em>T</em> unless so doing would create a cycle.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>KruskalMST</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> Queue<span style=color:#f92672>&lt;</span>Edge<span style=color:#f92672>&gt;</span> mst <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Queue<span style=color:#f92672>&lt;&gt;();</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>double</span> weight<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#a6e22e>KruskalMST</span><span style=color:#f92672>(</span>EdgeWeightedGraph G<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        weight <span style=color:#f92672>=</span> 0<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        MinPQ<span style=color:#f92672>&lt;</span>Edge<span style=color:#f92672>&gt;</span> pq <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> MinPQ<span style=color:#f92672>&lt;&gt;();</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span>var e <span style=color:#f92672>:</span> G<span style=color:#f92672>.</span><span style=color:#a6e22e>edges</span><span style=color:#f92672>())</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            pq<span style=color:#f92672>.</span><span style=color:#a6e22e>insert</span><span style=color:#f92672>(</span>e<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>        UF uf <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> UF<span style=color:#f92672>(</span>G<span style=color:#f92672>.</span><span style=color:#a6e22e>V</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>while</span> <span style=color:#f92672>(!</span>pq<span style=color:#f92672>.</span><span style=color:#a6e22e>isEmpty</span><span style=color:#f92672>()</span> <span style=color:#f92672>&amp;&amp;</span> mst<span style=color:#f92672>.</span><span style=color:#a6e22e>size</span><span style=color:#f92672>()</span> <span style=color:#f92672>&lt;</span> G<span style=color:#f92672>.</span><span style=color:#a6e22e>V</span><span style=color:#f92672>()</span> <span style=color:#f92672>-</span> 1<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            Edge e <span style=color:#f92672>=</span> pq<span style=color:#f92672>.</span><span style=color:#a6e22e>delMin</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>int</span> v <span style=color:#f92672>=</span> e<span style=color:#f92672>.</span><span style=color:#a6e22e>either</span><span style=color:#f92672>(),</span> w <span style=color:#f92672>=</span> e<span style=color:#f92672>.</span><span style=color:#a6e22e>other</span><span style=color:#f92672>(</span>v<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> <span style=color:#f92672>(!</span>uf<span style=color:#f92672>.</span><span style=color:#a6e22e>connected</span><span style=color:#f92672>(</span>v<span style=color:#f92672>,</span> w<span style=color:#f92672>))</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                uf<span style=color:#f92672>.</span><span style=color:#a6e22e>union</span><span style=color:#f92672>(</span>v<span style=color:#f92672>,</span> w<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>                mst<span style=color:#f92672>.</span><span style=color:#a6e22e>enqueue</span><span style=color:#f92672>(</span>e<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>                weight <span style=color:#f92672>+=</span> e<span style=color:#f92672>.</span><span style=color:#a6e22e>weight</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> Iterable<span style=color:#f92672>&lt;</span>Edge<span style=color:#f92672>&gt;</span> <span style=color:#a6e22e>edges</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> mst<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>double</span> <span style=color:#a6e22e>weight</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> weight<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><h3 id=prims-algorithm>Prim&rsquo;s algorithm<a hidden class=anchor aria-hidden=true href=#prims-algorithm>#</a></h3><ul><li>Start with vertex 0 and greedy grow tree <em>T</em></li><li>Add to <em>T</em> the min weight with exactly one endpoint in <em>T</em></li><li>Repeat until <em>V</em>-1 edges</li></ul><h4 id=lazyprim-implementation>LazyPrim Implementation<a hidden class=anchor aria-hidden=true href=#lazyprim-implementation>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>LazyPrimMST</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>boolean</span><span style=color:#f92672>[]</span> marked<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> Queue<span style=color:#f92672>&lt;</span>Edge<span style=color:#f92672>&gt;</span> mst<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> MinPQ<span style=color:#f92672>&lt;</span>Edge<span style=color:#f92672>&gt;</span> pq<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#a6e22e>LazyPrimMST</span><span style=color:#f92672>(</span>EdgeWeightedGraph G<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        pq <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> MinPQ<span style=color:#f92672>&lt;&gt;();</span>
</span></span><span style=display:flex><span>        mst <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Queue<span style=color:#f92672>&lt;&gt;();</span>
</span></span><span style=display:flex><span>        marked <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#66d9ef>boolean</span><span style=color:#f92672>[</span>G<span style=color:#f92672>.</span><span style=color:#a6e22e>V</span><span style=color:#f92672>()];</span>
</span></span><span style=display:flex><span>        visit<span style=color:#f92672>(</span>G<span style=color:#f92672>,</span> 0<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>while</span> <span style=color:#f92672>(!</span>pq<span style=color:#f92672>.</span><span style=color:#a6e22e>isEmpty</span><span style=color:#f92672>()</span> <span style=color:#f92672>&amp;&amp;</span> mst<span style=color:#f92672>.</span><span style=color:#a6e22e>size</span><span style=color:#f92672>()</span> <span style=color:#f92672>&lt;</span> G<span style=color:#f92672>.</span><span style=color:#a6e22e>V</span><span style=color:#f92672>()</span> <span style=color:#f92672>-</span> 1<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            Edge e <span style=color:#f92672>=</span> pq<span style=color:#f92672>.</span><span style=color:#a6e22e>delMin</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>int</span> v <span style=color:#f92672>=</span> e<span style=color:#f92672>.</span><span style=color:#a6e22e>either</span><span style=color:#f92672>(),</span> w <span style=color:#f92672>=</span> e<span style=color:#f92672>.</span><span style=color:#a6e22e>other</span><span style=color:#f92672>(</span>v<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>marked<span style=color:#f92672>[</span>v<span style=color:#f92672>]</span> <span style=color:#f92672>&amp;&amp;</span> marked<span style=color:#f92672>[</span>w<span style=color:#f92672>])</span> <span style=color:#66d9ef>continue</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>            mst<span style=color:#f92672>.</span><span style=color:#a6e22e>enqueue</span><span style=color:#f92672>(</span>e<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> <span style=color:#f92672>(!</span>marked<span style=color:#f92672>[</span>v<span style=color:#f92672>])</span> visit<span style=color:#f92672>(</span>G<span style=color:#f92672>,</span> v<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> <span style=color:#f92672>(!</span>marked<span style=color:#f92672>[</span>w<span style=color:#f92672>])</span> visit<span style=color:#f92672>(</span>G<span style=color:#f92672>,</span> w<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>visit</span><span style=color:#f92672>(</span>EdgeWeightedGraph G<span style=color:#f92672>,</span> <span style=color:#66d9ef>int</span> v<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        marked<span style=color:#f92672>[</span>v<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span>Edge e <span style=color:#f92672>:</span> G<span style=color:#f92672>.</span><span style=color:#a6e22e>adj</span><span style=color:#f92672>(</span>v<span style=color:#f92672>))</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> <span style=color:#f92672>(!</span>marked<span style=color:#f92672>[</span>e<span style=color:#f92672>.</span><span style=color:#a6e22e>other</span><span style=color:#f92672>(</span>v<span style=color:#f92672>)])</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                pq<span style=color:#f92672>.</span><span style=color:#a6e22e>insert</span><span style=color:#f92672>(</span>e<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> Iterable<span style=color:#f92672>&lt;</span>Edge<span style=color:#f92672>&gt;</span> <span style=color:#a6e22e>mst</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> mst<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><h4 id=indexed-priority-queue-implementation>Indexed priority queue implementation<a hidden class=anchor aria-hidden=true href=#indexed-priority-queue-implementation>#</a></h4><ul><li>Start as same code as MinPQ</li><li>Maintain parallel arrays keys[], pq[], and qp[] so that:<ul><li>keys[i] is the priority of i</li><li>pq[i] is the index of the key in heap position i</li><li>qp[i] is the heap position of the key with index i</li></ul></li><li>Use swim(qp[i]) implement decreaseKey(i, key).<div class=render-image><img loading=lazy src=https://s3.ax1x.com/2020/11/26/DBAWWR.png alt></div></li></ul><h4 id=eagerprim-implementation>EagerPrim Implementation<a hidden class=anchor aria-hidden=true href=#eagerprim-implementation>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#f92672>import</span> edu.princeton.cs.algs4.*<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>PrimMST</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> Edge<span style=color:#f92672>[]</span> edgeTo<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>double</span><span style=color:#f92672>[]</span> distTo<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>boolean</span><span style=color:#f92672>[]</span> marked<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> IndexMinPQ<span style=color:#f92672>&lt;</span>Double<span style=color:#f92672>&gt;</span> pq<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#a6e22e>PrimMST</span><span style=color:#f92672>(</span>EdgeWeightedGraph G<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        edgeTo <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Edge<span style=color:#f92672>[</span>G<span style=color:#f92672>.</span><span style=color:#a6e22e>V</span><span style=color:#f92672>()];</span>
</span></span><span style=display:flex><span>        distTo <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#66d9ef>double</span><span style=color:#f92672>[</span>G<span style=color:#f92672>.</span><span style=color:#a6e22e>V</span><span style=color:#f92672>()];</span>
</span></span><span style=display:flex><span>        marked <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#66d9ef>boolean</span><span style=color:#f92672>[</span>G<span style=color:#f92672>.</span><span style=color:#a6e22e>V</span><span style=color:#f92672>()];</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> v <span style=color:#f92672>=</span> 0<span style=color:#f92672>;</span> v <span style=color:#f92672>&lt;</span> G<span style=color:#f92672>.</span><span style=color:#a6e22e>V</span><span style=color:#f92672>();</span> v<span style=color:#f92672>++)</span>
</span></span><span style=display:flex><span>            distTo<span style=color:#f92672>[</span>v<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> Double<span style=color:#f92672>.</span><span style=color:#a6e22e>POSITIVE_INFINITY</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        pq <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> IndexMinPQ<span style=color:#f92672>&lt;&gt;(</span>G<span style=color:#f92672>.</span><span style=color:#a6e22e>V</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>        distTo<span style=color:#f92672>[</span>0<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> 0<span style=color:#f92672>.</span><span style=color:#a6e22e>0</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        pq<span style=color:#f92672>.</span><span style=color:#a6e22e>insert</span><span style=color:#f92672>(</span>0<span style=color:#f92672>,</span> 0<span style=color:#f92672>.</span><span style=color:#a6e22e>0</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>while</span> <span style=color:#f92672>(!</span>pq<span style=color:#f92672>.</span><span style=color:#a6e22e>isEmpty</span><span style=color:#f92672>())</span>
</span></span><span style=display:flex><span>            visit<span style=color:#f92672>(</span>G<span style=color:#f92672>,</span> pq<span style=color:#f92672>.</span><span style=color:#a6e22e>delMin</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>visit</span><span style=color:#f92672>(</span>EdgeWeightedGraph G<span style=color:#f92672>,</span> <span style=color:#66d9ef>int</span> v<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        marked<span style=color:#f92672>[</span>v<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span>Edge e <span style=color:#f92672>:</span> G<span style=color:#f92672>.</span><span style=color:#a6e22e>adj</span><span style=color:#f92672>(</span>v<span style=color:#f92672>))</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>int</span> w <span style=color:#f92672>=</span> e<span style=color:#f92672>.</span><span style=color:#a6e22e>other</span><span style=color:#f92672>(</span>v<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>marked<span style=color:#f92672>[</span>w<span style=color:#f92672>])</span> <span style=color:#66d9ef>continue</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>e<span style=color:#f92672>.</span><span style=color:#a6e22e>weight</span><span style=color:#f92672>()</span> <span style=color:#f92672>&lt;</span> distTo<span style=color:#f92672>[</span>w<span style=color:#f92672>])</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                edgeTo<span style=color:#f92672>[</span>w<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> e<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>                distTo<span style=color:#f92672>[</span>w<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> e<span style=color:#f92672>.</span><span style=color:#a6e22e>weight</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>pq<span style=color:#f92672>.</span><span style=color:#a6e22e>contains</span><span style=color:#f92672>(</span>w<span style=color:#f92672>))</span> pq<span style=color:#f92672>.</span><span style=color:#a6e22e>change</span><span style=color:#f92672>(</span>w<span style=color:#f92672>,</span> distTo<span style=color:#f92672>[</span>w<span style=color:#f92672>]);</span>
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>else</span> pq<span style=color:#f92672>.</span><span style=color:#a6e22e>insert</span><span style=color:#f92672>(</span>w<span style=color:#f92672>,</span> distTo<span style=color:#f92672>[</span>w<span style=color:#f92672>]);</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> Iterable<span style=color:#f92672>&lt;</span>Edge<span style=color:#f92672>&gt;</span> <span style=color:#a6e22e>edges</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        Queue<span style=color:#f92672>&lt;</span>Edge<span style=color:#f92672>&gt;</span> mst  <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Queue<span style=color:#f92672>&lt;&gt;();</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> v <span style=color:#f92672>=</span> 0<span style=color:#f92672>;</span> v <span style=color:#f92672>&lt;</span> edgeTo<span style=color:#f92672>.</span><span style=color:#a6e22e>length</span><span style=color:#f92672>;</span> v<span style=color:#f92672>++)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            Edge e <span style=color:#f92672>=</span> edgeTo<span style=color:#f92672>[</span>v<span style=color:#f92672>];</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>e <span style=color:#f92672>!=</span> <span style=color:#66d9ef>null</span><span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                mst<span style=color:#f92672>.</span><span style=color:#a6e22e>enqueue</span><span style=color:#f92672>(</span>e<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> mst<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>double</span> <span style=color:#a6e22e>weight</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>double</span> weight <span style=color:#f92672>=</span> 0<span style=color:#f92672>.</span><span style=color:#a6e22e>0</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span>Edge e <span style=color:#f92672>:</span> edges<span style=color:#f92672>())</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            weight <span style=color:#f92672>+=</span> e<span style=color:#f92672>.</span><span style=color:#a6e22e>weight</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> weight<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><h3 id=432>4.3.2<a hidden class=anchor aria-hidden=true href=#432>#</a></h3><p>Draw all of the MSTs of graph depicted at right (all edge weights are equal).</p><p><div class=render-image><img loading=lazy src=https://s3.ax1x.com/2020/11/24/DtaE4K.png alt></div></p><p><div class=render-image><img loading=lazy src=https://i.postimg.cc/jSSvhPHK/4-3-2.jpg alt></div></p><h3 id=433>4.3.3<a hidden class=anchor aria-hidden=true href=#433>#</a></h3><p>Show that if a graph’s edges all have distinct weights, the MST is unique</p><ul><li>假设无向图G有两棵不同的最小生成树T1和T2</li><li>e是在T1或T2中（但不是同时在两棵树中）最小权值的边，不妨假设e在T1中</li><li>将e添加到T2中会创建一个环C</li><li>在C中至少存在一条边f（但不在T1中，否则会产生环）</li><li>因为e是在T1或T2中（但不是同时在两棵树中）最小权值的边，并且每条边权值都不同</li><li>所以有e.weight &lt; f.weight</li><li>用e代替f，将会产生比原来T2权值更小的生成树，产生了矛盾</li></ul><h3 id=4313>4.3.13<a hidden class=anchor aria-hidden=true href=#4313>#</a></h3><p>Give a counterexample that shows why the following strategy does not necessarily
find the MST: ‘Start with any vertex as a single-vertex MST, then add V-1 edges
to it, always taking next a min-weight edge incident to the vertex most recently added to the MST.’</p><p><div class=render-image><img loading=lazy src=https://i.postimg.cc/cL2PZRSL/4-3-13.png alt></div></p><h2 id=shortest-paths>Shortest Paths<a hidden class=anchor aria-hidden=true href=#shortest-paths>#</a></h2><h3 id=shortest-paths-properties>shortest-paths properties<a hidden class=anchor aria-hidden=true href=#shortest-paths-properties>#</a></h3><h4 id=data-structures-for-single-source-shortest-paths>Data structures for single-source shortest paths<a hidden class=anchor aria-hidden=true href=#data-structures-for-single-source-shortest-paths>#</a></h4><ul><li><strong>Goal.</strong> Find the shortest-paths from <em>s</em> to every other vertex.</li><li><strong>Observation.</strong> A shortest-paths tree (SPT) solution exists. Why?</li><li><strong>Consequence.</strong> Can represent the SPT with two vertex-indexed arrays:<ul><li>distTo[v] is length of shortest path from <em>s</em> to <em>v</em></li><li>edgeTo[v] is last edge on shortest path from <em>s</em> to <em>v</em></li></ul></li></ul><h4 id=edge-relaxation>Edge relaxation<a hidden class=anchor aria-hidden=true href=#edge-relaxation>#</a></h4><ul><li>Relax edge <em>e = v->w</em><ul><li>distTo[v] is length of shortest known path from s to v</li><li>distTo[w] is length of shortest known path from s to w</li><li>edgeTo[w] is last edge on shortest known path from s to w</li><li>if e = v->w gives shorter path to w through v, update both distTo[w] and edgeTo[w]<div class=render-image><img loading=lazy src=https://i.postimg.cc/fTbTm0tQ/1.jpg alt></div></li></ul></li></ul><h4 id=shortest-paths-optimality-conditions>Shortest-paths optimality conditions<a hidden class=anchor aria-hidden=true href=#shortest-paths-optimality-conditions>#</a></h4><ul><li><strong>Proposition.</strong> Let <em>G</em> be an edge-weighted digraph. Then distTo[] are the shortest path distances from s iff:<ul><li>distTo[s] = 0</li><li>For each vertex v, distTo[v] is the length of some path from s to v</li><li>For each edge e = v->w, distTo[w] &lt;= distTo[v] + e.weight().</li></ul></li><li><strong>Pf.</strong><ul><li>suppose that distTo[w] > distTo[v] + e.weight() for some edge e = v->w.</li><li>Then, e gives a path from s to w (through v) of length less than distTo[w].<ul><li>distTo[v1] &lt;= distTo[v0] + e1.weight()</li><li>distTo[v2] &lt;= distTo[v1] + e2.weight()</li><li>&mldr;</li><li>distTo[vk] &lt;= distTo[v(k-1)] + ek.weight()</li></ul></li><li>Add inequalities; simplify; and substitude distTo[v0] = distTo[s] = 0: distTo[w] = distTo[vk] &lt;= e1.weight() + e2.weight() + &mldr; + ek.weight()</li><li>Thus, distTo[w] is the weight of shortest path to w</li></ul></li></ul><h4 id=genertic-shortest-paths-algorithm>Genertic shortest-paths algorithm<a hidden class=anchor aria-hidden=true href=#genertic-shortest-paths-algorithm>#</a></h4><ul><li><strong>Proposition.</strong> Genertic algorithm computes SPT(if it exists) from s.</li><li><strong>Pf sketch</strong><ul><li>Throughout algorithm, distTo[v] is the length of a simple path from s to <em>v</em> (and edgeTo[v] is last edge on path)</li><li>Each successful relaxation decreases distTo[v] from some v</li><li>The entry distTo[v] can decrease at most a finite number of times</li></ul></li><li><strong>Efficient implementataions</strong> How to choose which edge to relax?<ul><li>Ex 1. Dijkstra&rsquo;s algorithm (nonnegative weights)</li><li>Ex 2. Topological sort algorithm (no directed cycles)</li><li>Ex 3. Bellman-Ford algorithm (no negative cycles)</li></ul></li></ul><h3 id=dijkstras-algorithm>Dijkstra&rsquo;s algorithm<a hidden class=anchor aria-hidden=true href=#dijkstras-algorithm>#</a></h3><h4 id=dijkstras-algorithm-demo>Dijkstra&rsquo;s algorithm Demo<a hidden class=anchor aria-hidden=true href=#dijkstras-algorithm-demo>#</a></h4><p><div class=render-image><img loading=lazy src=https://i.postimg.cc/mD7ZT0Xb/pic.gif alt></div></p><h4 id=correctness-proof>correctness proof<a hidden class=anchor aria-hidden=true href=#correctness-proof>#</a></h4><ul><li><p><strong>Proposition.</strong> Dijkstra&rsquo;s algorithm computes a SPT in any edge-weighted diagraph with nonnegative weights.</p></li><li><p><strong>Pf.</strong></p><ul><li>Each edge e = v->w is relaxed exactly once (when v is relaxed), leaving distTo[w] &lt;= distTo[v] + e.weight()</li><li>Inequality hold until algorithm terminates because:<ul><li>distTo[w] cannot increase &lt;- distTo[] values are monotone decreasing</li><li>distTo[v] will not change &lt;- we choose lowest distTo[] value at each step (and edge weights are nonnegative)</li></ul></li><li>Thus, opun termination, shortest-paths optimality conditions hold</li></ul></li></ul><h4 id=java-implementation-4>Java implementation<a hidden class=anchor aria-hidden=true href=#java-implementation-4>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>DijkstraSP</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> DirectedEdge<span style=color:#f92672>[]</span> edgeTo<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>double</span><span style=color:#f92672>[]</span> distTo<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> IndexMinPQ<span style=color:#f92672>&lt;</span>Double<span style=color:#f92672>&gt;</span> pq<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#a6e22e>DijkstraSP</span><span style=color:#f92672>(</span>EdgeWeightedDigraph G<span style=color:#f92672>,</span> <span style=color:#66d9ef>int</span> s<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        edgeTo <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> DirectedEdge<span style=color:#f92672>[</span>G<span style=color:#f92672>.</span><span style=color:#a6e22e>V</span><span style=color:#f92672>()];</span>
</span></span><span style=display:flex><span>        distTo <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#66d9ef>double</span><span style=color:#f92672>[</span>G<span style=color:#f92672>.</span><span style=color:#a6e22e>V</span><span style=color:#f92672>()];</span>
</span></span><span style=display:flex><span>        pq <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> IndexMinPQ<span style=color:#f92672>&lt;</span>Double<span style=color:#f92672>&gt;(</span>G<span style=color:#f92672>.</span><span style=color:#a6e22e>V</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> v <span style=color:#f92672>=</span> 0<span style=color:#f92672>;</span> v <span style=color:#f92672>&lt;</span> G<span style=color:#f92672>.</span><span style=color:#a6e22e>V</span><span style=color:#f92672>();</span> v<span style=color:#f92672>++)</span>
</span></span><span style=display:flex><span>            distTo<span style=color:#f92672>[</span>v<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> Double<span style=color:#f92672>.</span><span style=color:#a6e22e>POSITIVE_INFINITY</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        distTo<span style=color:#f92672>[</span>s<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> 0<span style=color:#f92672>.</span><span style=color:#a6e22e>0</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        pq<span style=color:#f92672>.</span><span style=color:#a6e22e>insert</span><span style=color:#f92672>(</span>s<span style=color:#f92672>,</span> 0<span style=color:#f92672>.</span><span style=color:#a6e22e>0</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>while</span> <span style=color:#f92672>(!</span>pq<span style=color:#f92672>.</span><span style=color:#a6e22e>isEmpty</span><span style=color:#f92672>())</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>int</span> v <span style=color:#f92672>=</span> pq<span style=color:#f92672>.</span><span style=color:#a6e22e>delMin</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span>DirectedEdge e <span style=color:#f92672>:</span> G<span style=color:#f92672>.</span><span style=color:#a6e22e>adj</span><span style=color:#f92672>(</span>v<span style=color:#f92672>))</span>
</span></span><span style=display:flex><span>                relax<span style=color:#f92672>(</span>e<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>relax</span><span style=color:#f92672>(</span>DirectedEdge e<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> v <span style=color:#f92672>=</span> e<span style=color:#f92672>.</span><span style=color:#a6e22e>from</span><span style=color:#f92672>(),</span> w <span style=color:#f92672>=</span> e<span style=color:#f92672>.</span><span style=color:#a6e22e>to</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>distTo<span style=color:#f92672>[</span>w<span style=color:#f92672>]</span> <span style=color:#f92672>&gt;</span> distTo<span style=color:#f92672>[</span>v<span style=color:#f92672>]</span> <span style=color:#f92672>+</span> e<span style=color:#f92672>.</span><span style=color:#a6e22e>weight</span><span style=color:#f92672>())</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            distTo<span style=color:#f92672>[</span>w<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> distTo<span style=color:#f92672>[</span>v<span style=color:#f92672>]</span> <span style=color:#f92672>+</span> e<span style=color:#f92672>.</span><span style=color:#a6e22e>weight</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>            edgeTo<span style=color:#f92672>[</span>w<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> e<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>pq<span style=color:#f92672>.</span><span style=color:#a6e22e>contains</span><span style=color:#f92672>(</span>w<span style=color:#f92672>))</span> pq<span style=color:#f92672>.</span><span style=color:#a6e22e>decreaseKey</span><span style=color:#f92672>(</span>w<span style=color:#f92672>,</span> distTo<span style=color:#f92672>[</span>w<span style=color:#f92672>]);</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>else</span> pq<span style=color:#f92672>.</span><span style=color:#a6e22e>insert</span><span style=color:#f92672>(</span>w<span style=color:#f92672>,</span> distTo<span style=color:#f92672>[</span>w<span style=color:#f92672>]);</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>double</span> <span style=color:#a6e22e>distTo</span><span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> v<span style=color:#f92672>)</span> <span style=color:#f92672>{</span> <span style=color:#66d9ef>return</span> distTo<span style=color:#f92672>[</span>v<span style=color:#f92672>];</span> <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> Iterable<span style=color:#f92672>&lt;</span>DirectedEdge<span style=color:#f92672>&gt;</span> <span style=color:#a6e22e>pathTo</span><span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> v<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        Stack<span style=color:#f92672>&lt;</span>DirectedEdge<span style=color:#f92672>&gt;</span> path <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Stack<span style=color:#f92672>&lt;&gt;();</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span>DirectedEdge e <span style=color:#f92672>=</span> edgeTo<span style=color:#f92672>[</span>v<span style=color:#f92672>];</span> e <span style=color:#f92672>!=</span> <span style=color:#66d9ef>null</span><span style=color:#f92672>;</span> e <span style=color:#f92672>=</span> edgeTo<span style=color:#f92672>[</span>e<span style=color:#f92672>.</span><span style=color:#a6e22e>from</span><span style=color:#f92672>()])</span>
</span></span><span style=display:flex><span>            path<span style=color:#f92672>.</span><span style=color:#a6e22e>push</span><span style=color:#f92672>(</span>e<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> path<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><h3 id=edge-weighted-dags>edge-weighted DAGs<a hidden class=anchor aria-hidden=true href=#edge-weighted-dags>#</a></h3><h4 id=acyclic-shortest-paths-demo>Acyclic shortest paths demo<a hidden class=anchor aria-hidden=true href=#acyclic-shortest-paths-demo>#</a></h4><p><div class=render-image><img loading=lazy src=https://i.postimg.cc/j5bbc9gh/ezgif-4-83690900591b.gif alt></div></p><h4 id=shortest-paths-in-edge-weighted-dags>Shortest paths in edge-weighted DAGs<a hidden class=anchor aria-hidden=true href=#shortest-paths-in-edge-weighted-dags>#</a></h4><ul><li><strong>Proposition.</strong> Topological sort algorithm computes SPT in any (edge weights can be negative!) edge-weighted DAG in time proportional to <em>E + V</em></li><li><strong>Pf.</strong><ul><li>Each edge e = v->w is relaxed exactly once (when v is relaxed), leaving distTo[w] &lt;= distTo[v] + e.weight()</li><li>Inequality holds until algorithm terminates because:<ul><li>distTo[w] cannot increase &lt;- distTo[] values are monotone decreasing</li><li>distTo[v] will not change &lt;- because of topological order, no edge pointing to v will be relaxed after v is relaxed</li></ul></li><li>Thus, upon termination, shortest-paths optimality conditions hold</li></ul></li></ul><h4 id=java-implementation-5>Java Implementation<a hidden class=anchor aria-hidden=true href=#java-implementation-5>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>AcyclicSP</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> DirectedEdge<span style=color:#f92672>[]</span> edgeTo<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>double</span><span style=color:#f92672>[]</span> distTo<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#a6e22e>AcyclicSP</span><span style=color:#f92672>(</span>EdgeWeightedDigraph G<span style=color:#f92672>,</span> <span style=color:#66d9ef>int</span> s<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        edgeTo <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> DirectedEdge<span style=color:#f92672>[</span>G<span style=color:#f92672>.</span><span style=color:#a6e22e>V</span><span style=color:#f92672>()];</span>
</span></span><span style=display:flex><span>        distTo <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#66d9ef>double</span><span style=color:#f92672>[</span>G<span style=color:#f92672>.</span><span style=color:#a6e22e>V</span><span style=color:#f92672>()];</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> v <span style=color:#f92672>=</span> 0<span style=color:#f92672>;</span> v <span style=color:#f92672>&lt;</span> G<span style=color:#f92672>.</span><span style=color:#a6e22e>V</span><span style=color:#f92672>();</span> v<span style=color:#f92672>++)</span>
</span></span><span style=display:flex><span>            distTo<span style=color:#f92672>[</span>v<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> Double<span style=color:#f92672>.</span><span style=color:#a6e22e>POSITIVE_INFINITY</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        distTo<span style=color:#f92672>[</span>s<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> 0<span style=color:#f92672>.</span><span style=color:#a6e22e>0</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        Topological topological <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Topological<span style=color:#f92672>(</span>G<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> v <span style=color:#f92672>:</span> topological<span style=color:#f92672>.</span><span style=color:#a6e22e>order</span><span style=color:#f92672>())</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span>DirectedEdge e <span style=color:#f92672>:</span> G<span style=color:#f92672>.</span><span style=color:#a6e22e>adj</span><span style=color:#f92672>(</span>v<span style=color:#f92672>))</span>
</span></span><span style=display:flex><span>                relax<span style=color:#f92672>(</span>e<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>relax</span><span style=color:#f92672>(</span>DirectedEdge e<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> v <span style=color:#f92672>=</span> e<span style=color:#f92672>.</span><span style=color:#a6e22e>from</span><span style=color:#f92672>(),</span> w <span style=color:#f92672>=</span> e<span style=color:#f92672>.</span><span style=color:#a6e22e>to</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>distTo<span style=color:#f92672>[</span>w<span style=color:#f92672>]</span> <span style=color:#f92672>&gt;</span> distTo<span style=color:#f92672>[</span>v<span style=color:#f92672>]</span> <span style=color:#f92672>+</span> e<span style=color:#f92672>.</span><span style=color:#a6e22e>weight</span><span style=color:#f92672>())</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            distTo<span style=color:#f92672>[</span>w<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> distTo<span style=color:#f92672>[</span>v<span style=color:#f92672>]</span> <span style=color:#f92672>+</span> e<span style=color:#f92672>.</span><span style=color:#a6e22e>weight</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>            edgeTo<span style=color:#f92672>[</span>w<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> e<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> Iterable<span style=color:#f92672>&lt;</span>DirectedEdge<span style=color:#f92672>&gt;</span> <span style=color:#a6e22e>pathTo</span><span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> v<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        Stack<span style=color:#f92672>&lt;</span>DirectedEdge<span style=color:#f92672>&gt;</span> path <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Stack<span style=color:#f92672>&lt;&gt;();</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span>DirectedEdge e <span style=color:#f92672>=</span> edgeTo<span style=color:#f92672>[</span>v<span style=color:#f92672>];</span> e <span style=color:#f92672>!=</span> <span style=color:#66d9ef>null</span><span style=color:#f92672>;</span> e <span style=color:#f92672>=</span> edgeTo<span style=color:#f92672>[</span>e<span style=color:#f92672>.</span><span style=color:#a6e22e>from</span><span style=color:#f92672>()])</span>
</span></span><span style=display:flex><span>            path<span style=color:#f92672>.</span><span style=color:#a6e22e>push</span><span style=color:#f92672>(</span>e<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> path<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><h3 id=negative-weights>negative weights<a hidden class=anchor aria-hidden=true href=#negative-weights>#</a></h3><ul><li><strong>Def.</strong> A negative cycle is a directed cycle whose sum of edge weights is negative.</li><li><strong>Proposition.</strong> A SPT exists iff no negative cycles.</li></ul><h4 id=bellman-ford-algorithm-analysis>Bellman-Ford algorithm: analysis<a hidden class=anchor aria-hidden=true href=#bellman-ford-algorithm-analysis>#</a></h4><ul><li><p>Initialize distTo[s] = 0 and distTo[v] = $ \infty $ for all other vertices.</p></li><li><p>Repeat V times:</p><ul><li>Relax each edge.</li></ul></li><li><p><strong>Proposition.</strong> Dynamic programming algorithm computes SPT in any edge-weighted digraph with no negative cycles in time proportional to $E\times V$</p></li><li><p><strong>Pf idea.</strong> After pass i, found shortest path containing at most i edges.</p></li></ul><h4 id=bellman-ford-algorithm-practical-improvement>Bellman-Ford algorithm: practical improvement<a hidden class=anchor aria-hidden=true href=#bellman-ford-algorithm-practical-improvement>#</a></h4><ul><li><p><strong>Observation.</strong> If distTo[v] does not change during pass i, no need to relax any edge pointing from v in pass i+1.</p></li><li><p><strong>FIFO implementation.</strong> Maintain queue of vertices whose distTo[] changed.</p></li><li><p><strong>Overall effect.</strong></p><ul><li>The running time is still proportional to $E \times V $ in worst case.</li><li>But much faster than that in practice.</li></ul></li></ul><h4 id=bellman-ford-java-implementation>Bellman-Ford Java implementation<a hidden class=anchor aria-hidden=true href=#bellman-ford-java-implementation>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>BellmanFordSP</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>double</span><span style=color:#f92672>[]</span> distTo<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> DirectedEdge<span style=color:#f92672>[]</span> edgeTo<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> Queue<span style=color:#f92672>&lt;</span>Integer<span style=color:#f92672>&gt;</span> queue<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>boolean</span><span style=color:#f92672>[]</span> onQueue<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#a6e22e>BellmanFordSP</span><span style=color:#f92672>(</span>EdgeWeightedDigraph G<span style=color:#f92672>,</span> <span style=color:#66d9ef>int</span> s<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        distTo <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#66d9ef>double</span><span style=color:#f92672>[</span>G<span style=color:#f92672>.</span><span style=color:#a6e22e>V</span><span style=color:#f92672>()];</span>
</span></span><span style=display:flex><span>        onQueue <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#66d9ef>boolean</span><span style=color:#f92672>[</span>G<span style=color:#f92672>.</span><span style=color:#a6e22e>V</span><span style=color:#f92672>()];</span>
</span></span><span style=display:flex><span>        edgeTo <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> DirectedEdge<span style=color:#f92672>[</span>G<span style=color:#f92672>.</span><span style=color:#a6e22e>V</span><span style=color:#f92672>()];</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> v <span style=color:#f92672>=</span> 0<span style=color:#f92672>;</span> v <span style=color:#f92672>&lt;</span> G<span style=color:#f92672>.</span><span style=color:#a6e22e>V</span><span style=color:#f92672>();</span> v<span style=color:#f92672>++)</span>
</span></span><span style=display:flex><span>            distTo<span style=color:#f92672>[</span>v<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> Double<span style=color:#f92672>.</span><span style=color:#a6e22e>POSITIVE_INFINITY</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        distTo<span style=color:#f92672>[</span>s<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> 0<span style=color:#f92672>.</span><span style=color:#a6e22e>0</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        queue <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Queue<span style=color:#f92672>&lt;&gt;();</span>
</span></span><span style=display:flex><span>        queue<span style=color:#f92672>.</span><span style=color:#a6e22e>enqueue</span><span style=color:#f92672>(</span>s<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        onQueue<span style=color:#f92672>[</span>s<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>while</span> <span style=color:#f92672>(!</span>queue<span style=color:#f92672>.</span><span style=color:#a6e22e>isEmpty</span><span style=color:#f92672>())</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>int</span> v <span style=color:#f92672>=</span> queue<span style=color:#f92672>.</span><span style=color:#a6e22e>dequeue</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>            onQueue<span style=color:#f92672>[</span>v<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>            relax<span style=color:#f92672>(</span>G<span style=color:#f92672>,</span> v<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>relax</span><span style=color:#f92672>(</span>EdgeWeightedDigraph G<span style=color:#f92672>,</span> <span style=color:#66d9ef>int</span> v<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span>DirectedEdge e <span style=color:#f92672>:</span> G<span style=color:#f92672>.</span><span style=color:#a6e22e>adj</span><span style=color:#f92672>(</span>v<span style=color:#f92672>))</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>int</span> w <span style=color:#f92672>=</span> e<span style=color:#f92672>.</span><span style=color:#a6e22e>to</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>distTo<span style=color:#f92672>[</span>w<span style=color:#f92672>]</span> <span style=color:#f92672>&gt;</span> distTo<span style=color:#f92672>[</span>v<span style=color:#f92672>]</span> <span style=color:#f92672>+</span> e<span style=color:#f92672>.</span><span style=color:#a6e22e>weight</span><span style=color:#f92672>())</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                distTo<span style=color:#f92672>[</span>w<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> distTo<span style=color:#f92672>[</span>v<span style=color:#f92672>]</span> <span style=color:#f92672>+</span> e<span style=color:#f92672>.</span><span style=color:#a6e22e>weight</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>                edgeTo<span style=color:#f92672>[</span>w<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> e<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> <span style=color:#f92672>(!</span>onQueue<span style=color:#f92672>[</span>w<span style=color:#f92672>])</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                    queue<span style=color:#f92672>.</span><span style=color:#a6e22e>enqueue</span><span style=color:#f92672>(</span>w<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>                    onQueue<span style=color:#f92672>[</span>w<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> Iterable<span style=color:#f92672>&lt;</span>DirectedEdge<span style=color:#f92672>&gt;</span> <span style=color:#a6e22e>pathTo</span><span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> v<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        Stack<span style=color:#f92672>&lt;</span>DirectedEdge<span style=color:#f92672>&gt;</span> path <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Stack<span style=color:#f92672>&lt;&gt;();</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span>DirectedEdge e <span style=color:#f92672>=</span> edgeTo<span style=color:#f92672>[</span>v<span style=color:#f92672>];</span> e <span style=color:#f92672>!=</span> <span style=color:#66d9ef>null</span><span style=color:#f92672>;</span> e <span style=color:#f92672>=</span> edgeTo<span style=color:#f92672>[</span>e<span style=color:#f92672>.</span><span style=color:#a6e22e>from</span><span style=color:#f92672>()])</span>
</span></span><span style=display:flex><span>            path<span style=color:#f92672>.</span><span style=color:#a6e22e>push</span><span style=color:#f92672>(</span>e<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> path<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><h4 id=single-source-shortest-path-implementation-cost-summary>Single source shortest-path implementation: cost summary<a hidden class=anchor aria-hidden=true href=#single-source-shortest-path-implementation-cost-summary>#</a></h4><table><thead><tr><th>algorithm</th><th>restriction</th><th>typical case</th><th>worst case</th><th>extra case</th></tr></thead><tbody><tr><td>topological sort</td><td>no directed cycles</td><td>E + V</td><td>E + V</td><td>V</td></tr><tr><td>Dijkstra (binary heap)</td><td>no negative weights</td><td>ElogV</td><td>ElogV</td><td>V</td></tr><tr><td>Bellman-Ford</td><td>no negative cycles</td><td>EV</td><td>EV</td><td>V</td></tr><tr><td>Bellman-Ford(queue-based)</td><td>no negative cycles</td><td>E + V</td><td>EV</td><td>V</td></tr></tbody></table><h3 id=441>4.4.1<a hidden class=anchor aria-hidden=true href=#441>#</a></h3><p>True or false. Adding a constant to every edge weight does not change the solution to the single-source shortest-paths problem.</p><p>False. 假设一条最短路径的长度是15, 且一共有五条边，而另外一条简单路径的长度为20，由两条边组成，当每条边的权值都增加5之后，原来长度15的路径长度变为40，原来长度为20的路径长度变为30，可以看到最短路径改变了。</p><h3 id=445>4.4.5<a hidden class=anchor aria-hidden=true href=#445>#</a></h3><p>Change the direction of edge 0->2 in tinyEWD.txt (see page 644). Draw two different
SPTs that are rooted at 2 for this modified edge-weighted digraph.<div class=render-image><img loading=lazy src=https://i.postimg.cc/fL7gcsnN/graph.png alt></div></p><h3 id=459>4.5.9<a hidden class=anchor aria-hidden=true href=#459>#</a></h3><p>The table below, from an old published road map, purports to give the length of the shortest routes connecting the cities. It contains an error. Correct the table. Also, add a table that shows how to achieve the shortest routes.</p><p><div class=render-image><img loading=lazy src=https://i.postimg.cc/bv8TXN6S/Snipaste-2020-12-04-21-48-19.jpg alt></div></p><table><thead><tr><th></th><th>Providence</th><th>Westerly</th><th>New London</th><th>Norwich</th></tr></thead><tbody><tr><td>Providence</td><td></td><td>53</td><td>54</td><td>48</td></tr><tr><td>Westerly</td><td>53</td><td></td><td>18</td><td>30</td></tr><tr><td>New London</td><td>54</td><td>18</td><td></td><td>12</td></tr><tr><td>Norwich</td><td>48</td><td>30</td><td>12</td><td></td></tr></tbody></table><p>给Providence、Westerly、New London、Norwich 分别编号为0、1、2、3</p><p>最短路径：</p><table><thead><tr><th></th><th>Providence</th><th>Westerly</th><th>New London</th><th>Norwich</th></tr></thead><tbody><tr><td>Providence</td><td></td><td>0-1</td><td>0-2</td><td>0-3</td></tr><tr><td>Westerly</td><td>1-0</td><td></td><td>1-2</td><td>1-2、2-3</td></tr><tr><td>New London</td><td>2-0</td><td>2-1</td><td></td><td>2-3</td></tr><tr><td>Norwich</td><td>3-0</td><td>3-2、2-1</td><td>3-2</td><td></td></tr></tbody></table><h2 id=string-sorts>String sorts<a hidden class=anchor aria-hidden=true href=#string-sorts>#</a></h2><h3 id=key-indexed-counting>key-indexed counting<a hidden class=anchor aria-hidden=true href=#key-indexed-counting>#</a></h3><ul><li><p><strong>Proposition.</strong> Key-indexed counting uses $ ~ 11N+4R $ array accesses to sort a <em>N</em> items whose keys are integers between <em>0</em> and <em>R-1</em>.</p></li><li><p><strong>Proposition.</strong> Key-indexed counting uses extra space proportional to <em>N + R</em></p></li><li><p><strong>Stable.</strong></p></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>CountingSort</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>sort</span><span style=color:#f92672>(</span><span style=color:#66d9ef>int</span><span style=color:#f92672>[]</span> a<span style=color:#f92672>,</span> <span style=color:#66d9ef>int</span> R<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> N <span style=color:#f92672>=</span> a<span style=color:#f92672>.</span><span style=color:#a6e22e>length</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span><span style=color:#f92672>[]</span> count <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#66d9ef>int</span><span style=color:#f92672>[</span>R<span style=color:#f92672>+</span>1<span style=color:#f92672>];</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span><span style=color:#f92672>[]</span> aux <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#66d9ef>int</span><span style=color:#f92672>[</span>N<span style=color:#f92672>];</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> 0<span style=color:#f92672>;</span> i <span style=color:#f92672>&lt;</span> N<span style=color:#f92672>;</span> i<span style=color:#f92672>++)</span>
</span></span><span style=display:flex><span>            count<span style=color:#f92672>[</span>a<span style=color:#f92672>[</span>i<span style=color:#f92672>]+</span>1<span style=color:#f92672>]++;</span> <span style=color:#75715e>// count[a[i]+1] = count[a[i+1]] + 1
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> r <span style=color:#f92672>=</span> 0<span style=color:#f92672>;</span> r <span style=color:#f92672>&lt;</span> R<span style=color:#f92672>;</span> r<span style=color:#f92672>++)</span>
</span></span><span style=display:flex><span>            count<span style=color:#f92672>[</span>r<span style=color:#f92672>+</span>1<span style=color:#f92672>]</span> <span style=color:#f92672>+=</span> count<span style=color:#f92672>[</span>r<span style=color:#f92672>];</span> <span style=color:#75715e>// 第一个位置
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> 0<span style=color:#f92672>;</span> i <span style=color:#f92672>&lt;</span> N<span style=color:#f92672>;</span> i<span style=color:#f92672>++)</span>
</span></span><span style=display:flex><span>            aux<span style=color:#f92672>[</span>count<span style=color:#f92672>[</span>a<span style=color:#f92672>[</span>i<span style=color:#f92672>]]++]</span> <span style=color:#f92672>=</span> a<span style=color:#f92672>[</span>i<span style=color:#f92672>];</span> <span style=color:#75715e>// aux[count[a[i]] = count[a[i]]+1] = a[i]
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> 0<span style=color:#f92672>;</span> i <span style=color:#f92672>&lt;</span> N<span style=color:#f92672>;</span> i<span style=color:#f92672>++)</span>
</span></span><span style=display:flex><span>            a<span style=color:#f92672>[</span>i<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> aux<span style=color:#f92672>[</span>i<span style=color:#f92672>];</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>main</span><span style=color:#f92672>(</span>String<span style=color:#f92672>[]</span> args<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        String s <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;dacffbdbfbea&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span><span style=color:#f92672>[]</span> a <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#66d9ef>int</span><span style=color:#f92672>[</span>s<span style=color:#f92672>.</span><span style=color:#a6e22e>length</span><span style=color:#f92672>()];</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> 0<span style=color:#f92672>;</span> i <span style=color:#f92672>&lt;</span> a<span style=color:#f92672>.</span><span style=color:#a6e22e>length</span><span style=color:#f92672>;</span> i<span style=color:#f92672>++)</span>
</span></span><span style=display:flex><span>            a<span style=color:#f92672>[</span>i<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> s<span style=color:#f92672>.</span><span style=color:#a6e22e>charAt</span><span style=color:#f92672>(</span>i<span style=color:#f92672>)-</span><span style=color:#e6db74>&#39;a&#39;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        sort<span style=color:#f92672>(</span>a<span style=color:#f92672>,</span> 26<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span>var e <span style=color:#f92672>:</span> a<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>printf</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;%c &#34;</span><span style=color:#f92672>,</span> e<span style=color:#f92672>+</span><span style=color:#e6db74>&#39;a&#39;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><h3 id=lsd-radix-sort>LSD radix sort<a hidden class=anchor aria-hidden=true href=#lsd-radix-sort>#</a></h3><h4 id=least-significant-digit-first-string-sort>Least-significant-digit-first string sort<a hidden class=anchor aria-hidden=true href=#least-significant-digit-first-string-sort>#</a></h4><ul><li>Consider characters from right to left.</li><li>Stably sort using dth character as the key (using key-indexed counting).</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>LSD</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>sort</span><span style=color:#f92672>(</span>String<span style=color:#f92672>[]</span> a<span style=color:#f92672>,</span> <span style=color:#66d9ef>int</span> W<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> R <span style=color:#f92672>=</span> 256<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> N <span style=color:#f92672>=</span> a<span style=color:#f92672>.</span><span style=color:#a6e22e>length</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        String<span style=color:#f92672>[]</span> aux <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> String<span style=color:#f92672>[</span>N<span style=color:#f92672>];</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> d <span style=color:#f92672>=</span> W<span style=color:#f92672>-</span>1<span style=color:#f92672>;</span> d <span style=color:#f92672>&gt;=</span> 0<span style=color:#f92672>;</span> d<span style=color:#f92672>--)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>int</span><span style=color:#f92672>[]</span> count <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#66d9ef>int</span><span style=color:#f92672>[</span>R<span style=color:#f92672>+</span>1<span style=color:#f92672>];</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> 0<span style=color:#f92672>;</span> i <span style=color:#f92672>&lt;</span> N<span style=color:#f92672>;</span> i<span style=color:#f92672>++)</span>
</span></span><span style=display:flex><span>                count<span style=color:#f92672>[</span>a<span style=color:#f92672>[</span>i<span style=color:#f92672>].</span><span style=color:#a6e22e>charAt</span><span style=color:#f92672>(</span>d<span style=color:#f92672>)+</span>1<span style=color:#f92672>]++;</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> r <span style=color:#f92672>=</span> 0<span style=color:#f92672>;</span> r <span style=color:#f92672>&lt;</span> R<span style=color:#f92672>;</span> r<span style=color:#f92672>++)</span>
</span></span><span style=display:flex><span>                count<span style=color:#f92672>[</span>r<span style=color:#f92672>+</span>1<span style=color:#f92672>]</span> <span style=color:#f92672>+=</span> count<span style=color:#f92672>[</span>r<span style=color:#f92672>];</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> 0<span style=color:#f92672>;</span> i <span style=color:#f92672>&lt;</span> N<span style=color:#f92672>;</span> i<span style=color:#f92672>++)</span>
</span></span><span style=display:flex><span>                aux<span style=color:#f92672>[</span>count<span style=color:#f92672>[</span>a<span style=color:#f92672>[</span>i<span style=color:#f92672>].</span><span style=color:#a6e22e>charAt</span><span style=color:#f92672>(</span>d<span style=color:#f92672>)]++]</span> <span style=color:#f92672>=</span> a<span style=color:#f92672>[</span>i<span style=color:#f92672>];</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> 0<span style=color:#f92672>;</span> i <span style=color:#f92672>&lt;</span> N<span style=color:#f92672>;</span> i<span style=color:#f92672>++)</span>
</span></span><span style=display:flex><span>                a<span style=color:#f92672>[</span>i<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> aux<span style=color:#f92672>[</span>i<span style=color:#f92672>];</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>main</span><span style=color:#f92672>(</span>String<span style=color:#f92672>[]</span> args<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        In in <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> In<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;D:\\Java_test\\test1\\src\\StringSort\\strings.txt&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        String<span style=color:#f92672>[]</span> a <span style=color:#f92672>=</span> in<span style=color:#f92672>.</span><span style=color:#a6e22e>readAllStrings</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> N <span style=color:#f92672>=</span> a<span style=color:#f92672>.</span><span style=color:#a6e22e>length</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> w <span style=color:#f92672>=</span> a<span style=color:#f92672>[</span>0<span style=color:#f92672>].</span><span style=color:#a6e22e>length</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> 1<span style=color:#f92672>;</span> i <span style=color:#f92672>&lt;</span> N<span style=color:#f92672>;</span> i<span style=color:#f92672>++)</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>assert</span> a<span style=color:#f92672>[</span>i<span style=color:#f92672>].</span><span style=color:#a6e22e>length</span><span style=color:#f92672>()</span> <span style=color:#f92672>==</span> w <span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;String must have fixed length&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        sort<span style=color:#f92672>(</span>a<span style=color:#f92672>,</span> w<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span>var e <span style=color:#f92672>:</span> a<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>            System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>println</span><span style=color:#f92672>(</span>e<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><h4 id=summary-of-the-performence-of-sorting-algorithms>Summary of the performence of sorting algorithms<a hidden class=anchor aria-hidden=true href=#summary-of-the-performence-of-sorting-algorithms>#</a></h4><p><div class=render-image><img loading=lazy src=https://i.postimg.cc/mkM2KqMV/Snipaste-2020-12-04-21-48-19.jpg alt></div></p><h3 id=msd-radix-sort>MSD radix sort<a hidden class=anchor aria-hidden=true href=#msd-radix-sort>#</a></h3><h4 id=most-significant-digit-first-srting-sort>Most-significant-digit-first srting sort<a hidden class=anchor aria-hidden=true href=#most-significant-digit-first-srting-sort>#</a></h4><ul><li>Partition array into <em>R</em> pieces according to first character (using key-indexed counting).</li><li>Recursively sort all strings that start with each character (key-indexed counts delineate subarrays to sort).</li></ul><h4 id=implementation-3>Implementation<a hidden class=anchor aria-hidden=true href=#implementation-3>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>MSD</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>final</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>int</span> R <span style=color:#f92672>=</span> 256<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>sort</span><span style=color:#f92672>(</span>String<span style=color:#f92672>[]</span> a<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        String<span style=color:#f92672>[]</span> aux <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> String<span style=color:#f92672>[</span>a<span style=color:#f92672>.</span><span style=color:#a6e22e>length</span><span style=color:#f92672>];</span>
</span></span><span style=display:flex><span>        sort<span style=color:#f92672>(</span>a<span style=color:#f92672>,</span> aux<span style=color:#f92672>,</span> 0<span style=color:#f92672>,</span> a<span style=color:#f92672>.</span><span style=color:#a6e22e>length</span><span style=color:#f92672>-</span>1<span style=color:#f92672>,</span> 0<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>sort</span><span style=color:#f92672>(</span>String<span style=color:#f92672>[]</span> a<span style=color:#f92672>,</span> String<span style=color:#f92672>[]</span> aux<span style=color:#f92672>,</span> <span style=color:#66d9ef>int</span> lo<span style=color:#f92672>,</span> <span style=color:#66d9ef>int</span> hi<span style=color:#f92672>,</span> <span style=color:#66d9ef>int</span> d<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>hi <span style=color:#f92672>&lt;=</span> lo<span style=color:#f92672>)</span> <span style=color:#66d9ef>return</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span><span style=color:#f92672>[]</span> count <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#66d9ef>int</span><span style=color:#f92672>[</span>R<span style=color:#f92672>+</span>2<span style=color:#f92672>];</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> lo<span style=color:#f92672>;</span> i <span style=color:#f92672>&lt;=</span> hi<span style=color:#f92672>;</span> i<span style=color:#f92672>++)</span>
</span></span><span style=display:flex><span>            count<span style=color:#f92672>[</span>charAt<span style=color:#f92672>(</span>a<span style=color:#f92672>[</span>i<span style=color:#f92672>],</span> d<span style=color:#f92672>)+</span>2<span style=color:#f92672>]++;</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> r <span style=color:#f92672>=</span> 0<span style=color:#f92672>;</span> r <span style=color:#f92672>&lt;</span> R <span style=color:#f92672>+</span> 1<span style=color:#f92672>;</span> r<span style=color:#f92672>++)</span>
</span></span><span style=display:flex><span>            count<span style=color:#f92672>[</span>r<span style=color:#f92672>+</span>1<span style=color:#f92672>]</span> <span style=color:#f92672>+=</span> count<span style=color:#f92672>[</span>r<span style=color:#f92672>];</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> lo<span style=color:#f92672>;</span> i <span style=color:#f92672>&lt;=</span> hi<span style=color:#f92672>;</span> i<span style=color:#f92672>++)</span>
</span></span><span style=display:flex><span>            aux<span style=color:#f92672>[</span>count<span style=color:#f92672>[</span>charAt<span style=color:#f92672>(</span>a<span style=color:#f92672>[</span>i<span style=color:#f92672>],</span> d<span style=color:#f92672>)+</span>1<span style=color:#f92672>]++]</span> <span style=color:#f92672>=</span> a<span style=color:#f92672>[</span>i<span style=color:#f92672>];</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> lo<span style=color:#f92672>;</span> i <span style=color:#f92672>&lt;=</span> hi<span style=color:#f92672>;</span> i<span style=color:#f92672>++)</span>
</span></span><span style=display:flex><span>            a<span style=color:#f92672>[</span>i<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> aux<span style=color:#f92672>[</span>i <span style=color:#f92672>-</span> lo<span style=color:#f92672>];</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> r <span style=color:#f92672>=</span> 0<span style=color:#f92672>;</span> r <span style=color:#f92672>&lt;</span> R<span style=color:#f92672>;</span> r<span style=color:#f92672>++)</span>
</span></span><span style=display:flex><span>            sort<span style=color:#f92672>(</span>a<span style=color:#f92672>,</span> aux<span style=color:#f92672>,</span> lo<span style=color:#f92672>+</span>count<span style=color:#f92672>[</span>r<span style=color:#f92672>],</span> lo<span style=color:#f92672>+</span>count<span style=color:#f92672>[</span>r<span style=color:#f92672>+</span>1<span style=color:#f92672>]-</span>1<span style=color:#f92672>,</span> d<span style=color:#f92672>+</span>1<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>int</span> <span style=color:#a6e22e>charAt</span><span style=color:#f92672>(</span>String s<span style=color:#f92672>,</span> <span style=color:#66d9ef>int</span> d<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>s<span style=color:#f92672>.</span><span style=color:#a6e22e>length</span><span style=color:#f92672>()</span> <span style=color:#f92672>&gt;</span> d<span style=color:#f92672>)</span> <span style=color:#66d9ef>return</span> s<span style=color:#f92672>.</span><span style=color:#a6e22e>charAt</span><span style=color:#f92672>(</span>d<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>return</span> <span style=color:#f92672>-</span>1<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>main</span><span style=color:#f92672>(</span>String<span style=color:#f92672>[]</span> args<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        In in <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> In<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;D:\\Java_test\\test1\\src\\StringSort\\strings.txt&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        String<span style=color:#f92672>[]</span> a <span style=color:#f92672>=</span> in<span style=color:#f92672>.</span><span style=color:#a6e22e>readAllStrings</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>        sort<span style=color:#f92672>(</span>a<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span>var e <span style=color:#f92672>:</span> a<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>            System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>println</span><span style=color:#f92672>(</span>e<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><h3 id=suffix-arrays>suffix arrays<a hidden class=anchor aria-hidden=true href=#suffix-arrays>#</a></h3><h4 id=longest-repeated-substring-java-implementation>Longest repeated substring: Java implementation<a hidden class=anchor aria-hidden=true href=#longest-repeated-substring-java-implementation>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>LRS</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> String <span style=color:#a6e22e>lrs</span><span style=color:#f92672>(</span>String s<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> N <span style=color:#f92672>=</span> s<span style=color:#f92672>.</span><span style=color:#a6e22e>length</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>        String<span style=color:#f92672>[]</span> suffixes <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> String<span style=color:#f92672>[</span>N<span style=color:#f92672>];</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> 0<span style=color:#f92672>;</span> i <span style=color:#f92672>&lt;</span> N<span style=color:#f92672>;</span> i<span style=color:#f92672>++)</span>
</span></span><span style=display:flex><span>            suffixes<span style=color:#f92672>[</span>i<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> s<span style=color:#f92672>.</span><span style=color:#a6e22e>substring</span><span style=color:#f92672>(</span>i<span style=color:#f92672>,</span> N<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        Arrays<span style=color:#f92672>.</span><span style=color:#a6e22e>sort</span><span style=color:#f92672>(</span>suffixes<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        String lrs <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> 0<span style=color:#f92672>;</span> i <span style=color:#f92672>&lt;</span> N <span style=color:#f92672>-</span> 1<span style=color:#f92672>;</span> i<span style=color:#f92672>++)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>int</span> len <span style=color:#f92672>=</span> lcp<span style=color:#f92672>(</span>suffixes<span style=color:#f92672>[</span>i<span style=color:#f92672>],</span> suffixes<span style=color:#f92672>[</span>i<span style=color:#f92672>+</span>1<span style=color:#f92672>]);</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>len <span style=color:#f92672>&gt;</span> lrs<span style=color:#f92672>.</span><span style=color:#a6e22e>length</span><span style=color:#f92672>())</span>
</span></span><span style=display:flex><span>                lrs <span style=color:#f92672>=</span> suffixes<span style=color:#f92672>[</span>i<span style=color:#f92672>].</span><span style=color:#a6e22e>substring</span><span style=color:#f92672>(</span>0<span style=color:#f92672>,</span> len<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> lrs<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>int</span> <span style=color:#a6e22e>lcp</span><span style=color:#f92672>(</span>String s<span style=color:#f92672>,</span> String t<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> n <span style=color:#f92672>=</span> Math<span style=color:#f92672>.</span><span style=color:#a6e22e>min</span><span style=color:#f92672>(</span>s<span style=color:#f92672>.</span><span style=color:#a6e22e>length</span><span style=color:#f92672>(),</span> t<span style=color:#f92672>.</span><span style=color:#a6e22e>length</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> 0<span style=color:#f92672>;</span> i <span style=color:#f92672>&lt;</span> n<span style=color:#f92672>;</span> i<span style=color:#f92672>++)</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>s<span style=color:#f92672>.</span><span style=color:#a6e22e>charAt</span><span style=color:#f92672>(</span>i<span style=color:#f92672>)</span> <span style=color:#f92672>!=</span> t<span style=color:#f92672>.</span><span style=color:#a6e22e>charAt</span><span style=color:#f92672>(</span>i<span style=color:#f92672>))</span> <span style=color:#66d9ef>return</span> i<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> n<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>main</span><span style=color:#f92672>(</span>String<span style=color:#f92672>[]</span> args<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        String s <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;aacaagtttacaagc&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>println</span><span style=color:#f92672>(</span>lrs<span style=color:#f92672>(</span>s<span style=color:#f92672>));</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://fffzlfk.github.io/tags/java/>Java</a></li><li><a href=https://fffzlfk.github.io/tags/academic/>Academic</a></li></ul><nav class=paginav><a class=prev href=https://fffzlfk.github.io/posts/c++%E4%B8%B4%E6%97%B6%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%88%86%E6%9E%90/><span class=title>« Prev</span><br><span>C++(临时对象的分析)</span></a>
<a class=next href=https://fffzlfk.github.io/posts/oopc++/><span class=title>Next »</span><br><span>OOP(C++)</span></a></nav></footer><div id=disqus_thread></div><script type=application/javascript>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//https-fffzlfk-github-io.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></article></main><footer class=footer><span>&copy; 2022 <a href=https://fffzlfk.github.io>fffzlfk's Blog</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>