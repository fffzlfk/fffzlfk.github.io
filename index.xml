<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>fffzlfk's Blog</title><link>https://fffzlfk.github.io/</link><description>Recent content on fffzlfk's Blog</description><generator>Hugo</generator><language>zh-cn</language><lastBuildDate>Thu, 22 May 2025 15:55:17 +0800</lastBuildDate><atom:link href="https://fffzlfk.github.io/index.xml" rel="self" type="application/rss+xml"/><item><title>ä½¿ç”¨è‡ªç„¶è¯­è¨€äº¤äº’Neonæ•°æ®åº“</title><link>https://fffzlfk.github.io/posts/%E4%BD%BF%E7%94%A8%E8%87%AA%E7%84%B6%E8%AF%AD%E8%A8%80%E4%BA%A4%E4%BA%92neon%E6%95%B0%E6%8D%AE%E5%BA%93/</link><pubDate>Thu, 22 May 2025 15:55:17 +0800</pubDate><guid>https://fffzlfk.github.io/posts/%E4%BD%BF%E7%94%A8%E8%87%AA%E7%84%B6%E8%AF%AD%E8%A8%80%E4%BA%A4%E4%BA%92neon%E6%95%B0%E6%8D%AE%E5%BA%93/</guid><description>&lt;h2 id="neon-mcp-æœåŠ¡å™¨">Neon MCP æœåŠ¡å™¨&lt;/h2>
&lt;p>Neon MCP Server æ˜¯ä¸€ä¸ªå¼€æºå·¥å…·ï¼Œå®ƒè®©ä½ é€šè¿‡è‡ªç„¶è¯­è¨€ä¸ Neon Postgres æ•°æ®åº“è¿›è¡Œäº¤äº’ã€‚&lt;/p>
&lt;p>ä¸å†éœ€è¦ä½¿ç”¨ Neon æ§åˆ¶å°æˆ– APIï¼Œåªéœ€è¾“å…¥ç±»ä¼¼â€œåˆ›å»ºåä¸º &amp;lsquo;my-new-database&amp;rsquo; çš„æ•°æ®åº“â€çš„è¯·æ±‚å³å¯ã€‚
å¦‚æœä½ æƒ³æŸ¥çœ‹ä½ çš„é¡¹ç›®ï¼Œä½ å¯ä»¥é—®ï¼šâ€œåˆ—å‡ºæˆ‘æ‰€æœ‰çš„ Neon é¡¹ç›®â€ã€‚Neon MCP Server è®©è¿™ä¸€åˆ‡æˆä¸ºå¯èƒ½ã€‚&lt;/p>
&lt;p>å®ƒçš„å·¥ä½œåŸç†æ˜¯ä½œä¸ºè‡ªç„¶è¯­è¨€è¯·æ±‚å’Œ Neon API ä¹‹é—´çš„æ¡¥æ¢ã€‚åŸºäº Model Context Protocolï¼ˆMCPï¼‰ æ„å»ºï¼Œå®ƒå¯ä»¥å°†ä½ çš„è¯·æ±‚è½¬æ¢ä¸ºå¿…è¦çš„ Neon API è°ƒç”¨ï¼Œä½¿ä½ èƒ½å¤Ÿç®¡ç†ä»åˆ›å»ºé¡¹ç›®å’Œåˆ†æ”¯åˆ°è¿è¡ŒæŸ¥è¯¢å’Œæ‰§è¡Œæ•°æ®åº“è¿ç§»çš„ä¸€åˆ‡æ“ä½œã€‚&lt;/p>
&lt;p>Neon MCP Server åœ¨ MCP æ¶æ„ä¸­å……å½“æœåŠ¡å™¨è§’è‰²ï¼Œä¸“ä¸º Neon è®¾è®¡ã€‚å®ƒæä¾›äº†ä¸€ç»„å·¥å…·ï¼ŒMCP å®¢æˆ·ç«¯ï¼ˆå¦‚ Claude Desktopã€Cursorï¼‰å¯ä»¥åˆ©ç”¨è¿™äº›å·¥å…·æ¥ç®¡ç† Neon èµ„æºã€‚è¿™åŒ…æ‹¬é¡¹ç›®ç®¡ç†ã€åˆ†æ”¯ç®¡ç†ã€æ‰§è¡Œ SQL æŸ¥è¯¢ä»¥åŠå¤„ç†æ•°æ®åº“è¿ç§»ç­‰æ“ä½œï¼Œæ‰€æœ‰è¿™äº›éƒ½æ˜¯é€šè¿‡è‡ªç„¶è¯­è¨€è¯·æ±‚é©±åŠ¨çš„ã€‚&lt;/p>
&lt;h3 id="mcp-å’Œ-neon-mcp-server">MCP å’Œ Neon MCP Server&lt;/h3>
&lt;p>Model Context Protocol (MCP) æ ‡å‡†åŒ–äº†å¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMsï¼‰ä¸å¤–éƒ¨å·¥å…·ä¹‹é—´çš„é€šä¿¡ã€‚å®ƒå®šä¹‰äº†ä¸€ä¸ªå®¢æˆ·ç«¯-æœåŠ¡å™¨æ¶æ„ï¼Œä½¿ LLMsï¼ˆç§°ä¸º Hostsï¼‰å¯ä»¥è¿æ¥åˆ°æä¾›ä¸Šä¸‹æ–‡å’Œå·¥å…·çš„ä¸“ä¸šæœåŠ¡å™¨ï¼Œä»è€Œä¸å¤–éƒ¨ç³»ç»Ÿè¿›è¡Œäº¤äº’ã€‚MCP æ¶æ„çš„å…³é”®ç»„ä»¶åŒ…æ‹¬ï¼š&lt;/p>
&lt;ul>
&lt;li>Hostï¼ˆä¸»æœºï¼‰ ï¼šè¿™äº›æ˜¯ AI åº”ç”¨ç¨‹åºï¼Œä¾‹å¦‚ Claude Desktop æˆ– Cursor è¿™ç±» IDEï¼Œå®ƒä»¬ä¼šä¸»åŠ¨è¿æ¥åˆ° MCP æœåŠ¡å™¨ã€‚&lt;/li>
&lt;li>Clientï¼ˆå®¢æˆ·ç«¯ï¼‰ ï¼šè¿™äº›å®¢æˆ·ç«¯ä½äº Host åº”ç”¨ä¸­ï¼Œå¹¶ä¸å„ä¸ª MCP æœåŠ¡å™¨ä¿æŒä¸€å¯¹ä¸€è¿æ¥ã€‚&lt;/li>
&lt;li>Serverï¼ˆæœåŠ¡å™¨ï¼‰ ï¼šè¿™ç±»ç¨‹åºï¼Œå¦‚ Neon MCP Serverï¼Œä¸ºå®¢æˆ·ç«¯æä¾›ä¸Šä¸‹æ–‡ã€å·¥å…·å’Œæç¤ºä¿¡æ¯ï¼Œä½¿å…¶å¯ä»¥è®¿é—®å¤–éƒ¨æ•°æ®å’ŒåŠŸèƒ½ã€‚&lt;/li>
&lt;/ul>
&lt;h3 id="ä¸ºä»€ä¹ˆè¦ä½¿ç”¨-mcp">ä¸ºä»€ä¹ˆè¦ä½¿ç”¨ MCPï¼Ÿ&lt;/h3>
&lt;p>ä¼ ç»Ÿä¸Šï¼Œå°† AI æ¨¡å‹è¿æ¥åˆ°ä¸åŒæ•°æ®æºéœ€è¦å¼€å‘è€…ä¸ºæ¯ä¸ªé›†æˆç¼–å†™å®šåˆ¶ä»£ç ã€‚è¿™ç§ç¢ç‰‡åŒ–çš„æ–¹æ³•å¢åŠ äº†å¼€å‘æ—¶é—´ã€ç»´æŠ¤è´Ÿæ‹…ï¼Œå¹¶é™åˆ¶äº† AI æ¨¡å‹ä¸å·¥å…·ä¹‹é—´çš„äº’æ“ä½œæ€§ã€‚MCP é€šè¿‡æä¾›ä¸€ç§æ ‡å‡†åŒ–åè®®è§£å†³äº†è¿™ä¸ªé—®é¢˜ï¼Œç®€åŒ–äº†é›†æˆè¿‡ç¨‹ï¼ŒåŠ é€Ÿäº†å¼€å‘é€Ÿåº¦ï¼Œå¹¶å¢å¼ºäº† AI åŠ©æ‰‹çš„åŠŸèƒ½ã€‚&lt;/p></description></item><item><title>æ•°æ®åº“ç´¢å¼•å®ç°</title><link>https://fffzlfk.github.io/posts/database-index-implementation/</link><pubDate>Tue, 10 Oct 2023 04:38:46 +0800</pubDate><guid>https://fffzlfk.github.io/posts/database-index-implementation/</guid><description>&lt;h2 id="b-æ ‘">B æ ‘&lt;/h2>
&lt;p>B æ ‘ï¼ˆB-treeï¼‰æ˜¯ä¸€ç§è‡ªå¹³è¡¡çš„æ ‘ï¼Œèƒ½å¤Ÿä¿æŒæ•°æ®æœ‰åºã€‚è¿™ç§æ•°æ®ç»“æ„èƒ½å¤Ÿè®©æŸ¥æ‰¾æ•°æ®ã€é¡ºåºè®¿é—®ã€æ’å…¥æ•°æ®åŠåˆ é™¤çš„åŠ¨ä½œï¼Œéƒ½åœ¨å¯¹æ•°æ—¶é—´å†…å®Œæˆã€‚&lt;/p>
&lt;p>åœ¨ B æ ‘ä¸­ï¼Œæœ‰ä¸¤ç§ç»“ç‚¹:&lt;/p>
&lt;ol>
&lt;li>å†…éƒ¨ç»“ç‚¹ï¼ˆinternal nodeï¼‰ï¼šå­˜å‚¨äº†æ•°æ®ä»¥åŠæŒ‡å‘å…¶å­ç»“ç‚¹çš„æŒ‡é’ˆã€‚&lt;/li>
&lt;li>å¶å­ç»“ç‚¹ï¼ˆleaf nodeï¼‰ï¼šä¸å†…éƒ¨ç»“ç‚¹ä¸åŒçš„æ˜¯ï¼Œå¶å­ç»“ç‚¹åªå­˜å‚¨æ•°æ®ï¼Œå¹¶æ²¡æœ‰å­ç»“ç‚¹ã€‚&lt;/li>
&lt;/ol>
&lt;p>&lt;img src="./images/1.png" alt="">&lt;/p>
&lt;h2 id="b-æ ‘-1">B+ æ ‘&lt;/h2>
&lt;p>B+ æ ‘æ˜¯ B æ ‘çš„ä¸€ä¸ªå‡çº§ã€‚&lt;/p>
&lt;ul>
&lt;li>æ‰€æœ‰çš„éå¶å­ç»“ç‚¹å¯ä»¥çœ‹æˆæ˜¯ç´¢å¼•éƒ¨åˆ†ï¼Œä¸å­˜å‚¨æ•°æ®ï¼›&lt;/li>
&lt;li>å¶å­ç»“ç‚¹å­˜å‚¨æ•°æ®ï¼Œå¹¶ä¸”æ‰€æœ‰å¶å­ç»“ç‚¹å½¢æˆé“¾è¡¨ã€‚&lt;/li>
&lt;/ul>
&lt;p>&lt;img src="./images/2.png" alt="">&lt;/p>
&lt;h3 id="ç›¸æ¯”-b-æ ‘çš„ä¼˜ç‚¹">ç›¸æ¯” B æ ‘çš„ä¼˜ç‚¹&lt;/h3>
&lt;ul>
&lt;li>B+ æ ‘ä¸­æ•°æ®éƒ½å­˜å‚¨åœ¨å¶å­ç»“ç‚¹ä¸Šå¹¶é“¾æ¥åœ¨ä¸€èµ·ï¼Œè¿™ä½¿å¾— B+ æ ‘åœ¨æŸ¥è¯¢èŒƒå›´å†…çš„æ•°æ®æ—¶æ›´åŠ é«˜æ•ˆï¼Œå› ä¸ºå®ƒå¯ä»¥åœ¨ä¸€æ¬¡éå†ä¸­æŸ¥è¯¢å‡ºæ‰€æœ‰ç¬¦åˆæ¡ä»¶çš„æ•°æ®ã€‚&lt;/li>
&lt;li>å…¨è¡¨æ‰«ææ€§èƒ½å¥½ï¼Œè€ŒBæ ‘éœ€è¦å®Œæ•´éå†æ•´æ£µæ ‘ã€‚&lt;/li>
&lt;/ul>
&lt;h2 id="b-link-æ ‘">B-link æ ‘&lt;/h2>
&lt;p>B-link æ ‘æ˜¯åœ¨ B+ æ ‘ä¸Šçš„ä¸€ç§æ”¹è¿›ï¼Œè¯¥ç»“æ„æå‡äº†è¯»å†™å¹¶å‘åº¦ï¼Œèƒ½å¤Ÿä¿æŒé«˜å¹¶å‘ä¸‹çš„æ€§èƒ½ç¨³å®šã€‚PostgreSQL ä¸­ä½¿ç”¨çš„å°±æ˜¯è¿™ä¸­ç´¢å¼•ç»“æ„ã€‚&lt;/p>
&lt;ul>
&lt;li>åœ¨ä¸­é—´ç»“ç‚¹å¢åŠ å­—æ®µ link pointerï¼ŒæŒ‡å‘å³å…„å¼Ÿç»“ç‚¹ï¼ŒB-link Tree çš„åå­—ä¹Ÿç”±æ­¤è€Œæ¥ï¼›&lt;/li>
&lt;li>åœ¨æ¯ä¸ªç»“ç‚¹å†…å¢åŠ ä¸€ä¸ªå­—æ®µ high keyï¼Œåœ¨æŸ¥è¯¢æ—¶å¦‚æœç›®æ ‡å€¼è¶…è¿‡è¯¥èŠ‚ç‚¹çš„ high keyï¼Œå°±éœ€è¦å¾ª
ç€ link pointer ç»§ç»­å¾€åç»§ç»“ç‚¹æŸ¥æ‰¾ã€‚&lt;/li>
&lt;/ul>
&lt;p>&lt;img src="./images/3.png" alt="">&lt;/p>
&lt;h3 id="ä¼˜åŠ¿">ä¼˜åŠ¿&lt;/h3>
&lt;p>æ ‘ç»“æ„è°ƒæ•´æ—¶æ— éœ€å¯¹å…¨å±€æˆ–è€…å±€éƒ¨å­æ ‘åŠ é”ï¼Œè¿›è€Œæœ‰åˆ©äºé«˜å¹¶å‘ä¸‹çš„æ€§èƒ½ç¨³å®šæ€§ã€‚&lt;/p>
&lt;h2 id="å“ˆå¸Œç´¢å¼•hash-index">å“ˆå¸Œç´¢å¼•ï¼ˆHash Indexï¼‰&lt;/h2>
&lt;p>å“ˆå¸Œç´¢å¼•æ˜¯åŸºäºå“ˆå¸Œè¡¨å®ç°çš„ã€‚å¯¹äºæ¯è¡Œæ•°æ®ï¼Œå­˜å‚¨å¼•æ“éƒ½ä¼šå¯¹æ‰€æœ‰çš„ç´¢å¼•åˆ—è®¡ç®—ä¸€ä¸ªå“ˆå¸Œå€¼ï¼Œå“ˆå¸Œå€¼ä¸åŒé”®å€¼çš„è¡Œè®¡ç®—å‡ºæ¥ä¸åŒï¼Œå“ˆå¸Œç´¢å¼•å°†æ‰€æœ‰çš„å“ˆå¸Œå€¼å­˜å‚¨åœ¨ç´¢å¼•ä¸­ï¼ŒåŒæ—¶åœ¨å“ˆå¸Œè¡¨ä¸­ä¿å­˜æŒ‡å‘æ¯ä¸ªæ•°æ®è¡Œçš„æŒ‡é’ˆã€‚&lt;/p>
&lt;p>&lt;img src="./images/4.png" alt="">&lt;/p>
&lt;h2 id="å…¨æ–‡ç´¢å¼•full-text-index">å…¨æ–‡ç´¢å¼•ï¼ˆFull-text Indexï¼‰&lt;/h2>
&lt;p>å…¨æ–‡ç´¢å¼•æ˜¯ä¸€ç§ç‰¹æ®Šçš„ç´¢å¼•ç»“æ„ï¼Œå®ƒä¸»è¦ç”¨äºå¿«é€ŸæŸ¥è¯¢æ–‡æœ¬æ•°æ®ã€‚å…¨æ–‡ç´¢å¼•ä½¿ç”¨çš„æ•°æ®ç»“æ„é€šå¸¸æ˜¯å€’æ’ç´¢å¼•ã€‚å€’æ’ç´¢å¼•æ˜¯ä¸€ç§çº¿æ€§ç»“æ„ï¼Œå®ƒè®°å½•äº†æ¯ä¸ªå•è¯å‡ºç°åœ¨æ–‡æœ¬ä¸­çš„ä½ç½®ã€‚ä½¿ç”¨å€’æ’ç´¢å¼•å¯ä»¥å¿«é€ŸæŸ¥è¯¢å‡ºç¬¦åˆæŸäº›æ–‡æœ¬æ¡ä»¶çš„æ•°æ®ã€‚&lt;/p>
&lt;h2 id="ç©ºé—´ç´¢å¼•spatial-index">ç©ºé—´ç´¢å¼•ï¼ˆSpatial Indexï¼‰&lt;/h2>
&lt;p>éœ€è¦å­˜å‚¨ä¸€äº›åœ°ç†æ•°æ®çš„ä½ç½®æˆ–éœ€è¦å­˜å‚¨å½¢çŠ¶ç›¸å…³çš„æ•°æ®æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ç©ºé—´ç´¢å¼•ã€‚&lt;/p>
&lt;h3 id="r-tree">R-Tree&lt;/h3>
&lt;p>Ræ ‘æ˜¯ç”¨æ¥åšç©ºé—´æ•°æ®å­˜å‚¨çš„æ ‘çŠ¶æ•°æ®ç»“æ„ã€‚ä¾‹å¦‚ç»™åœ°ç†ä½ç½®ï¼ŒçŸ©å½¢å’Œå¤šè¾¹å½¢è¿™ç±»å¤šç»´æ•°æ®åˆ›å»ºç´¢å¼•ã€‚&lt;/p>
&lt;p>&lt;img src="./images/5.png" alt="">&lt;/p>
&lt;h3 id="kd-tree">KD-Tree&lt;/h3>
&lt;p>kd-treeç®€ç§°kç»´æ ‘ï¼Œæ˜¯ä¸€ç§ç©ºé—´åˆ’åˆ†çš„æ•°æ®ç»“æ„ã€‚å¸¸è¢«ç”¨äºé«˜ç»´ç©ºé—´ä¸­çš„æœç´¢ã€‚&lt;/p>
&lt;h3 id="ç½‘æ ¼ç´¢å¼•grid-index">ç½‘æ ¼ç´¢å¼•ï¼ˆGrid Indexï¼‰&lt;/h3>
&lt;p>å¯¹åœ°ç†ç©ºé—´è¿›è¡Œç½‘æ ¼åˆ’åˆ†ï¼Œåˆ’åˆ†æˆå¤§å°ç›¸åŒçš„ç½‘æ ¼ï¼Œæ¯ä¸ªç½‘æ ¼å¯¹åº”ç€ä¸€å—å­˜å‚¨ç©ºé—´ï¼Œç´¢å¼•é¡¹ç™»è®°ä¸Šè½å…¥è¯¥ç½‘æ ¼çš„ç©ºé—´å¯¹è±¡ã€‚&lt;/p></description></item><item><title>ä½¿ç”¨Dockeréƒ¨ç½²openwrtè½¯è·¯ç”±</title><link>https://fffzlfk.github.io/posts/how-to-deploy-soft-router-with-docker/</link><pubDate>Thu, 15 Jun 2023 20:59:46 +0800</pubDate><guid>https://fffzlfk.github.io/posts/how-to-deploy-soft-router-with-docker/</guid><description>&lt;h2 id="å‰æœŸå‡†å¤‡">å‰æœŸå‡†å¤‡&lt;/h2>
&lt;h3 id="æ‹‰å–-docker-image">æ‹‰å– Docker image&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>docker pull registry.cn-shanghai.aliyuncs.com/suling/openwrt:x86_64
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;blockquote>
&lt;p>æ³¨ï¼šè¿™é‡Œçš„é•œåƒ tag ä¸ºæ¶æ„ï¼Œè¿™é‡Œæ˜¯ x86_64ï¼Œå¯ä»¥æ ¹æ®è‡ªå·±çš„æ¶æ„é€‰æ‹©é•œåƒã€‚&lt;/p>&lt;/blockquote>
&lt;h3 id="å¼€å¯ç½‘å¡æ··æ‚æ¨¡å¼">å¼€å¯ç½‘å¡æ··æ‚æ¨¡å¼&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>sudo ip link set eth0 promisc on
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>è¿™é‡Œçš„&lt;code>eth0&lt;/code>ä¿®æ”¹ä¸ºè‡ªå·±çš„ç½‘å¡åç§°ã€‚&lt;/p>
&lt;h3 id="åˆ›å»º-docker-ç½‘ç»œ">åˆ›å»º Docker ç½‘ç»œ&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>docker network create -d macvlan --subnet&lt;span style="color:#f92672">=&lt;/span>192.168.0.0/24 --gateway&lt;span style="color:#f92672">=&lt;/span>192.168.0.1 -o parent&lt;span style="color:#f92672">=&lt;/span>eth0 macnet
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>åŒæ ·çš„ï¼Œè¿™é‡Œçš„&lt;code>subnet&lt;/code>ä¿®æ”¹ä¸ºè‡ªå·±çš„ç½‘æ®µï¼Œ&lt;code>gateway&lt;/code>ä¿®æ”¹ä¸ºå½“å‰ç½‘ç»œå†…çš„ç½‘å…³ã€‚&lt;/p>
&lt;h2 id="éƒ¨ç½²é•œåƒ">éƒ¨ç½²é•œåƒ&lt;/h2>
&lt;h3 id="åˆ›å»ºç½‘ç»œé…ç½®æ–‡ä»¶">åˆ›å»ºç½‘ç»œé…ç½®æ–‡ä»¶&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>vim /path/to/openwrt/network
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>é…ç½®æ–‡ä»¶å¦‚ä¸‹ï¼š&lt;/p>
&lt;pre tabindex="0">&lt;code>config interface &amp;#39;loopback&amp;#39;
 option ifname &amp;#39;lo&amp;#39;
 option proto &amp;#39;static&amp;#39;
 option ipaddr &amp;#39;127.0.0.1&amp;#39;
 option netmask &amp;#39;255.0.0.0&amp;#39;

config globals &amp;#39;globals&amp;#39;
 option packet_steering &amp;#39;1&amp;#39;

config interface &amp;#39;lan&amp;#39;
 option type &amp;#39;bridge&amp;#39;
 option ifname &amp;#39;eth0&amp;#39;
 option proto &amp;#39;static&amp;#39;
 option ipaddr &amp;#39;192.168.0.140&amp;#39;
 option netmask &amp;#39;255.255.255.0&amp;#39;
 option ip6assign &amp;#39;60&amp;#39;
 option gateway &amp;#39;192.168.0.1&amp;#39;
 option broadcast &amp;#39;192.168.0.255&amp;#39;
 option dns &amp;#39;192.168.0.140&amp;#39;

config interface &amp;#39;vpn0&amp;#39;
 option ifname &amp;#39;tun0&amp;#39;
 option proto &amp;#39;none&amp;#39;
&lt;/code>&lt;/pre>&lt;p>æŒ‰ç…§è‡ªå·±çš„æƒ…å†µä¿®æ”¹ &lt;code>config interface lan&lt;/code> ä¸‹çš„ &lt;code>option ipaddr&lt;/code>ã€&lt;code>option netmask&lt;/code>ã€&lt;code>option gateway&lt;/code>ã€&lt;code>option boardcast&lt;/code>å’Œ&lt;code>option dns&lt;/code>ã€‚&lt;/p></description></item><item><title>Are You Sure You Want to Use MMAP in Your Database Management System?[éƒ¨åˆ†ç¿»è¯‘]</title><link>https://fffzlfk.github.io/posts/are-you-sure-you-want-to-use-mmap-in-your-database-management-system_experimental-%E9%83%A8%E5%88%86%E7%BF%BB%E8%AF%91/</link><pubDate>Thu, 15 Dec 2022 13:18:08 +0800</pubDate><guid>https://fffzlfk.github.io/posts/are-you-sure-you-want-to-use-mmap-in-your-database-management-system_experimental-%E9%83%A8%E5%88%86%E7%BF%BB%E8%AF%91/</guid><description>&lt;h2 id="åŸæ–‡">åŸæ–‡&lt;/h2>
&lt;p>&lt;a href="https://db.cs.cmu.edu/mmap-cidr2022/">Are You Sure You Want to Use MMAP in Your Database Management System?&lt;/a>&lt;/p>
&lt;h2 id="4-å®éªŒåˆ†æ">4 å®éªŒåˆ†æ&lt;/h2>
&lt;p>æ­£å¦‚ä¸Šä¸€èŠ‚è§£é‡Šçš„é‚£æ ·ï¼Œä¸€äº›&lt;code>mmap&lt;/code>çš„é—®é¢˜å¯ä»¥é€šè¿‡ä»”ç»†åœ°å®ç°æ¥å…‹æœï¼Œä½†æ˜¯æˆ‘ä»¬è®¤ä¸ºï¼Œå¦‚æœä¸è¿›è¡Œé‡å¤§çš„æ“ä½œç³»ç»Ÿçº§åˆ«çš„é‡å†™ï¼Œå…¶å›ºæœ‰çš„æ€§èƒ½é™åˆ¶å°±æ— æ³•è§£å†³ã€‚åœ¨è¿™ä¸€èŠ‚ï¼Œæˆ‘ä»¬é€šè¿‡å®éªŒç»“æœåˆ†æå±•ç¤ºäº†è¿™äº›é—®é¢˜ã€‚&lt;/p>
&lt;p>æˆ‘ä»¬æ‰€æœ‰çš„å®éªŒåœ¨ä¸€ä¸ªå•å¤„ç†å™¨æ’æ§½çš„æœºå™¨ä¸Šè¿è¡Œï¼Œå…¶é…ç½®ä¿¡æ¯ä¸ºï¼šAMD EPYC 7713 CPU(64 cores, 128 hardware threads)ï¼Œ512GB RAMï¼Œå…¶ä¸­100GBå¯ç”¨äºLinuxï¼ˆv5.11ï¼‰çš„é¡µé¢ç¼“å­˜ï¼Œå¯¹äºæŒä¹…æ€§å­˜å‚¨ï¼Œè¯¥æœºå™¨æœ‰10Ã—3.8TBçš„ ä¸‰æ˜ŸPM1733å›ºæ€ç¡¬ç›˜ï¼ˆé¢å®šè¯»å–é€Ÿåº¦ä¸º7000MB/sï¼Œå†™å…¥é€Ÿåº¦ä¸º3800MB/sï¼‰ï¼Œæˆ‘ä»¬å°†å›ºæ€ç¡¬ç›˜ä½œä¸ºå—è®¾å¤‡æ¥é¿å…æ½œåœ¨çš„æ–‡ä»¶ç³»ç»Ÿå¼€é”€ã€‚&lt;/p>
&lt;p>ä½œä¸ºåŸºå‡†çº¿ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†å­˜å‚¨åŸºå‡†å·¥å…·&lt;code>fio&lt;/code>&lt;sup id="fnref:1">&lt;a href="#fn:1" class="footnote-ref" role="doc-noteref">1&lt;/a>&lt;/sup>ï¼Œä½¿ç”¨ç›´æ¥I/O(&lt;code>O_DIRECT&lt;/code>)æ¥ç»•è¿‡æ“ä½œç³»ç»Ÿé¡µé¢ç¼“å­˜ã€‚æˆ‘ä»¬çš„åˆ†æä¸“é—¨èšç„¦åœ¨åªè¯»å·¥ä½œè´Ÿè½½ä¸Šï¼Œè¿™ä»£è¡¨äº†åŸºäº&lt;code>mmap&lt;/code>çš„DBMSçš„æœ€ä½³æƒ…å†µï¼›å¦åˆ™ï¼Œä»–ä»¬éœ€è¦å®ç°å¤æ‚çš„æ›´æ–°ä¿æŠ¤ï¼ˆ3.1èŠ‚ï¼‰ï¼Œä»è€Œäº§ç”Ÿå¤§é‡çš„é¢å¤–å¼€é”€ã€‚ç‰¹åˆ«çš„æ˜¯ï¼Œæˆ‘ä»¬è¯„ä¼°äº†ä¸¤ç§å¸¸è§çš„è®¿é—®æ¨¡å¼ï¼š(1) éšæœºè®¿é—® å’Œ (2) é¡ºåºè®¿é—®ã€‚&lt;/p>
&lt;h3 id="41-éšæœºè¯»å–">4.1 éšæœºè¯»å–&lt;/h3>
&lt;p>åœ¨ç¬¬ä¸€ä¸ªå®éªŒä¸­ï¼Œæˆ‘ä»¬åœ¨ä¸€å—2TB SSD èŒƒå›´å†…ä½¿ç”¨éšæœºè®¿é—®æ¨¡å¼æ¥æ¨¡æ‹Ÿå¤§äºå†…å­˜çš„OLTPå·¥ä½œè´Ÿè½½ã€‚ç”±äºé¡µé¢ç¼“å­˜åªæœ‰100GBçš„å†…å­˜ï¼Œ95%çš„è®¿é—®éƒ½å¯¼è‡´äº†ç¼ºé¡µä¸­æ–­ï¼ˆå³å·¥ä½œè´Ÿè½½æ˜¯I/Oç»‘å®šçš„ï¼‰ã€‚&lt;/p>
&lt;p>å›¾2aå±•ç¤ºäº†100ä¸ªçº¿ç¨‹æ¯ç§’éšæœºè¯»å–çš„æ•°é‡ã€‚æˆ‘ä»¬çš„&lt;code>fio&lt;/code>åŸºå‡†çº¿è¡¨ç°å‡ºäº†ç¨³å®šçš„æ€§èƒ½ï¼Œè¾¾åˆ°äº†æ¥è¿‘æ¯ç§’90ä¸‡æ¬¡çš„è¯»å–é€Ÿåº¦ï¼Œè¿™ç¬¦åˆ100æ¬¡å‡ºè‰²çš„I/Oæ“ä½œå’Œå¤§çº¦100ğœ‡sçš„NVMeå»¶è¿Ÿçš„é¢„æœŸæ€§èƒ½ã€‚æ¢å¥è¯è¯´ï¼Œè¿™ä¸ªç»“æœè¡¨æ˜ï¼Œ&lt;code>fio&lt;/code>å¯ä»¥ä½¿NVMe SSDçš„æ€§èƒ½å®Œå…¨é¥±å’Œã€‚&lt;/p>
&lt;p>&lt;img src="./images/Figure2.png" alt="">&lt;/p>
&lt;p>å¦ä¸€æ–¹é¢ï¼Œ&lt;code>mmap&lt;/code>è¡¨ç°è¾ƒå·®ï¼Œå³ä½¿æ˜¯ä½¿ç”¨æç¤ºæ¥åŒ¹é…å·¥ä½œè´Ÿè½½è®¿é—®æ¨¡å¼ã€‚æˆ‘ä»¬åœ¨å®éªŒä¸­è§‚å¯Ÿåˆ°&lt;code>MADV_RANDOM&lt;/code>çš„ä¸‰ä¸ªä¸åŒé˜¶æ®µã€‚&lt;code>mmap&lt;/code>åœ¨å¼€å§‹çš„27ç§’å†…ä¸&lt;code>fio&lt;/code>è¡¨ç°æ¥è¿‘ï¼Œç„¶ååœ¨æ¥ä¸‹æ¥çš„5ç§’é’Ÿçªç„¶ä¸‹é™åˆ°æ¥è¿‘0ï¼Œæœ€åæ¢å¤åˆ°&lt;code>fio&lt;/code>æ€§èƒ½çš„ä¸€åŠã€‚è¿™ä¸ªçªç„¶çš„æ€§èƒ½ä¸‹é™å‘ç”Ÿåœ¨é¡µé¢ç¼“å­˜è¢«å¡«æ»¡çš„æ—¶å€™ï¼Œè¿«ä½¿æ“ä½œç³»ç»Ÿå¼€å§‹ä»å†…å­˜æŠŠé¡µé¢ç½®æ¢å‡ºå»ã€‚ä¸å‡ºæ„æ–™åœ°æ˜¯ï¼Œå…¶ä»–è®¿é—®æ¨¡å¼æç¤ºä¸‹æœ‰æ›´ç³Ÿçš„æ€§èƒ½è¡¨ç°ã€‚&lt;/p>
&lt;p>åœ¨3.4èŠ‚ï¼Œæˆ‘ä»¬åˆ—ä¸¾äº†é¡µé¢ç½®æ¢å¼€é”€çš„ä¸‰ä¸ªå…³é”®æ¥æºã€‚ç¬¬ä¸€ä¸ªé—®é¢˜æ˜¯ TLB shootdowns&lt;sup id="fnref:2">&lt;a href="#fn:2" class="footnote-ref" role="doc-noteref">2&lt;/a>&lt;/sup>ï¼Œæˆ‘ä»¬ä½¿ç”¨&lt;code>/usr/interrupts&lt;/code>è®°å½•çš„æƒ…å†µå¦‚å›¾2bæ‰€ç¤ºã€‚å¦‚å‰æ‰€è¿°ï¼ŒTLB shootdownsæ˜¯ååˆ†æ˜‚è´µçš„ï¼ˆéœ€è¦æˆåƒä¸Šä¸‡ä¸ªæ—¶é’Ÿå‘¨æœŸï¼‰ï¼Œå› ä¸ºå®ƒæ¶‰åŠåˆ°å‘é€å¤„ç†å™¨é—´çš„ä¸­æ–­æ¥åˆ·æ–°æ¯ä¸ªæ ¸å¿ƒçš„TLBã€‚ç¬¬äºŒï¼Œæ“ä½œç³»ç»Ÿä½¿ç”¨å•ä¸ªè¿›ç¨‹ï¼ˆ&lt;code>kswapd&lt;/code>ï¼‰æ¥ç½®æ¢é¡µé¢ï¼Œè¿™åœ¨æˆ‘ä»¬å®éªŒä¸­æ˜¯å—CPUé™åˆ¶çš„ã€‚æœ€åï¼Œæ“ä½œç³»ç»Ÿå¿…é¡»åŒæ­¥é¡µè¡¨ï¼Œè¿™åœ¨è®¸å¤šå¹¶å‘çš„çº¿ç¨‹ä¸­å˜å¾—é«˜åº¦æœ‰ç«äº‰æ€§ã€‚&lt;/p>
&lt;h3 id="42-é¡ºåºæ‰«æ">4.2 é¡ºåºæ‰«æ&lt;/h3>
&lt;p>é¡ºåºæ‰«ææ˜¯DBMSçš„å¦ä¸€ç§å¸¸è§çš„è®¿é—®æ¨¡å¼ï¼Œç‰¹åˆ«æ˜¯åœ¨OLAPå·¥ä½œè´Ÿè½½ä¸­ã€‚å› æ­¤ï¼Œæˆ‘ä»¬ä¹Ÿåœ¨2TB SSDèŒƒå›´å†…å¯¹æ¯”äº†&lt;code>fio&lt;/code>å’Œ&lt;code>mmap&lt;/code>çš„æ‰«ææ€§èƒ½ã€‚æˆ‘ä»¬é¦–å…ˆä½¿ç”¨ä»…ä»…ä¸€å—SSDè¿è¡Œäº†æˆ‘ä»¬çš„å®éªŒï¼Œç„¶åæˆ‘ä»¬åœ¨10å—SSDç»„æˆçš„RAID 0ä¸Šé‡æ–°è·‘äº†ç›¸åŒçš„å·¥ä½œè´Ÿè½½ã€‚&lt;/p>
&lt;p>å›¾3å±•ç¤ºäº†&lt;code>fio&lt;/code>å¯ä»¥åˆ©ç”¨ä¸€å—SSDçš„å…¨éƒ¨å¸¦å®½ï¼ŒåŒæ—¶ä¿æŒç¨³å®šçš„æ€§èƒ½ã€‚åƒä¹‹å‰çš„å®éªŒä¸€æ ·ï¼Œ&lt;code>mmap&lt;/code>çš„æ€§èƒ½å¼€å§‹å’Œ&lt;code>fio&lt;/code>ç›¸ä¼¼ï¼Œä½†æˆ‘ä»¬å†æ¬¡è§‚å¯Ÿåˆ°ï¼Œä¸€æ—¦é¡µé¢ç¼“å­˜åœ¨å¤§çº¦17ç§’åè¢«å¡«æ»¡ï¼Œæ€§èƒ½å°±ä¼šæ€¥å‰§ä¸‹é™ã€‚å¦å¤–ï¼Œå’Œè¿™ä¸ªå·¥ä½œè´Ÿè½½é¢„æœŸçš„ä¸€æ ·ï¼Œ&lt;code>MADV_NORMAL&lt;/code>å’Œ&lt;code>MADV_SEQUENTIAL&lt;/code>æ ‡å¿—ä½æ¯”&lt;code>MADV_RANDOM&lt;/code>æ€§èƒ½è¦å¥½ã€‚&lt;/p>
&lt;p>&lt;img src="./images/Figure3.png" alt="">&lt;/p>
&lt;p>å›¾4å±•ç¤ºäº†åœ¨10å—SSDä¸Šé‡å¤é¡ºåºæ‰«æçš„ç»“æœï¼Œè¿›ä¸€æ­¥å‡¸æ˜¾äº†ç°ä»£é—ªå­˜ç†è®ºä¸Šèƒ½å¤Ÿæä¾›çš„ä¸&lt;code>mmap&lt;/code>èƒ½å¤Ÿå®ç°çš„ä¹‹é—´çš„å·®è·ã€‚æˆ‘ä»¬è§‚å¯Ÿåˆ°åœ¨&lt;code>fio&lt;/code>å’Œ&lt;code>mmap&lt;/code>ä¹‹é—´å¤§æ¦‚æœ‰20å€çš„æ€§èƒ½å·®è·ï¼Œä¸ä½¿ç”¨ä¸€å—SSDçš„ç»“æœç›¸æ¯”ï¼Œ&lt;code>mmap&lt;/code>å‡ ä¹æ²¡æœ‰ä»»ä½•æå‡ã€‚&lt;/p>
&lt;p>&lt;img src="./images/Figure4.png" alt="">&lt;/p>
&lt;p>æ€»çš„æ¥è¯´ï¼Œæˆ‘ä»¬å‘ç°&lt;code>mmap&lt;/code>ä»…ä»…åœ¨å•å—SSDä¸Šçš„åˆå§‹åŠ è½½é˜¶æ®µè¡¨ç°å¾—å¥½ã€‚ä¸€æ—¦é¡µé¢ç½®æ¢å¼€å§‹æˆ–è€…ä½¿ç”¨å¤šå—SSDï¼Œ&lt;code>mmap&lt;/code>è¦æ¯”&lt;code>fio&lt;/code>å·®2~20å€ã€‚éšç€PCIe 5.0 NVMeå¾—å³å°†å‘å¸ƒï¼Œé¢„è®¡æ¯å—SSDçš„å¸¦å®½å°†å¢åŠ ä¸€å€ï¼Œæˆ‘ä»¬çš„ç»“æœå±•ç¤ºäº†&lt;code>mmap&lt;/code>ä¸èƒ½å¤Ÿä¸ä¼ ç»Ÿçš„æ–‡ä»¶I/Oçš„é¡ºåºæ‰«æçš„æ€§èƒ½ç›¸åª²ç¾ã€‚&lt;/p>
&lt;h2 id="6-ç»“è®º">6 ç»“è®º&lt;/h2>
&lt;p>æœ¬è®ºæ–‡æå‡ºäº†åå¯¹åœ¨DBMSä¸­ä½¿ç”¨&lt;code>mmap&lt;/code>æ¥è¿›è¡Œæ–‡ä»¶I/Oã€‚å°½ç®¡æœ‰æœ‰é™çš„å¥½å¤„ï¼Œæˆ‘ä»¬è¿˜æ˜¯ä»‹ç»äº†&lt;code>mmap&lt;/code>çš„ä¸»è¦ç¼ºç‚¹ï¼Œæˆ‘ä»¬çš„å®éªŒåˆ†æè¯å®äº†æˆ‘ä»¬åœ¨å…¶æ€§èƒ½é™åˆ¶çš„å‘ç°ã€‚æœ€åï¼Œæˆ‘ä»¬å‘DBMSçš„å¼€å‘è€…æä¾›ä»¥ä¸‹å»ºè®®ã€‚&lt;/p>
&lt;p>ä»€ä¹ˆæ—¶å€™ä½ &lt;strong>ä¸&lt;/strong>åº”è¯¥åœ¨ä½ çš„DBMSä¸­ä½¿ç”¨&lt;code>mmap&lt;/code>ï¼š&lt;/p>
&lt;ul>
&lt;li>ä½ éœ€è¦ä»¥ä¸€ç§äº‹åŠ¡å®‰å…¨çš„æ–¹å¼è¿›è¡Œæ›´æ–°ã€‚&lt;/li>
&lt;li>ä½ æƒ³åœ¨ä¸é˜»å¡æ…¢é€ŸI/Oçš„æƒ…å†µä¸‹å¤„ç†ç¼ºé¡µä¸­æ–­ï¼Œæˆ–è€…éœ€è¦å¯¹å†…å­˜ä¸­çš„æ•°æ®è¿›è¡Œæ˜ç¡®æ§åˆ¶ã€‚&lt;/li>
&lt;li>ä½ å…³å¿ƒé”™è¯¯å¤„ç†ï¼Œéœ€è¦è¿”å›æ­£ç¡®çš„ç»“æœã€‚&lt;/li>
&lt;li>ä½ éœ€è¦åœ¨é«˜é€ŸæŒä¹…æ€§å­˜å‚¨è®¾å¤‡ä¸Šè·å¾—é«˜ååé‡ã€‚&lt;/li>
&lt;/ul>
&lt;p>ä»€ä¹ˆæ—¶å€™ä½ &lt;strong>ä¹Ÿè®¸&lt;/strong>åº”è¯¥ä½¿ç”¨&lt;code>mmap&lt;/code>ï¼š&lt;/p>
&lt;ul>
&lt;li>ä½ çš„å·¥ä½œé›†ï¼ˆæˆ–è€…æ•´ä¸ªæ•°æ®åº“ï¼‰é€‚åˆåœ¨å†…å­˜ä¸­ï¼Œå¹¶ä¸”å·¥ä½œè´Ÿè½½æ˜¯åªè¯»çš„ã€‚&lt;/li>
&lt;li>ä½ éœ€è¦æ€¥äºå°†äº§å“æ¨å‘å¸‚åœºï¼Œè€Œä¸å…³å¿ƒæ•°æ®çš„ä¸€è‡´æ€§æˆ–è€…é•¿æœŸå·¥ç¨‹çš„å¤´ç—›é—®é¢˜ã€‚&lt;/li>
&lt;li>å¦åˆ™ï¼Œæ°¸è¿œä¸è¦ä½¿ç”¨ã€‚&lt;/li>
&lt;/ul>
&lt;div class="footnotes" role="doc-endnotes">
&lt;hr>
&lt;ol>
&lt;li id="fn:1">
&lt;p>&lt;a href="https://github.com/axboe/fio">fio: Flexible I/O Tester.&lt;/a>&amp;#160;&lt;a href="#fnref:1" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/p></description></item><item><title>åå‘ä¼ æ’­</title><link>https://fffzlfk.github.io/posts/%E5%8F%8D%E5%90%91%E4%BC%A0%E6%92%AD/</link><pubDate>Tue, 18 Oct 2022 21:52:39 +0800</pubDate><guid>https://fffzlfk.github.io/posts/%E5%8F%8D%E5%90%91%E4%BC%A0%E6%92%AD/</guid><description>&lt;h2 id="åå‘ä¼ æ’­">åå‘ä¼ æ’­&lt;/h2>
&lt;p>åå‘ä¼ æ’­ï¼ˆè‹±è¯­ï¼šBackpropagationï¼Œæ„ä¸ºè¯¯å·®åå‘ä¼ æ’­ï¼Œç¼©å†™ä¸ºBPï¼‰æ˜¯å¯¹å¤šå±‚äººå·¥ç¥ç»ç½‘ç»œè¿›è¡Œæ¢¯åº¦ä¸‹é™çš„ç®—æ³•ï¼Œä¹Ÿå°±æ˜¯ç”¨é“¾å¼æ³•åˆ™ä»¥ç½‘ç»œæ¯å±‚çš„æƒé‡ä¸ºå˜æ•°è®¡ç®—æŸå¤±å‡½æ•°çš„æ¢¯åº¦ï¼Œä»¥æ›´æ–°æƒé‡æ¥æœ€å°åŒ–æŸå¤±å‡½æ•°ã€‚&lt;/p>
&lt;h2 id="ç®€å•ä¾‹å­è®¡ç®—">ç®€å•ä¾‹å­è®¡ç®—&lt;/h2>
&lt;p>&lt;img src="https://p0.meituan.net/dpplatform/0102258668e345eee83a8459eaa8b95528740.png" alt="">&lt;/p>
&lt;table>
 &lt;thead>
 &lt;tr>
 &lt;th>ç¬¦å·&lt;/th>
 &lt;th>&lt;/th>
 &lt;/tr>
 &lt;/thead>
 &lt;tbody>
 &lt;tr>
 &lt;td>$ w_{ij} $&lt;/td>
 &lt;td>æƒé‡&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>$ z_i $&lt;/td>
 &lt;td>è¾“å…¥&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>$ y_i $&lt;/td>
 &lt;td>è¾“å‡º&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>$ E = \frac{1}{2}(y_p-y_a)^2$&lt;/td>
 &lt;td>æŸå¤±&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>$ f(x) = \frac{1}{1+e^{-x}}$&lt;/td>
 &lt;td>æ¿€æ´»å‡½æ•°&lt;/td>
 &lt;/tr>
 &lt;/tbody>
&lt;/table>
&lt;p>ä¾‹å¦‚æ›´æ–°$w_{53}$&lt;/p>
&lt;p>ä¸»è¦æ€æƒ³å°±æ˜¯æˆ‘ä»¬æ— æ³•æ‰¾åˆ°$E$å’Œ$w_{53}$çš„ç›´æ¥å…³ç³»ï¼Œæ‰€ä»¥ä½¿ç”¨é“¾å¼æ±‚å¯¼æ³•åˆ™æ¥é—´æ¥æ±‚æ¢¯åº¦ï¼š
$$
w_{53}(new) = w_{53}(old) - \Delta w_{53}
$$&lt;/p>
&lt;p>$$
\begin{cases}
E = \frac{1}{2}(y_5-y_a)^2\\
y_5 = f(z_5)\\
z_5 = w_{53} * y_3 + w_{54} * y_4
\end{cases}
$$&lt;/p>
&lt;p>$$
\begin{align}
\Delta w_{53} &amp;amp;= \frac{\partial E}{\partial w_{53}} \\
&amp;amp;= \frac{\partial E}{\partial y_{5}} \frac{\partial y_5}{\partial z_5} \frac{\partial z_5}{\partial w_{53}}
\end{align}
$$&lt;/p></description></item><item><title>ç»„åˆæ•°å­¦ç¬”è®°</title><link>https://fffzlfk.github.io/posts/%E7%BB%84%E5%90%88%E6%95%B0%E5%AD%A6%E7%AC%94%E8%AE%B0/</link><pubDate>Sat, 08 Oct 2022 19:50:03 +0800</pubDate><guid>https://fffzlfk.github.io/posts/%E7%BB%84%E5%90%88%E6%95%B0%E5%AD%A6%E7%AC%94%E8%AE%B0/</guid><description>&lt;h2 id="ç¬¬ä¸€ç« -ç»„åˆæ•°å­¦åŸºç¡€">ç¬¬ä¸€ç«  ç»„åˆæ•°å­¦åŸºç¡€&lt;/h2>
&lt;h3 id="æ’åˆ—">æ’åˆ—&lt;/h3>
&lt;ol>
&lt;li>
&lt;p>ç›¸å¼‚å…ƒç´ ä¸å…è®¸é‡å¤çš„æ’åˆ— $P(n, r)$&lt;/p>
&lt;ul>
&lt;li>çƒç›’æ¨¡å‹ï¼šå°†$r$ ä¸ªæœ‰åŒºåˆ«çš„çƒæ”¾å…¥ $n$ ä¸ªä¸åŒçš„ç›’å­é‡Œï¼Œæ¯ç›’ä¸è¶…è¿‡ä¸€ä¸ªã€‚&lt;/li>
&lt;li>è®¡ç®—å…¬å¼ï¼š$$ P(n, r)=\frac{n!}{(n-r)!} $$&lt;/li>
&lt;li>é›†åˆæè¿°ï¼š$$ S=\{1 \cdot e_1, 1 \cdot e_2,&amp;hellip;,1 \cdot e_n\} $$&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>ç›¸å¼‚å…ƒç´ å…è®¸é‡å¤çš„æ’åˆ— $RP(\infty, r)$&lt;/p>
&lt;ul>
&lt;li>
&lt;p>çƒç›’æ¨¡å‹ï¼šå°†$r$ ä¸ªæœ‰åŒºåˆ«çš„çƒæ”¾å…¥ $n$ ä¸ªä¸åŒçš„ç›’å­é‡Œï¼Œæ¯ä¸ªç›’å­çš„çƒæ•°ä¸åŠ é™åˆ¶è€Œä¸”åŒç›’çš„çƒä¸åˆ†æ¬¡åºã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>è®¡ç®—å…¬å¼ï¼š$$ RP(\infty, r) = n^r $$&lt;/p>
&lt;/li>
&lt;li>
&lt;p>é›†åˆæè¿°ï¼š$$ S=\{\infty \cdot e_1, \infty \cdot e_2,&amp;hellip;,\infty \cdot e_n\} $$&lt;/p>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>ä¸å°½ç›¸å¼‚å…ƒç´ çš„å…¨æ’åˆ—&lt;/p>
&lt;ul>
&lt;li>çƒç›’æ¨¡å‹ï¼šå°†$r$ä¸ªæœ‰åŒºåˆ«çš„çƒæ”¾å…¥$t$ä¸ªä¸åŒçš„ç›’å­ï¼Œæ¯ä¸ªç›’å­çš„å®¹é‡æ˜¯æœ‰é™çš„ï¼Œå…¶ä¸­ç¬¬$i$ä¸ªç›’å­æœ€å¤šåªèƒ½æ”¾å…¥$n_i$ä¸ªçƒï¼ŒåŒç›’çš„çƒä¸åˆ†æ¬¡åºã€‚&lt;/li>
&lt;li>é›†åˆæè¿°ï¼š$$ S=\{ n_1 \cdot e_1, n_2 \cdot e_2,&amp;hellip;,n_t \cdot e_t \}, n_1+n_2+&amp;hellip;+n_t=n $$&lt;/li>
&lt;li>ç‰¹ä¾‹
&lt;ul>
&lt;li>$r=1$ $$ RP(n, 1) = t $$&lt;/li>
&lt;li>$r=n$ $$ RP(n, n) = \frac{n!}{n_1!n_2!&amp;hellip;n_t!} $$&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>ç›¸å¼‚å…ƒç´ ä¸å…è®¸é‡å¤çš„åœ†æ’åˆ— $CP(n, r)$
$$ CP(n, r) = \frac{P(n, r)}{r} = \frac{n!}{r(n-r)!} $$&lt;/p></description></item><item><title>ä½¿ç”¨Rustå®ç°HelangğŸ˜…</title><link>https://fffzlfk.github.io/posts/%E4%BD%BF%E7%94%A8rust%E5%AE%9E%E7%8E%B0helangdoge/</link><pubDate>Fri, 19 Aug 2022 21:44:22 +0800</pubDate><guid>https://fffzlfk.github.io/posts/%E4%BD%BF%E7%94%A8rust%E5%AE%9E%E7%8E%B0helangdoge/</guid><description>&lt;h2 id="å¼•å…¥">å¼•å…¥&lt;/h2>
&lt;p>æœ€è¿‘bç«™ä¸Šå¾ˆå¤šå°ä¼™ä¼´å¯¹ä½•åŒå­¦çš„é”™è¯¯ä»£ç è¿›è¡Œäº†ä¸€äº›å¾ˆæœ‰æ„æ€çš„äºŒåˆ›ï¼Œä¸€åº¦ç™»ä¸Šäº†Github Trendingï¼š&lt;/p>
&lt;p>&lt;img src="https://s1.ax1x.com/2022/08/19/vsZ7DO.png" alt="vsZ7DO.png">&lt;/p>
&lt;hr>
&lt;p>å…¶ä¸­çœ‹åˆ°æœ‰äººä½¿ç”¨C++ä¸­çš„å®å®ç°äº†ä½•åŒå­¦çš„â€œ&lt;del>æˆ–è¿ç®—&lt;/del>â€ï¼Œäºæ˜¯å—åˆ°å¯å‘ï¼Œä½¿ç”¨Rustä¸­çš„å®å®ç°äº†ä¸€ä¸‹ã€‚&lt;/p>
&lt;h2 id="source-code">Source Code&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-rust" data-lang="rust">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">fn&lt;/span> &lt;span style="color:#a6e22e">parse_to_vec&lt;/span>(nums: &lt;span style="color:#66d9ef">&amp;amp;&lt;/span>&lt;span style="color:#66d9ef">str&lt;/span>) -&amp;gt; Vec&lt;span style="color:#f92672">&amp;lt;&lt;/span>&lt;span style="color:#66d9ef">usize&lt;/span>&lt;span style="color:#f92672">&amp;gt;&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">let&lt;/span> nums &lt;span style="color:#f92672">=&lt;/span> nums.replace(&lt;span style="color:#e6db74">&amp;#39; &amp;#39;&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> nums.split(&lt;span style="color:#e6db74">&amp;#39;|&amp;#39;&lt;/span>).map(&lt;span style="color:#f92672">|&lt;/span>x&lt;span style="color:#f92672">|&lt;/span> x.parse().unwrap()).collect()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">fn&lt;/span> &lt;span style="color:#a6e22e">power_con&lt;/span>(powers: &lt;span style="color:#66d9ef">&amp;amp;&lt;/span>&lt;span style="color:#a6e22e">mut&lt;/span> [&lt;span style="color:#66d9ef">u8&lt;/span>], nums: &lt;span style="color:#66d9ef">&amp;amp;&lt;/span>[&lt;span style="color:#66d9ef">usize&lt;/span>], power: &lt;span style="color:#66d9ef">u8&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">for&lt;/span> &lt;span style="color:#f92672">&amp;amp;&lt;/span>num &lt;span style="color:#66d9ef">in&lt;/span> nums {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> powers[num] &lt;span style="color:#f92672">=&lt;/span> power;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#[macro_export]&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>macro_rules&lt;span style="color:#f92672">!&lt;/span> powerCon {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> (&lt;span style="color:#75715e">$powers&lt;/span>: &lt;span style="color:#a6e22e">expr&lt;/span>, &lt;span style="color:#75715e">$nums&lt;/span>: &lt;span style="color:#a6e22e">expr&lt;/span>, &lt;span style="color:#75715e">$force&lt;/span>: &lt;span style="color:#a6e22e">expr&lt;/span>) &lt;span style="color:#f92672">=&amp;gt;&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> power_con(&lt;span style="color:#75715e">$powers&lt;/span>, &lt;span style="color:#f92672">&amp;amp;&lt;/span>parse_to_vec(&lt;span style="color:#a6e22e">stringify!&lt;/span>(&lt;span style="color:#75715e">$nums&lt;/span>)), &lt;span style="color:#75715e">$force&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> };
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">fn&lt;/span> &lt;span style="color:#a6e22e">main&lt;/span>() {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">let&lt;/span> &lt;span style="color:#66d9ef">mut&lt;/span> powers &lt;span style="color:#f92672">=&lt;/span> [&lt;span style="color:#ae81ff">0_&lt;/span>&lt;span style="color:#66d9ef">u8&lt;/span>; &lt;span style="color:#ae81ff">68&lt;/span>];
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">powerCon!&lt;/span>(&lt;span style="color:#f92672">&amp;amp;&lt;/span>&lt;span style="color:#66d9ef">mut&lt;/span> powers, &lt;span style="color:#ae81ff">0&lt;/span>, &lt;span style="color:#ae81ff">100&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">powerCon!&lt;/span>(&lt;span style="color:#f92672">&amp;amp;&lt;/span>&lt;span style="color:#66d9ef">mut&lt;/span> powers, &lt;span style="color:#ae81ff">1&lt;/span> &lt;span style="color:#f92672">|&lt;/span> &lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#f92672">|&lt;/span> &lt;span style="color:#ae81ff">6&lt;/span> &lt;span style="color:#f92672">|&lt;/span> &lt;span style="color:#ae81ff">7&lt;/span> &lt;span style="color:#f92672">|&lt;/span> &lt;span style="color:#ae81ff">11&lt;/span> &lt;span style="color:#f92672">|&lt;/span> &lt;span style="color:#ae81ff">52&lt;/span> &lt;span style="color:#f92672">|&lt;/span> &lt;span style="color:#ae81ff">57&lt;/span> &lt;span style="color:#f92672">|&lt;/span> &lt;span style="color:#ae81ff">58&lt;/span> &lt;span style="color:#f92672">|&lt;/span> &lt;span style="color:#ae81ff">65&lt;/span>, &lt;span style="color:#ae81ff">10&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">println!&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;&lt;/span>&lt;span style="color:#e6db74">{:?}&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&lt;/span>, powers)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="references">References&lt;/h2>
&lt;ul>
&lt;li>
&lt;p>&lt;a href="https://github.com/kifuan/helang/blob/master/helang.cpp">https://github.com/kifuan/helang/blob/master/helang.cpp&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;a href="https://www.bilibili.com/video/BV1zW4y1h7YH?share_source=copy_web&amp;amp;vd_source=083fa967106cc2114fabad75979818b9">https://www.bilibili.com/video/BV1zW4y1h7YH?share_source=copy_web&amp;amp;vd_source=083fa967106cc2114fabad75979818b9&lt;/a>&lt;/p>
&lt;/li>
&lt;/ul></description></item><item><title>Javaæ³›å‹</title><link>https://fffzlfk.github.io/posts/java%E6%B3%9B%E5%9E%8B/</link><pubDate>Thu, 04 Aug 2022 22:33:37 +0800</pubDate><guid>https://fffzlfk.github.io/posts/java%E6%B3%9B%E5%9E%8B/</guid><description>&lt;h2 id="æ“¦æ‹­æ³•">æ“¦æ‹­æ³•&lt;/h2>
&lt;h3 id="ç¼–è¯‘å™¨æŠŠç±»å‹tè§†ä¸ºobject">ç¼–è¯‘å™¨æŠŠç±»å‹&lt;code>&amp;lt;T&amp;gt;&lt;/code>è§†ä¸ºObject&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-java" data-lang="java">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">public&lt;/span> &lt;span style="color:#66d9ef">class&lt;/span> &lt;span style="color:#a6e22e">Pair&lt;/span>&lt;span style="color:#f92672">&amp;lt;&lt;/span>T&lt;span style="color:#f92672">&amp;gt;&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">private&lt;/span> &lt;span style="color:#66d9ef">final&lt;/span> T first;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">private&lt;/span> &lt;span style="color:#66d9ef">final&lt;/span> T last;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">public&lt;/span> &lt;span style="color:#a6e22e">Pair&lt;/span>(T first, T last) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">this&lt;/span>.&lt;span style="color:#a6e22e">first&lt;/span> &lt;span style="color:#f92672">=&lt;/span> first;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">this&lt;/span>.&lt;span style="color:#a6e22e">last&lt;/span> &lt;span style="color:#f92672">=&lt;/span> last;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">public&lt;/span> T &lt;span style="color:#a6e22e">getFirst&lt;/span>() {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> first;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">public&lt;/span> T &lt;span style="color:#a6e22e">getLast&lt;/span>() {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> last;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Javaä¸­æ³›å‹æ˜¯åœ¨ç¼–è¯‘é˜¶æ®µçš„ï¼Œç¼–è¯‘å™¨å°†ä¸Šè¿°ä»£ç ç»è¿‡æ“¦é™¤æ³•ï¼ŒJVMå®é™…çœ‹åˆ°çš„ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-java" data-lang="java">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">public&lt;/span> &lt;span style="color:#66d9ef">class&lt;/span> &lt;span style="color:#a6e22e">Pair&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">private&lt;/span> &lt;span style="color:#66d9ef">final&lt;/span> Object first;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">private&lt;/span> &lt;span style="color:#66d9ef">final&lt;/span> Object last;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">public&lt;/span> &lt;span style="color:#a6e22e">Pair&lt;/span>(Object first, Object last) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">this&lt;/span>.&lt;span style="color:#a6e22e">first&lt;/span> &lt;span style="color:#f92672">=&lt;/span> first;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">this&lt;/span>.&lt;span style="color:#a6e22e">last&lt;/span> &lt;span style="color:#f92672">=&lt;/span> last;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">public&lt;/span> Object &lt;span style="color:#a6e22e">getFirst&lt;/span>() {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> first;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">public&lt;/span> Object &lt;span style="color:#a6e22e">getLast&lt;/span>() {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> last;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="ç¼–è¯‘å™¨æ ¹æ®tå®ç°å®‰å…¨çš„å¼ºåˆ¶è½¬å‹">ç¼–è¯‘å™¨æ ¹æ®&lt;code>&amp;lt;T&amp;gt;&lt;/code>å®ç°å®‰å…¨çš„å¼ºåˆ¶è½¬å‹&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-java" data-lang="java">&lt;span style="display:flex;">&lt;span>Pair&lt;span style="color:#f92672">&amp;lt;&lt;/span>String&lt;span style="color:#f92672">&amp;gt;&lt;/span> p &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">new&lt;/span> Pair&lt;span style="color:#f92672">&amp;lt;&amp;gt;&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;Hello&amp;#34;&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;world&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>String first &lt;span style="color:#f92672">=&lt;/span> p.&lt;span style="color:#a6e22e">getFirst&lt;/span>();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>String last &lt;span style="color:#f92672">=&lt;/span> p.&lt;span style="color:#a6e22e">getLast&lt;/span>();
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ç¼–è¯‘å™¨æ ¹æ®Tçš„ç±»å‹å®‰å…¨å¼ºè½¬ï¼š&lt;/p></description></item><item><title>Cloudflareäº‹æ•…æŠ¥å‘Š(ä¸­æ–‡ç¿»è¯‘)</title><link>https://fffzlfk.github.io/posts/cloudflare_outage_on_june_21_2022chinese/</link><pubDate>Tue, 21 Jun 2022 23:49:57 +0800</pubDate><guid>https://fffzlfk.github.io/posts/cloudflare_outage_on_june_21_2022chinese/</guid><description>Cloudflare outage on June 21, 2022 (Chinese translation)</description></item><item><title>å¯å˜å‚æ•°æ¨¡æ¿çš„åº”ç”¨</title><link>https://fffzlfk.github.io/posts/%E5%8F%AF%E5%8F%98%E5%8F%82%E6%95%B0%E6%A8%A1%E6%9D%BF%E7%9A%84%E5%BA%94%E7%94%A8/</link><pubDate>Sat, 02 Apr 2022 22:20:04 +0800</pubDate><guid>https://fffzlfk.github.io/posts/%E5%8F%AF%E5%8F%98%E5%8F%82%E6%95%B0%E6%A8%A1%E6%9D%BF%E7%9A%84%E5%BA%94%E7%94%A8/</guid><description>&lt;h2 id="å¼•å…¥">å¼•å…¥&lt;/h2>
&lt;p>åœ¨&lt;code>C++&lt;/code>ä¸­ç»å¸¸æ‰“å°å˜é‡æ¥è°ƒè¯•ä»£ç ï¼Œä½†æ— è®ºæ˜¯&lt;code>printf&lt;/code>è¿˜æ˜¯&lt;code>cout&lt;/code>æ€»æ˜¯å¾ˆéº»çƒ¦ï¼š&lt;/p>
&lt;ul>
&lt;li>
&lt;p>&lt;code>printf&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-cpp" data-lang="cpp">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">int&lt;/span> a &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">float&lt;/span> b &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">2.0&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">char&lt;/span> c &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#39;c&amp;#39;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>printf(&lt;span style="color:#e6db74">&amp;#34;a = %d, b = %f, c = %c&amp;#34;&lt;/span>, a, b, c);
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>&lt;code>cout&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-cpp" data-lang="cpp">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">int&lt;/span> a &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">float&lt;/span> b &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">2.0&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">char&lt;/span> c &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#39;c&amp;#39;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>std&lt;span style="color:#f92672">::&lt;/span>cout &lt;span style="color:#f92672">&amp;lt;&amp;lt;&lt;/span> &lt;span style="color:#e6db74">&amp;#34;a = &amp;#34;&lt;/span> &lt;span style="color:#f92672">&amp;lt;&amp;lt;&lt;/span> a &lt;span style="color:#f92672">&amp;lt;&amp;lt;&lt;/span> &lt;span style="color:#e6db74">&amp;#34;, b = &amp;#34;&lt;/span> &lt;span style="color:#f92672">&amp;lt;&amp;lt;&lt;/span> b &lt;span style="color:#f92672">&amp;lt;&amp;lt;&lt;/span> &lt;span style="color:#e6db74">&amp;#34;, c = &amp;#34;&lt;/span> &lt;span style="color:#f92672">&amp;lt;&amp;lt;&lt;/span> c &lt;span style="color:#f92672">&amp;lt;&amp;lt;&lt;/span> &lt;span style="color:#e6db74">&amp;#39;\n&amp;#39;&lt;/span>;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h2 id="å¯å˜å‚æ•°å®">å¯å˜å‚æ•°å®&lt;/h2>
&lt;p>å¯å˜å‚æ•°å®æ˜¯&lt;code>C99&lt;/code>å¼•å…¥çš„ä¸€ä¸ªç‰¹æ€§ï¼Œ&lt;code>C++11&lt;/code>å¼€å§‹æ”¯æŒã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-cpp" data-lang="cpp">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#define def_name(...) def_body(__VA_ARGS__)
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="å¯å˜å‚æ•°æ¨¡æ¿">å¯å˜å‚æ•°æ¨¡æ¿&lt;/h2>
&lt;p>&lt;code>C++11&lt;/code>å…è®¸æ¨¡æ¿å®šä¹‰æœ‰ä»»æ„ç±»å‹ä»»æ„æ•°é‡çš„æ¨¡æ¿å‚æ•°ï¼ˆåŒ…æ‹¬ $0$ ä¸ªæ¨¡æ¿å‚æ•°ï¼‰ã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-cpp" data-lang="cpp">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">template&lt;/span>&lt;span style="color:#f92672">&amp;lt;&lt;/span>&lt;span style="color:#66d9ef">typename&lt;/span>... Values&lt;span style="color:#f92672">&amp;gt;&lt;/span> &lt;span style="color:#66d9ef">class&lt;/span> &lt;span style="color:#a6e22e">tuple&lt;/span>;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>å¦‚æœä¸å¸Œæœ›æœ‰ $0$ ä¸ªæ¨¡æ¿å®å‚ï¼Œå¯ä»¥å¦‚ä¸‹å£°æ˜ï¼š&lt;/p>
&lt;pre tabindex="0">&lt;code>template&amp;lt;typename First, typename... Rest&amp;gt; class tuple;
&lt;/code>&lt;/pre>&lt;p>å¯å˜å‚æ•°æ¨¡æ¿é€‚ç”¨äºå‡½æ•°æ¨¡æ¿ï¼Œä¾‹å¦‚&lt;code>printf&lt;/code>å‡½æ•°çš„å®ç°ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-cpp" data-lang="cpp">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">template&lt;/span>&lt;span style="color:#f92672">&amp;lt;&lt;/span>&lt;span style="color:#66d9ef">typename&lt;/span>... Args&lt;span style="color:#f92672">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">void&lt;/span> printf(&lt;span style="color:#66d9ef">const&lt;/span> std&lt;span style="color:#f92672">::&lt;/span>string &lt;span style="color:#f92672">&amp;amp;&lt;/span>str_format, Args... args);
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="å‚æ•°åŒ…çš„å±•å¼€">å‚æ•°åŒ…çš„å±•å¼€&lt;/h2>
&lt;ul>
&lt;li>å¯¹äºæ¨¡æ¿å‡½æ•°
&lt;ul>
&lt;li>é€’å½’å±•å¼€&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-cpp" data-lang="cpp">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// é€’å½’ç»ˆæ­¢å‡½æ•°
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#66d9ef">void&lt;/span> &lt;span style="color:#a6e22e">print&lt;/span>() {}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">template&lt;/span>&lt;span style="color:#f92672">&amp;lt;&lt;/span>&lt;span style="color:#66d9ef">typename&lt;/span> T, &lt;span style="color:#66d9ef">typename&lt;/span>... Args&lt;span style="color:#f92672">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">void&lt;/span> print(T head, Args... args) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> std&lt;span style="color:#f92672">::&lt;/span>cout &lt;span style="color:#f92672">&amp;lt;&amp;lt;&lt;/span> head &lt;span style="color:#f92672">&amp;lt;&amp;lt;&lt;/span> (&lt;span style="color:#66d9ef">sizeof&lt;/span>...(args) &lt;span style="color:#f92672">&amp;gt;&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span> &lt;span style="color:#f92672">?&lt;/span> &lt;span style="color:#e6db74">&amp;#34;, &amp;#34;&lt;/span> &lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#e6db74">&amp;#34;&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> print(args...);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>é€—å·è¡¨è¾¾å¼å±•å¼€ï¼šè¿™ç§æ–¹å¼æœ‰ç‚¹ç¹çï¼Œä¸å¤ªå¥½ç†è§£ï¼Œä¸æ¨è&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>å¯¹äºæ¨¡æ¿ç±»
&lt;ul>
&lt;li>é€’å½’å±•å¼€&lt;/li>
&lt;li>ç»§æ‰¿å±•å¼€&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h2 id="å®è¿ç®—ç¬¦">å®è¿ç®—ç¬¦&lt;/h2>
&lt;ul>
&lt;li>
&lt;p>&lt;code>#&lt;/code>ï¼šå°†å®å‚æ•°è½¬æ¢ä¸ºå­—ç¬¦ä¸²&lt;/p></description></item><item><title>MapReduce in Go</title><link>https://fffzlfk.github.io/posts/mapreduce_in_go/</link><pubDate>Sun, 27 Mar 2022 21:19:14 +0800</pubDate><guid>https://fffzlfk.github.io/posts/mapreduce_in_go/</guid><description>&lt;h2 id="ç®€å•ç‰ˆgeneric-map">ç®€å•ç‰ˆGeneric Map&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-go" data-lang="go">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">func&lt;/span> &lt;span style="color:#a6e22e">Map&lt;/span>[&lt;span style="color:#a6e22e">T&lt;/span> &lt;span style="color:#66d9ef">any&lt;/span>](&lt;span style="color:#a6e22e">data&lt;/span> []&lt;span style="color:#a6e22e">T&lt;/span>, &lt;span style="color:#a6e22e">f&lt;/span> &lt;span style="color:#66d9ef">func&lt;/span>(&lt;span style="color:#a6e22e">T&lt;/span>) &lt;span style="color:#a6e22e">T&lt;/span>) []&lt;span style="color:#a6e22e">T&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>	&lt;span style="color:#a6e22e">res&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> make([]&lt;span style="color:#a6e22e">T&lt;/span>, len(&lt;span style="color:#a6e22e">data&lt;/span>))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>	&lt;span style="color:#66d9ef">for&lt;/span> &lt;span style="color:#a6e22e">i&lt;/span>, &lt;span style="color:#a6e22e">v&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#66d9ef">range&lt;/span> &lt;span style="color:#a6e22e">data&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>		&lt;span style="color:#a6e22e">res&lt;/span>[&lt;span style="color:#a6e22e">i&lt;/span>] = &lt;span style="color:#a6e22e">f&lt;/span>(&lt;span style="color:#a6e22e">v&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>	}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>	&lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#a6e22e">res&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>æˆ‘ä»¬å¯ä»¥ä¸‹é¢çš„ä»£ç æµ‹è¯•è¿™ä¸ªç®€æ˜“çš„Mapå‡½æ•°&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-go" data-lang="go">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">func&lt;/span> &lt;span style="color:#a6e22e">TestMap&lt;/span>(&lt;span style="color:#a6e22e">t&lt;/span> &lt;span style="color:#f92672">*&lt;/span>&lt;span style="color:#a6e22e">testing&lt;/span>.&lt;span style="color:#a6e22e">T&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>	&lt;span style="color:#a6e22e">square&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#66d9ef">func&lt;/span>(&lt;span style="color:#a6e22e">x&lt;/span> &lt;span style="color:#66d9ef">int&lt;/span>) &lt;span style="color:#66d9ef">int&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>		&lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#a6e22e">x&lt;/span> &lt;span style="color:#f92672">*&lt;/span> &lt;span style="color:#a6e22e">x&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>	}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>	&lt;span style="color:#a6e22e">nums&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> []&lt;span style="color:#66d9ef">int&lt;/span>{&lt;span style="color:#ae81ff">1&lt;/span>, &lt;span style="color:#ae81ff">2&lt;/span>, &lt;span style="color:#ae81ff">3&lt;/span>, &lt;span style="color:#ae81ff">4&lt;/span>, &lt;span style="color:#ae81ff">5&lt;/span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>	&lt;span style="color:#a6e22e">squareArr&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#a6e22e">Map&lt;/span>(&lt;span style="color:#a6e22e">nums&lt;/span>, &lt;span style="color:#a6e22e">square&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>	&lt;span style="color:#66d9ef">for&lt;/span> &lt;span style="color:#a6e22e">i&lt;/span>, &lt;span style="color:#a6e22e">num&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#66d9ef">range&lt;/span> &lt;span style="color:#a6e22e">nums&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>		&lt;span style="color:#66d9ef">if&lt;/span> &lt;span style="color:#a6e22e">squareArr&lt;/span>[&lt;span style="color:#a6e22e">i&lt;/span>] &lt;span style="color:#f92672">!=&lt;/span> &lt;span style="color:#a6e22e">num&lt;/span>&lt;span style="color:#f92672">*&lt;/span>&lt;span style="color:#a6e22e">num&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>			&lt;span style="color:#a6e22e">t&lt;/span>.&lt;span style="color:#a6e22e">Errorf&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;Expected %d, got %d&amp;#34;&lt;/span>, &lt;span style="color:#a6e22e">num&lt;/span>&lt;span style="color:#f92672">*&lt;/span>&lt;span style="color:#a6e22e">num&lt;/span>, &lt;span style="color:#a6e22e">squareArr&lt;/span>[&lt;span style="color:#a6e22e">i&lt;/span>])
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>		}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>	}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>	&lt;span style="color:#a6e22e">upCase&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#66d9ef">func&lt;/span>(&lt;span style="color:#a6e22e">s&lt;/span> &lt;span style="color:#66d9ef">string&lt;/span>) &lt;span style="color:#66d9ef">string&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>		&lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#a6e22e">strings&lt;/span>.&lt;span style="color:#a6e22e">ToUpper&lt;/span>(&lt;span style="color:#a6e22e">s&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>	}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>	&lt;span style="color:#a6e22e">strs&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> []&lt;span style="color:#66d9ef">string&lt;/span>{&lt;span style="color:#e6db74">&amp;#34;abc&amp;#34;&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;def&amp;#34;&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;ghi&amp;#34;&lt;/span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>	&lt;span style="color:#a6e22e">upperStrs&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#a6e22e">Map&lt;/span>(&lt;span style="color:#a6e22e">strs&lt;/span>, &lt;span style="color:#a6e22e">upCase&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>	&lt;span style="color:#66d9ef">for&lt;/span> &lt;span style="color:#a6e22e">i&lt;/span>, &lt;span style="color:#a6e22e">str&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#66d9ef">range&lt;/span> &lt;span style="color:#a6e22e">strs&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>		&lt;span style="color:#66d9ef">if&lt;/span> &lt;span style="color:#a6e22e">upperStrs&lt;/span>[&lt;span style="color:#a6e22e">i&lt;/span>] &lt;span style="color:#f92672">!=&lt;/span> &lt;span style="color:#a6e22e">strings&lt;/span>.&lt;span style="color:#a6e22e">ToUpper&lt;/span>(&lt;span style="color:#a6e22e">str&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>			&lt;span style="color:#a6e22e">t&lt;/span>.&lt;span style="color:#a6e22e">Errorf&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;Expected %s, got %s&amp;#34;&lt;/span>, &lt;span style="color:#a6e22e">strings&lt;/span>.&lt;span style="color:#a6e22e">ToUpper&lt;/span>(&lt;span style="color:#a6e22e">str&lt;/span>), &lt;span style="color:#a6e22e">upperStrs&lt;/span>[&lt;span style="color:#a6e22e">i&lt;/span>])
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>		}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>	}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="ç®€å•ç‰ˆ-generic-reduce">ç®€å•ç‰ˆ Generic Reduce&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-go" data-lang="go">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">func&lt;/span> &lt;span style="color:#a6e22e">Reduce&lt;/span>[&lt;span style="color:#a6e22e">T&lt;/span> &lt;span style="color:#66d9ef">any&lt;/span>](&lt;span style="color:#a6e22e">data&lt;/span> []&lt;span style="color:#a6e22e">T&lt;/span>, &lt;span style="color:#a6e22e">f&lt;/span> &lt;span style="color:#66d9ef">func&lt;/span>(&lt;span style="color:#a6e22e">T&lt;/span>, &lt;span style="color:#a6e22e">T&lt;/span>) &lt;span style="color:#a6e22e">T&lt;/span>) &lt;span style="color:#a6e22e">T&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>	&lt;span style="color:#a6e22e">res&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#a6e22e">data&lt;/span>[&lt;span style="color:#ae81ff">0&lt;/span>]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>	&lt;span style="color:#66d9ef">for&lt;/span> &lt;span style="color:#a6e22e">i&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>; &lt;span style="color:#a6e22e">i&lt;/span> &amp;lt; len(&lt;span style="color:#a6e22e">data&lt;/span>); &lt;span style="color:#a6e22e">i&lt;/span>&lt;span style="color:#f92672">++&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>		&lt;span style="color:#a6e22e">res&lt;/span> = &lt;span style="color:#a6e22e">f&lt;/span>(&lt;span style="color:#a6e22e">res&lt;/span>, &lt;span style="color:#a6e22e">data&lt;/span>[&lt;span style="color:#a6e22e">i&lt;/span>])
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>	}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>	&lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#a6e22e">res&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>æˆ‘ä»¬å¯ä»¥ä¸‹é¢çš„ä»£ç æµ‹è¯•è¿™ä¸ªç®€æ˜“çš„Reduceå‡½æ•°&lt;/p></description></item><item><title>CUDAä¸­æ€æ ·é€‰æ‹©GRIDå’ŒBLOCKç»´åº¦</title><link>https://fffzlfk.github.io/posts/cuda%E4%B8%AD%E6%80%8E%E6%A0%B7%E9%80%89%E6%8B%A9grid%E5%92%8Cblock%E7%BB%B4%E5%BA%A6/</link><pubDate>Mon, 07 Mar 2022 16:10:36 +0800</pubDate><guid>https://fffzlfk.github.io/posts/cuda%E4%B8%AD%E6%80%8E%E6%A0%B7%E9%80%89%E6%8B%A9grid%E5%92%8Cblock%E7%BB%B4%E5%BA%A6/</guid><description>&lt;h2 id="ç¡¬ä»¶é™åˆ¶">ç¡¬ä»¶é™åˆ¶&lt;/h2>
&lt;p>è¿™æ˜¯å®¹æ˜“é‡åŒ–çš„æ–¹é¢ã€‚ç›®å‰&lt;a href="https://www.nvidia.cn/docs/IO/51635/NVIDIA_CUDA_Programming_Guide_1.1_chs.pdf">CUDAç¼–ç¨‹æŒ‡å—&lt;/a>çš„é™„å½•Fåˆ—å‡ºäº†ä¸€äº›ç¡¬ä»¶é™åˆ¶ï¼Œè¿™äº›é™åˆ¶é™åˆ¶äº†å†…æ ¸å¯åŠ¨æ—¶æ¯å—å¯ä»¥æœ‰å¤šå°‘ä¸ªçº¿ç¨‹ã€‚å¦‚æœä½ è¶…è¿‡äº†è¿™äº›é™åˆ¶ï¼Œä½ çš„å†…æ ¸å°†æ— æ³•è¿è¡Œã€‚è¿™äº›é™åˆ¶å¯ä»¥ç²—ç•¥åœ°æ¦‚æ‹¬ä¸ºï¼š&lt;/p>
&lt;ul>
&lt;li>æ¯ä¸ªåŒºå—ä¸èƒ½è¶…è¿‡ $512$ / $1024$ ä¸ªçº¿ç¨‹ï¼ˆåˆ†åˆ«æ˜¯è®¡ç®—èƒ½åŠ›&lt;code>1.x&lt;/code>æˆ–&lt;code>2.x&lt;/code>åŠä»¥åçš„è®¡ç®—èƒ½åŠ›&lt;/li>
&lt;li>æ¯ä¸ªå—çš„æœ€å¤§å°ºå¯¸é™åˆ¶åœ¨ $[512, 512, 64]$ / $[1024, 1024, 64]$ï¼ˆè®¡ç®—èƒ½åŠ›&lt;code>1.x&lt;/code>/&lt;code>2.x&lt;/code>åŠä»¥åçš„è®¡ç®—èƒ½åŠ›&lt;/li>
&lt;li>æ¯ä¸ªå—æ¶ˆè€—çš„å¯„å­˜å™¨æ€»æ•°ä¸èƒ½è¶…è¿‡ $8k/16k/32k/64k/32k/64k/32k/64k$ ï¼ˆè®¡ç®—èƒ½åŠ› $1.0,1.1/1.2,1.3/2.x-3.0/3.2/3.5-5.2/5.3/6-6.1/6.2/7.0$&lt;/li>
&lt;li>æ¯ä¸ªå—ä¸èƒ½æ¶ˆè€—è¶…è¿‡ $16kb/48kb/96kb$ çš„å…±äº«å†…å­˜ï¼ˆè®¡ç®—èƒ½åŠ› $1.x/2.x-6.2/7.0$&lt;/li>
&lt;/ul>
&lt;p>å¦‚æœä½ ä¿æŒåœ¨è¿™äº›é™åˆ¶ä¹‹å†…ï¼Œä»»ä½•ä½ èƒ½æˆåŠŸç¼–è¯‘çš„å†…æ ¸éƒ½ä¼šæ— é”™è¯¯åœ°å¯åŠ¨ã€‚&lt;/p>
&lt;h2 id="æ€§èƒ½è°ƒæ•™">æ€§èƒ½è°ƒæ•™&lt;/h2>
&lt;p>è¿™æ˜¯éœ€è¦ç»éªŒçš„ä¸€éƒ¨åˆ†ã€‚åœ¨ä¸Šè¿°çš„ç¡¬ä»¶çº¦æŸæ¡ä»¶ä¸‹ï¼Œä½ é€‰æ‹©çš„æ¯å—çº¿ç¨‹æ•°å¯ä»¥è€Œä¸”ç¡®å®å½±å“åˆ°ç¡¬ä»¶ä¸Šè¿è¡Œçš„ä»£ç æ€§èƒ½ã€‚æ¯ä¸ªä»£ç çš„è¡¨ç°éƒ½æ˜¯ä¸åŒçš„ï¼Œå”¯ä¸€çœŸæ­£çš„æ–¹æ³•æ˜¯é€šè¿‡ä»”ç»†çš„åŸºå‡†æµ‹è¯•å’Œå‰–ææ¥é‡åŒ–å®ƒã€‚ä½†è¿˜æ˜¯é‚£å¥è¯ï¼Œéå¸¸ç²—ç•¥åœ°æ€»ç»“ä¸€ä¸‹ï¼š&lt;/p>
&lt;ul>
&lt;li>æ¯ä¸ªåŒºå—çš„çº¿ç¨‹æ•°åº”è¯¥æ˜¯&lt;code>wrap&lt;/code>å¤§å°çš„æ•´æ•°å€ï¼Œåœ¨ç›®å‰æ‰€æœ‰çš„ç¡¬ä»¶ä¸Šéƒ½æ˜¯ $32$&lt;/li>
&lt;li>&lt;code>GPU&lt;/code>ä¸Šçš„æ¯ä¸ªæµå¼å¤šå¤„ç†å™¨å¿…é¡»æœ‰è¶³å¤Ÿçš„&lt;code>active wraps&lt;/code>æ¥å……åˆ†éšè—æ¶æ„çš„çš„æ‰€æœ‰ä¸åŒå†…å­˜å’ŒæŒ‡ä»¤æµæ°´çº¿å»¶è¿Ÿï¼Œä»¥å®ç°æœ€å¤§ååé‡ã€‚è¿™é‡Œçš„æ­£ç¡®åšæ³•æ˜¯å°è¯•å®ç°æœ€ä½³çš„ç¡¬ä»¶å ç”¨ç‡&lt;/li>
&lt;/ul>
&lt;h2 id="cudaå†…ç½®å‡½æ•°">CUDAå†…ç½®å‡½æ•°&lt;/h2>
&lt;p>ä¸Šè¿°æŒ‡å‡ºäº†å—çš„å¤§å°æ˜¯å¦‚ä½•å½±å“æ€§èƒ½çš„ï¼Œå¹¶æå‡ºäº†ä¸€ç§åŸºäºå ç”¨ç‡æœ€å¤§åŒ–çš„é€šç”¨å¯å‘å¼é€‰æ‹©æ–¹æ³•ã€‚åœ¨ä¸æƒ³æä¾›é€‰æ‹©å—å¤§å°çš„æ ‡å‡†çš„æƒ…å†µä¸‹ï¼Œå€¼å¾—ä¸€æçš„æ˜¯ï¼Œ&lt;code>CUDA 6.5+&lt;/code>åŒ…æ‹¬å‡ ä¸ªæ–°çš„è¿è¡Œæ—¶å‡½æ•°æ¥å¸®åŠ©å ç”¨ç‡çš„è®¡ç®—å’Œå¯åŠ¨é…ç½®&lt;sup id="fnref:1">&lt;a href="#fn:1" class="footnote-ref" role="doc-noteref">1&lt;/a>&lt;/sup>ã€‚&lt;/p>
&lt;p>å…¶ä¸­ä¸€ä¸ªæœ‰ç”¨çš„å‡½æ•°æ˜¯&lt;code>cudaOccupancyMaxPotentialBlockSize&lt;/code>ï¼Œå®ƒå¯å‘å¼åœ°è®¡ç®—äº†ä¸€ä¸ªèƒ½è¾¾åˆ°æœ€ä½³å ç”¨ç‡çš„å—å¤§å°ã€‚è¯¥å‡½æ•°æä¾›çš„å€¼å¯ä»¥ä½œä¸ºæ‰‹åŠ¨ä¼˜åŒ–å‚æ•°çš„èµ·ç‚¹ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-cpp" data-lang="cpp">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">/************************/&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">/* TEST KERNEL FUNCTION */&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">/************************/&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>__global__ &lt;span style="color:#66d9ef">void&lt;/span> &lt;span style="color:#a6e22e">MyKernel&lt;/span>(&lt;span style="color:#66d9ef">int&lt;/span> &lt;span style="color:#f92672">*&lt;/span>a, &lt;span style="color:#66d9ef">int&lt;/span> &lt;span style="color:#f92672">*&lt;/span>b, &lt;span style="color:#66d9ef">int&lt;/span> &lt;span style="color:#f92672">*&lt;/span>c, &lt;span style="color:#66d9ef">int&lt;/span> N) 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{ 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">int&lt;/span> idx &lt;span style="color:#f92672">=&lt;/span> threadIdx.x &lt;span style="color:#f92672">+&lt;/span> blockIdx.x &lt;span style="color:#f92672">*&lt;/span> blockDim.x; 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> (idx &lt;span style="color:#f92672">&amp;lt;&lt;/span> N) { c[idx] &lt;span style="color:#f92672">=&lt;/span> a[idx] &lt;span style="color:#f92672">+&lt;/span> b[idx]; } 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>} 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">/********/&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">/* MAIN */&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">/********/&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">void&lt;/span> &lt;span style="color:#a6e22e">main&lt;/span>() 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{ 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#66d9ef">int&lt;/span> N &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">1000000&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">int&lt;/span> blockSize; &lt;span style="color:#75715e">// The launch configurator returned block size 
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#66d9ef">int&lt;/span> minGridSize; &lt;span style="color:#75715e">// The minimum grid size needed to achieve the maximum occupancy for a full device launch 
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#66d9ef">int&lt;/span> gridSize; &lt;span style="color:#75715e">// The actual grid size needed, based on input size 
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">int&lt;/span>&lt;span style="color:#f92672">*&lt;/span> h_vec1 &lt;span style="color:#f92672">=&lt;/span> (&lt;span style="color:#66d9ef">int&lt;/span>&lt;span style="color:#f92672">*&lt;/span>) malloc(N&lt;span style="color:#f92672">*&lt;/span>&lt;span style="color:#66d9ef">sizeof&lt;/span>(&lt;span style="color:#66d9ef">int&lt;/span>));
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">int&lt;/span>&lt;span style="color:#f92672">*&lt;/span> h_vec2 &lt;span style="color:#f92672">=&lt;/span> (&lt;span style="color:#66d9ef">int&lt;/span>&lt;span style="color:#f92672">*&lt;/span>) malloc(N&lt;span style="color:#f92672">*&lt;/span>&lt;span style="color:#66d9ef">sizeof&lt;/span>(&lt;span style="color:#66d9ef">int&lt;/span>));
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">int&lt;/span>&lt;span style="color:#f92672">*&lt;/span> h_vec3 &lt;span style="color:#f92672">=&lt;/span> (&lt;span style="color:#66d9ef">int&lt;/span>&lt;span style="color:#f92672">*&lt;/span>) malloc(N&lt;span style="color:#f92672">*&lt;/span>&lt;span style="color:#66d9ef">sizeof&lt;/span>(&lt;span style="color:#66d9ef">int&lt;/span>));
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">int&lt;/span>&lt;span style="color:#f92672">*&lt;/span> h_vec4 &lt;span style="color:#f92672">=&lt;/span> (&lt;span style="color:#66d9ef">int&lt;/span>&lt;span style="color:#f92672">*&lt;/span>) malloc(N&lt;span style="color:#f92672">*&lt;/span>&lt;span style="color:#66d9ef">sizeof&lt;/span>(&lt;span style="color:#66d9ef">int&lt;/span>));
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">int&lt;/span>&lt;span style="color:#f92672">*&lt;/span> d_vec1; cudaMalloc((&lt;span style="color:#66d9ef">void&lt;/span>&lt;span style="color:#f92672">**&lt;/span>)&lt;span style="color:#f92672">&amp;amp;&lt;/span>d_vec1, N&lt;span style="color:#f92672">*&lt;/span>&lt;span style="color:#66d9ef">sizeof&lt;/span>(&lt;span style="color:#66d9ef">int&lt;/span>));
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">int&lt;/span>&lt;span style="color:#f92672">*&lt;/span> d_vec2; cudaMalloc((&lt;span style="color:#66d9ef">void&lt;/span>&lt;span style="color:#f92672">**&lt;/span>)&lt;span style="color:#f92672">&amp;amp;&lt;/span>d_vec2, N&lt;span style="color:#f92672">*&lt;/span>&lt;span style="color:#66d9ef">sizeof&lt;/span>(&lt;span style="color:#66d9ef">int&lt;/span>));
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">int&lt;/span>&lt;span style="color:#f92672">*&lt;/span> d_vec3; cudaMalloc((&lt;span style="color:#66d9ef">void&lt;/span>&lt;span style="color:#f92672">**&lt;/span>)&lt;span style="color:#f92672">&amp;amp;&lt;/span>d_vec3, N&lt;span style="color:#f92672">*&lt;/span>&lt;span style="color:#66d9ef">sizeof&lt;/span>(&lt;span style="color:#66d9ef">int&lt;/span>));
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">for&lt;/span> (&lt;span style="color:#66d9ef">int&lt;/span> i&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>; i&lt;span style="color:#f92672">&amp;lt;&lt;/span>N; i&lt;span style="color:#f92672">++&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> h_vec1[i] &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">10&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> h_vec2[i] &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">20&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> h_vec4[i] &lt;span style="color:#f92672">=&lt;/span> h_vec1[i] &lt;span style="color:#f92672">+&lt;/span> h_vec2[i];
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> cudaMemcpy(d_vec1, h_vec1, N&lt;span style="color:#f92672">*&lt;/span>&lt;span style="color:#66d9ef">sizeof&lt;/span>(&lt;span style="color:#66d9ef">int&lt;/span>), cudaMemcpyHostToDevice);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> cudaMemcpy(d_vec2, h_vec2, N&lt;span style="color:#f92672">*&lt;/span>&lt;span style="color:#66d9ef">sizeof&lt;/span>(&lt;span style="color:#66d9ef">int&lt;/span>), cudaMemcpyHostToDevice);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">float&lt;/span> time;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> cudaEvent_t start, stop;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> cudaEventCreate(&lt;span style="color:#f92672">&amp;amp;&lt;/span>start);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> cudaEventCreate(&lt;span style="color:#f92672">&amp;amp;&lt;/span>stop);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> cudaEventRecord(start, &lt;span style="color:#ae81ff">0&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> cudaOccupancyMaxPotentialBlockSize(&lt;span style="color:#f92672">&amp;amp;&lt;/span>minGridSize, &lt;span style="color:#f92672">&amp;amp;&lt;/span>blockSize, MyKernel, &lt;span style="color:#ae81ff">0&lt;/span>, N); 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// Round up according to array size 
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> gridSize &lt;span style="color:#f92672">=&lt;/span> (N &lt;span style="color:#f92672">+&lt;/span> blockSize &lt;span style="color:#f92672">-&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>) &lt;span style="color:#f92672">/&lt;/span> blockSize; 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> cudaEventRecord(stop, &lt;span style="color:#ae81ff">0&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> cudaEventSynchronize(stop);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> cudaEventElapsedTime(&lt;span style="color:#f92672">&amp;amp;&lt;/span>time, start, stop);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> printf(&lt;span style="color:#e6db74">&amp;#34;Occupancy calculator elapsed time: %3.3f ms &lt;/span>&lt;span style="color:#ae81ff">\n&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&lt;/span>, time);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> cudaEventRecord(start, &lt;span style="color:#ae81ff">0&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> MyKernel&lt;span style="color:#f92672">&amp;lt;&amp;lt;&amp;lt;&lt;/span>gridSize, blockSize&lt;span style="color:#f92672">&amp;gt;&amp;gt;&amp;gt;&lt;/span>(d_vec1, d_vec2, d_vec3, N); 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> cudaEventRecord(stop, &lt;span style="color:#ae81ff">0&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> cudaEventSynchronize(stop);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> cudaEventElapsedTime(&lt;span style="color:#f92672">&amp;amp;&lt;/span>time, start, stop);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> printf(&lt;span style="color:#e6db74">&amp;#34;Kernel elapsed time: %3.3f ms &lt;/span>&lt;span style="color:#ae81ff">\n&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&lt;/span>, time);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> printf(&lt;span style="color:#e6db74">&amp;#34;Blocksize %i&lt;/span>&lt;span style="color:#ae81ff">\n&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&lt;/span>, blockSize);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> cudaMemcpy(h_vec3, d_vec3, N&lt;span style="color:#f92672">*&lt;/span>&lt;span style="color:#66d9ef">sizeof&lt;/span>(&lt;span style="color:#66d9ef">int&lt;/span>), cudaMemcpyDeviceToHost);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">for&lt;/span> (&lt;span style="color:#66d9ef">int&lt;/span> i&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>; i&lt;span style="color:#f92672">&amp;lt;&lt;/span>N; i&lt;span style="color:#f92672">++&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> (h_vec3[i] &lt;span style="color:#f92672">!=&lt;/span> h_vec4[i]) { printf(&lt;span style="color:#e6db74">&amp;#34;Error at i = %i! Host = %i; Device = %i&lt;/span>&lt;span style="color:#ae81ff">\n&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&lt;/span>, i, h_vec4[i], h_vec3[i]); &lt;span style="color:#66d9ef">return&lt;/span>; };
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> printf(&lt;span style="color:#e6db74">&amp;#34;Test passed&lt;/span>&lt;span style="color:#ae81ff">\n&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;code>cudaOccupancyMaxPotentialBlockSize&lt;/code>å®šä¹‰åœ¨&lt;code>cuda_runtime.h&lt;/code>æ–‡ä»¶ä¸­ï¼š&lt;/p></description></item><item><title>å¤šçº¿ç¨‹åŠå…¶æ€§èƒ½åˆ»ç”»</title><link>https://fffzlfk.github.io/posts/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E5%8F%8A%E5%85%B6%E6%80%A7%E8%83%BD%E5%88%BB%E7%94%BB/</link><pubDate>Sun, 27 Feb 2022 23:21:12 +0800</pubDate><guid>https://fffzlfk.github.io/posts/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E5%8F%8A%E5%85%B6%E6%80%A7%E8%83%BD%E5%88%BB%E7%94%BB/</guid><description>&lt;h2 id="ä½¿ç”¨å¤šçº¿ç¨‹æé«˜å¹¶è¡Œæ€§">ä½¿ç”¨å¤šçº¿ç¨‹æé«˜å¹¶è¡Œæ€§&lt;/h2>
&lt;h3 id="åŒæ­¥çš„ä»£ä»·">åŒæ­¥çš„ä»£ä»·&lt;/h3>
&lt;p>æˆ‘ä»¬ç ”ç©¶å¯¹ä¸€åˆ—æ•´æ•° $0, &amp;hellip;, n - 1$ æ±‚å’Œï¼Œæˆ‘ä»¬å°†åºåˆ—åˆ’åˆ†æˆ $t$ ä¸ªä¸ç›¸äº¤çš„çš„åŒºåŸŸï¼Œç»™ $t$ ä¸ªçº¿ç¨‹æ¯ä¸ªåˆ†é…ä¸€ä¸ªåŒºåŸŸã€‚å°†çº¿ç¨‹çš„å’Œæ”¾å…¥ä¸€ä¸ªå˜é‡ä¸­ï¼Œå¹¶ä¸”æˆ‘ä»¬ä½¿ç”¨äº’æ–¥é”æ¥ä¿æŠ¤è¿™ä¸ªå˜é‡ã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-rust" data-lang="rust">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">use&lt;/span> std::{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> sync::{Arc, Mutex},
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> thread,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> time::Instant,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>};
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">fn&lt;/span> &lt;span style="color:#a6e22e">main&lt;/span>() {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">let&lt;/span> args &lt;span style="color:#f92672">=&lt;/span> std::env::args().collect::&lt;span style="color:#f92672">&amp;lt;&lt;/span>Vec&lt;span style="color:#f92672">&amp;lt;&lt;/span>String&lt;span style="color:#f92672">&amp;gt;&amp;gt;&lt;/span>();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> args.len() &lt;span style="color:#f92672">!=&lt;/span> &lt;span style="color:#ae81ff">3&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">panic!&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;Usage: &lt;/span>&lt;span style="color:#e6db74">{}&lt;/span>&lt;span style="color:#e6db74"> &amp;lt;nthreads&amp;gt; &amp;lt;log_nelems&amp;gt;&amp;#34;&lt;/span>, args[&lt;span style="color:#ae81ff">0&lt;/span>]);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">let&lt;/span> nthreads: &lt;span style="color:#66d9ef">usize&lt;/span> &lt;span style="color:#f92672">=&lt;/span> args[&lt;span style="color:#ae81ff">1&lt;/span>].parse().unwrap();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">let&lt;/span> log_nelems: &lt;span style="color:#66d9ef">usize&lt;/span> &lt;span style="color:#f92672">=&lt;/span> args[&lt;span style="color:#ae81ff">2&lt;/span>].parse().unwrap();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">let&lt;/span> nelems &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">1_&lt;/span>&lt;span style="color:#66d9ef">usize&lt;/span> &lt;span style="color:#f92672">&amp;lt;&amp;lt;&lt;/span> log_nelems;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">let&lt;/span> nelems_per_thread &lt;span style="color:#f92672">=&lt;/span> nelems &lt;span style="color:#f92672">/&lt;/span> nthreads;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">let&lt;/span> gsum &lt;span style="color:#f92672">=&lt;/span> Arc::new(Mutex::new(&lt;span style="color:#ae81ff">0&lt;/span>));
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">let&lt;/span> now &lt;span style="color:#f92672">=&lt;/span> Instant::now();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">let&lt;/span> &lt;span style="color:#66d9ef">mut&lt;/span> handlers &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">vec!&lt;/span>[];
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">for&lt;/span> i &lt;span style="color:#66d9ef">in&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#f92672">..&lt;/span>nthreads {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">let&lt;/span> gsum &lt;span style="color:#f92672">=&lt;/span> Arc::clone(&lt;span style="color:#f92672">&amp;amp;&lt;/span>gsum);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">let&lt;/span> handler &lt;span style="color:#f92672">=&lt;/span> thread::spawn(&lt;span style="color:#66d9ef">move&lt;/span> &lt;span style="color:#f92672">||&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">let&lt;/span> start &lt;span style="color:#f92672">=&lt;/span> i &lt;span style="color:#f92672">*&lt;/span> nelems_per_thread;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">let&lt;/span> end &lt;span style="color:#f92672">=&lt;/span> start &lt;span style="color:#f92672">+&lt;/span> nelems_per_thread;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">for&lt;/span> j &lt;span style="color:#66d9ef">in&lt;/span> start&lt;span style="color:#f92672">..&lt;/span>end {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">let&lt;/span> &lt;span style="color:#66d9ef">mut&lt;/span> sum &lt;span style="color:#f92672">=&lt;/span> gsum.lock().unwrap();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">*&lt;/span>sum &lt;span style="color:#f92672">+=&lt;/span> j;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> });
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> handlers.push(handler);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">for&lt;/span> handle &lt;span style="color:#66d9ef">in&lt;/span> handlers {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> handle.join().unwrap();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">assert_eq!&lt;/span>(nelems &lt;span style="color:#f92672">*&lt;/span> (nelems &lt;span style="color:#f92672">-&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>) &lt;span style="color:#f92672">/&lt;/span> &lt;span style="color:#ae81ff">2&lt;/span>, &lt;span style="color:#f92672">*&lt;/span>gsum.lock().unwrap());
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">println!&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;Running took &lt;/span>&lt;span style="color:#e6db74">{}&lt;/span>&lt;span style="color:#e6db74"> s.&amp;#34;&lt;/span>, now.elapsed().as_secs())
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>æˆ‘ä»¬åœ¨ä¸€ä¸ªå››æ ¸ç³»ç»Ÿä¸Šï¼Œå¯¹ä¸€ä¸ªå¤§å°ä¸º $n=2^{20}$ çš„åºåˆ—è¿›è¡Œæµ‹è¯•ï¼Œè¿ç®—æ—¶é—´ä»¥æ¯«ç§’ä¸ºå•ä½ï¼Œç»“æœå¦‚ä¸‹ï¼š&lt;/p></description></item><item><title>C++ä¸­å®¹æ˜“çŠ¯çš„é”™è¯¯</title><link>https://fffzlfk.github.io/posts/c++%E4%B8%AD%E5%AE%B9%E6%98%93%E7%8A%AF%E7%9A%84%E9%94%99%E8%AF%AF/</link><pubDate>Wed, 23 Feb 2022 23:31:50 +0800</pubDate><guid>https://fffzlfk.github.io/posts/c++%E4%B8%AD%E5%AE%B9%E6%98%93%E7%8A%AF%E7%9A%84%E9%94%99%E8%AF%AF/</guid><description>&lt;h2 id="ä¸æ­£ç¡®åœ°ä½¿ç”¨newå’Œdelete">ä¸æ­£ç¡®åœ°ä½¿ç”¨&lt;code>new&lt;/code>å’Œ&lt;code>delete&lt;/code>&lt;/h2>
&lt;p>æ— è®ºæˆ‘ä»¬å¦‚ä½•åŠªåŠ›ï¼Œè¦é‡Šæ”¾æ‰€æœ‰åŠ¨æ€åˆ†é…çš„å†…å­˜æ˜¯éå¸¸å›°éš¾çš„ã€‚å³ä½¿æˆ‘ä»¬èƒ½åšåˆ°è¿™ä¸€ç‚¹ï¼Œä¹Ÿå¾€å¾€ä¸èƒ½å®‰å…¨åœ°é¿å…å‡ºç°å¼‚å¸¸ã€‚è®©æˆ‘ä»¬çœ‹ä¸€ä¸ªç®€å•çš„ä¾‹å­ã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-cpp" data-lang="cpp">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">void&lt;/span> &lt;span style="color:#a6e22e">SomeMethod&lt;/span>() {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ClassA &lt;span style="color:#f92672">*&lt;/span>a &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">new&lt;/span> ClassA;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> SomeOtherMethod(); &lt;span style="color:#75715e">// it can throws an execption
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#66d9ef">delete&lt;/span> a;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>å¦‚æœ&lt;code>SomeOtherMethod&lt;/code>æŠ›å‡ºäº†å¼‚å¸¸ï¼Œé‚£ä¹ˆ&lt;code>a&lt;/code>å¯¹è±¡æ°¸è¿œä¸ä¼šè¢«åˆ é™¤ã€‚ä¸‹é¢çš„ä¾‹å­å±•ç¤ºäº†ä¸€ä¸ªæ›´åŠ å®‰å…¨åŒæ—¶åˆæ›´ç®€æ´çš„å®ç°ï¼Œä½¿ç”¨äº†åœ¨&lt;code>C++11&lt;/code>æå‡ºçš„&lt;code>std::unique_ptr&lt;/code>ã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-cpp" data-lang="cpp">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">void&lt;/span> &lt;span style="color:#a6e22e">SomeMethod&lt;/span>() {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> std&lt;span style="color:#f92672">::&lt;/span>unique_ptr&lt;span style="color:#f92672">&amp;lt;&lt;/span>ClassA&lt;span style="color:#f92672">&amp;gt;&lt;/span> a(&lt;span style="color:#66d9ef">new&lt;/span> ClassA);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> SomeOtherMethod();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>æ— è®ºå‘ç”Ÿä»€ä¹ˆï¼Œå½“&lt;code>a&lt;/code>é€€å‡ºä½œç”¨åŸŸçš„æ—¶å€™ï¼Œå®ƒä¼šè¢«é‡Šæ”¾ã€‚&lt;/p>
&lt;p>ç„¶è€Œï¼Œè¿™ä»…ä»…æ˜¯&lt;code>C++&lt;/code>ä¸­è¿™ç§é”™è¯¯æœ€ç®€å•çš„ä¾‹å­ï¼Œè¿˜æœ‰å¾ˆå¤šä¾‹å­è¡¨æ˜&lt;code>delete&lt;/code>åº”è¯¥åœ¨å…¶ä»–åœ°æ–¹è°ƒç”¨ï¼Œä¹Ÿè®¸æ˜¯åœ¨å¤–å±‚å‡½æ•°æˆ–è€…å¦ä¸€ä¸ªçº¿ç¨‹ä¸­ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆåº”è¯¥é¿å…ä½¿ç”¨&lt;code>new&lt;/code>å’Œ&lt;code>delete&lt;/code>ï¼Œè€Œåº”è¯¥ä½¿ç”¨é€‚å½“çš„æ™ºèƒ½æŒ‡é’ˆã€‚&lt;/p>
&lt;h2 id="è¢«å¿˜è®°çš„è™šææ„å‡½æ•°">è¢«å¿˜è®°çš„è™šææ„å‡½æ•°&lt;/h2>
&lt;p>è¿™æ˜¯æœ€å¸¸è§çš„é”™è¯¯ä¹‹ä¸€ï¼Œå¦‚æœæ´¾ç”Ÿç±»ä¸­æœ‰åŠ¨æ€å†…å­˜åˆ†é…ï¼Œå°†ä¼šå¯¼è‡´æ´¾ç”Ÿç±»çš„å†…å­˜æ³„æ¼ã€‚è¿™é‡Œæœ‰ä¸€äº›ä¾‹å­ï¼Œå½“ä¸€ä¸ªç±»ä¸æ‰“ç®—ç”¨äºç»§æ‰¿ï¼Œå¹¶ä¸”å®ƒçš„å¤§å°å’Œæ€§èƒ½æ˜¯è‡³å…³é‡è¦çš„ã€‚è™šææ„å‡½æ•°æˆ–ä»»ä½•å…¶ä»–è™šå‡½æ•°åœ¨ç±»åœ¨ç±»ä¸­å¼•å…¥äº†é¢å¤–çš„æ•°æ®ï¼Œå³æŒ‡å‘è™šå‡½æ•°è¡¨çš„æŒ‡é’ˆï¼Œè¿™ä½¿å¾—ç±»çš„ä»»ä½•å®ä¾‹çš„å¤§å°å˜å¤§ã€‚&lt;/p>
&lt;p>ç„¶è€Œï¼Œåœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œç±»å¯ä»¥è¢«ç»§æ‰¿ï¼Œå³ä½¿å®ƒçš„åˆè¡·å¹¶éå¦‚æ­¤ã€‚å› æ­¤ï¼Œåœ¨å£°æ˜ä¸€ä¸ªç±»çš„æ—¶å€™ï¼Œæ·»åŠ ä¸€ä¸ªè™šææ„å‡½æ•°æ˜¯ä¸€ä¸ªéå¸¸å¥½çš„åšæ³•ã€‚å¦åˆ™ï¼Œå¦‚æœä¸€ä¸ªç±»ç”±äºæ€§èƒ½çš„åŸå› å¿…é¡»ä¸åŒ…å«è™šå‡½æ•°ï¼Œé‚£ä¹ˆåœ¨ç±»çš„å£°æ˜æ–‡ä»¶é‡Œé¢åŠ ä¸Šä¸€ä¸ªæ³¨é‡Šï¼Œè¯´æ˜è¿™ä¸ªç±»ä¸åº”è¯¥è¢«ç»§æ‰¿ï¼Œæ˜¯ä¸€ä¸ªå¾ˆå¥½çš„åšæ³•ã€‚é¿å…è¿™ä¸ªé—®é¢˜çš„æœ€ä½³é€‰æ‹©ä¹‹ä¸€æ˜¯ä½¿ç”¨ä¸€ä¸ªæ”¯æŒåœ¨åˆ›å»ºç±»æ—¶åˆ›å»ºè™šææ„å‡½æ•°çš„&lt;code>IDE&lt;/code>ã€‚&lt;/p>
&lt;p>å…³äºè¿™ä¸ªé—®é¢˜ï¼Œè¿˜æœ‰ä¸€ç‚¹æ˜¯æ¥è‡ªæ ‡å‡†åº“çš„ç±»æˆ–æ¨¡æ¿ã€‚å®ƒä»¬ä¸æ˜¯ç”¨æ¥ç»§æ‰¿çš„ï¼Œä¹Ÿæ²¡æœ‰ä¸€ä¸ªè™šææ„å‡½æ•°ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªå…¬å¼€ç»§æ‰¿è‡ª&lt;code>std::string&lt;/code>çš„æ–°çš„å¢å¼ºå­—ç¬¦ä¸²ç±»ï¼Œå°±å¯èƒ½æœ‰äººé”™è¯¯åœ°ä½¿ç”¨å®ƒä¸&lt;code>std::string&lt;/code>çš„æŒ‡é’ˆæˆ–å¼•ç”¨ï¼Œä»è€Œå¯¼è‡´å†…å­˜æ³„æ¼ã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-cpp" data-lang="cpp">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">class&lt;/span> &lt;span style="color:#a6e22e">MyString&lt;/span> &lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#66d9ef">public&lt;/span> std&lt;span style="color:#f92672">::&lt;/span>string {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">~&lt;/span>MyString() {}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>};
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">int&lt;/span> &lt;span style="color:#a6e22e">main&lt;/span>() {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> std&lt;span style="color:#f92672">::&lt;/span>string &lt;span style="color:#f92672">*&lt;/span>s &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">new&lt;/span> MyString();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>	&lt;span style="color:#66d9ef">delete&lt;/span> s; &lt;span style="color:#75715e">// May not invoke the destructor defined in MyString
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ä¸ºäº†é¿å…è¿™æ ·çš„é—®é¢˜ï¼Œé‡ç”¨æ ‡å‡†åº“ä¸­çš„ç±»æˆ–æ¨¡æ¿çš„ä¸€ä¸ªæ›´å®‰å…¨çš„æ–¹æ³•æ˜¯ä½¿ç”¨ç§æœ‰ç»§æ‰¿&lt;sup id="fnref:1">&lt;a href="#fn:1" class="footnote-ref" role="doc-noteref">1&lt;/a>&lt;/sup>æˆ–ç»„åˆã€‚&lt;/p>
&lt;h2 id="ç”¨deleteæˆ–æ™ºèƒ½æŒ‡é’ˆåˆ é™¤ä¸€ä¸ªæ•°ç»„">ç”¨&lt;code>delete&lt;/code>æˆ–æ™ºèƒ½æŒ‡é’ˆåˆ é™¤ä¸€ä¸ªæ•°ç»„&lt;/h2>
&lt;p>åˆ›å»ºåŠ¨æ€å¤§å°çš„ä¸´æ—¶æ•°ç»„å¾€å¾€æ˜¯å¿…è¦çš„ã€‚å½“å®ƒä»¬ä¸å†éœ€è¦æ—¶ï¼Œé‡Šæ”¾åˆ†é…çš„å†…å­˜æ˜¯å¾ˆé‡è¦çš„ã€‚è¿™é‡Œçš„é—®é¢˜æ˜¯ï¼Œ&lt;code>C++&lt;/code>éœ€è¦å¸¦æœ‰&lt;code>[]&lt;/code>æ‹¬å·çš„ç‰¹æ®Šåˆ é™¤æ“ä½œç¬¦ï¼Œè¿™ä¸€ç‚¹å¾ˆå®¹æ˜“è¢«é—å¿˜ã€‚&lt;code>delete[]&lt;/code>æ“ä½œç¬¦ä¸ä»…ä¼šåˆ é™¤åˆ†é…ç»™æ•°ç»„çš„å†…å­˜ï¼Œè€Œä¸”ä¼šé¦–å…ˆè°ƒç”¨æ•°ç»„ä¸­æ‰€æœ‰å¯¹è±¡çš„ææ„å‡½æ•°ã€‚å¯¹åŸå§‹ç±»å‹ä½¿ç”¨ä¸å¸¦&lt;code>[]&lt;/code>æ‹¬å·çš„åˆ é™¤æ“ä½œç¬¦ä¹Ÿæ˜¯ä¸æ­£ç¡®çš„ï¼Œå°½ç®¡è¿™äº›ç±»å‹æ²¡æœ‰ææ„å‡½æ•°ï¼Œæ¯ä¸ªç¼–è¯‘å™¨éƒ½ä¸èƒ½ä¿è¯ä¸€ä¸ªæ•°ç»„çš„æŒ‡é’ˆä¼šæŒ‡å‘æ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œæ‰€ä»¥ä½¿ç”¨ä¸å¸¦&lt;code>[]&lt;/code>æ‹¬å·çš„&lt;code>delete&lt;/code>ä¹Ÿä¼šå¯¼è‡´æœªå®šä¹‰çš„è¡Œä¸ºã€‚&lt;/p>
&lt;p>åœ¨æ•°ç»„ä¸­ä½¿ç”¨æ™ºèƒ½æŒ‡é’ˆï¼Œå¦‚&lt;code>unique_ptr&amp;lt;T&amp;gt;&lt;/code>, &lt;code>shared_ptr&lt;/code>ï¼Œä¹Ÿæ˜¯ä¸æ­£ç¡®çš„ã€‚å½“è¿™æ ·çš„æ™ºèƒ½æŒ‡é’ˆä»ä½œç”¨åŸŸä¸­é€€å‡ºæ—¶ï¼Œå®ƒå°†è°ƒç”¨ä¸å¸¦&lt;code>[]&lt;/code>æ‹¬å·çš„åˆ é™¤æ“ä½œç¬¦ï¼Œè¿™å°†å¯¼è‡´ä¸Šé¢æè¿°çš„åŒæ ·é—®é¢˜ã€‚å¦‚æœéœ€è¦å¯¹æ•°ç»„ä½¿ç”¨æ™ºèƒ½æŒ‡é’ˆï¼Œå¯ä»¥ä½¿ç”¨&lt;code>unique_ptr&amp;lt;T[]&amp;gt;&lt;/code>çš„ç‰¹æ®ŠåŒ–ã€‚&lt;/p>
&lt;p>å¦‚æœä¸éœ€è¦å¼•ç”¨è®¡æ•°çš„åŠŸèƒ½ï¼Œä¸»è¦æ˜¯æ•°ç»„çš„æƒ…å†µï¼Œæœ€ä¼˜é›…çš„æ–¹æ³•æ˜¯ä½¿ç”¨&lt;code>STL&lt;/code>å‘é‡æ¥ä»£æ›¿ã€‚å®ƒä»¬ä¸åªæ˜¯è´Ÿè´£é‡Šæ”¾å†…å­˜ï¼Œè€Œä¸”è¿˜æä¾›é¢å¤–çš„åŠŸèƒ½ã€‚&lt;/p>
&lt;h2 id="è¿”å›ä¸€ä¸ªå±€éƒ¨å¯¹è±¡çš„å¼•ç”¨">è¿”å›ä¸€ä¸ªå±€éƒ¨å¯¹è±¡çš„å¼•ç”¨&lt;/h2>
&lt;p>è¿™ä¸»è¦æ˜¯ä¸€ä¸ªåˆå­¦è€…çš„é”™è¯¯ï¼Œä½†å®ƒå€¼å¾—ä¸€æï¼Œå› ä¸ºæœ‰å¾ˆå¤šé—ç•™çš„ä»£ç éƒ½å­˜åœ¨è¿™ä¸ªé—®é¢˜ã€‚è®©æˆ‘ä»¬çœ‹çœ‹ä¸‹é¢çš„ä»£ç ï¼Œä¸€ä¸ªç¨‹åºå‘˜æƒ³é€šè¿‡é¿å…ä¸å¿…è¦çš„å¤åˆ¶æ¥è¿›è¡ŒæŸç§ä¼˜åŒ–ã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-cpp" data-lang="cpp">&lt;span style="display:flex;">&lt;span>Complex&lt;span style="color:#f92672">&amp;amp;&lt;/span> SumComplex(&lt;span style="color:#66d9ef">const&lt;/span> Complex&lt;span style="color:#f92672">&amp;amp;&lt;/span> a, &lt;span style="color:#66d9ef">const&lt;/span> Complex&lt;span style="color:#f92672">&amp;amp;&lt;/span> b) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Complex result;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#960050;background-color:#1e0010">â€¦&lt;/span>..
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> result;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Complex&lt;span style="color:#f92672">&amp;amp;&lt;/span> sum &lt;span style="color:#f92672">=&lt;/span> SumComplex(a, b);
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>å¯¹è±¡ &lt;code>sum&lt;/code>ç°åœ¨å°†æŒ‡å‘å±€éƒ¨å¯¹è±¡&lt;code>result&lt;/code>ã€‚ä½†æ˜¯ï¼Œåœ¨æ‰§è¡Œ&lt;code>SumComplex&lt;/code>å‡½æ•°åï¼Œå¯¹è±¡&lt;code>result&lt;/code>ä½äºå“ªé‡Œå‘¢ï¼Ÿä¸çŸ¥é“ã€‚å®ƒä½äºå †æ ˆä¸­ï¼Œä½†åœ¨å‡½æ•°è¿”å›åï¼Œå †æ ˆè¢«æ”¶ç¼©ï¼Œå‡½æ•°ä¸­çš„æ‰€æœ‰æœ¬åœ°å¯¹è±¡éƒ½è¢«ææ„äº†ã€‚è¿™æœ€ç»ˆä¼šå¯¼è‡´ä¸€ä¸ªæœªå®šä¹‰çš„è¡Œä¸ºï¼Œå³ä½¿æ˜¯åŸå§‹ç±»å‹ã€‚ä¸ºäº†é¿å…æ€§èƒ½é—®é¢˜ï¼Œæœ‰æ—¶å¯ä»¥ä½¿ç”¨è¿”å›å€¼ä¼˜åŒ–ã€‚&lt;/p></description></item><item><title>C++ å®Œç¾è½¬å‘</title><link>https://fffzlfk.github.io/posts/c++_%E5%AE%8C%E7%BE%8E%E8%BD%AC%E5%8F%91/</link><pubDate>Sat, 05 Feb 2022 14:10:47 +0800</pubDate><guid>https://fffzlfk.github.io/posts/c++_%E5%AE%8C%E7%BE%8E%E8%BD%AC%E5%8F%91/</guid><description>&lt;h2 id="ä¸ºä»€ä¹ˆè¦æœ‰å®Œç¾è½¬å‘">ä¸ºä»€ä¹ˆè¦æœ‰å®Œç¾è½¬å‘&lt;/h2>
&lt;p>ä¸‹é¢æ˜¯ä¸€ä¸ªç±»å·¥å‚å‡½æ•°ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-cpp" data-lang="cpp">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">template&lt;/span> &lt;span style="color:#f92672">&amp;lt;&lt;/span>&lt;span style="color:#66d9ef">typename&lt;/span> T, &lt;span style="color:#66d9ef">typename&lt;/span> Arg&lt;span style="color:#f92672">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>std&lt;span style="color:#f92672">::&lt;/span>shared_ptr&lt;span style="color:#f92672">&amp;lt;&lt;/span>T&lt;span style="color:#f92672">&amp;gt;&lt;/span> factory(Arg arg) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> std&lt;span style="color:#f92672">::&lt;/span>shared_ptr&lt;span style="color:#f92672">&amp;lt;&lt;/span>T&lt;span style="color:#f92672">&amp;gt;&lt;/span>( &lt;span style="color:#66d9ef">new&lt;/span> T(arg));
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>å‚æ•°å¯¹è±¡&lt;code>arg&lt;/code>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­æ˜¯ä¼ å€¼æ–¹å¼ä¼ é€’ï¼Œè¿™å¸¦æ¥äº†ç”Ÿæˆé¢å¤–ä¸´æ—¶å¯¹è±¡&lt;sup id="fnref:1">&lt;a href="#fn:1" class="footnote-ref" role="doc-noteref">1&lt;/a>&lt;/sup>çš„ä»£ä»·ï¼Œæ‰€ä»¥æˆ‘ä»¬æ”¹æˆå¼•ç”¨ä¼ é€’ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-cpp" data-lang="cpp">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">template&lt;/span> &lt;span style="color:#f92672">&amp;lt;&lt;/span>&lt;span style="color:#66d9ef">typename&lt;/span> T, &lt;span style="color:#66d9ef">typename&lt;/span> Arg&lt;span style="color:#f92672">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>std&lt;span style="color:#f92672">::&lt;/span>shared_ptr&lt;span style="color:#f92672">&amp;lt;&lt;/span>T&lt;span style="color:#f92672">&amp;gt;&lt;/span> factory(Arg &lt;span style="color:#f92672">&amp;amp;&lt;/span>arg) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> std&lt;span style="color:#f92672">::&lt;/span>shared_ptr&lt;span style="color:#f92672">&amp;lt;&lt;/span>T&lt;span style="color:#f92672">&amp;gt;&lt;/span>( &lt;span style="color:#66d9ef">new&lt;/span> T(arg));
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ä½†è¿™ç§å®ç°çš„é—®é¢˜æ˜¯ä¸èƒ½ç»‘å®šå³å€¼å®å‚ã€‚å¦‚&lt;code>factory&amp;lt;X&amp;gt;(42)&lt;/code>å°†ç¼–è¯‘æŠ¥é”™ï¼Œè¿›ä¸€æ­¥çš„ï¼Œæˆ‘ä»¬æŒ‰å¸¸é‡å¼•ç”¨æ¥ä¼ é€’ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-cpp" data-lang="cpp">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">template&lt;/span> &lt;span style="color:#f92672">&amp;lt;&lt;/span>&lt;span style="color:#66d9ef">typename&lt;/span> T, &lt;span style="color:#66d9ef">typename&lt;/span> Arg&lt;span style="color:#f92672">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>std&lt;span style="color:#f92672">::&lt;/span>shared_ptr&lt;span style="color:#f92672">&amp;lt;&lt;/span>T&lt;span style="color:#f92672">&amp;gt;&lt;/span> factory(&lt;span style="color:#66d9ef">const&lt;/span> Arg &lt;span style="color:#f92672">&amp;amp;&lt;/span>arg) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> std&lt;span style="color:#f92672">::&lt;/span>shared_ptr&lt;span style="color:#f92672">&amp;lt;&lt;/span>T&lt;span style="color:#f92672">&amp;gt;&lt;/span>( &lt;span style="color:#66d9ef">new&lt;/span> T(arg));
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>è¿™ç§å®ç°çš„é—®é¢˜æ˜¯ä¸èƒ½æ”¯æŒç§»åŠ¨è¯­ä¹‰ï¼Œå½¢å‚ä½¿ç”¨å³å€¼å¼•ç”¨å¯ä»¥è§£å†³å®Œç¾è½¬å‘é—®é¢˜ã€‚&lt;/p>
&lt;h2 id="å¼•ç”¨æŠ˜å ">å¼•ç”¨æŠ˜å &lt;/h2>
&lt;p>åœ¨&lt;code>C++11&lt;/code>ä¹‹å‰ï¼Œæˆ‘ä»¬ä¸èƒ½å¯¹ä¸€ä¸ªå¼•ç”¨ç±»å‹ç»§ç»­å¼•ç”¨ï¼Œä½†&lt;code>C++&lt;/code>ç”±äºå³å€¼å¼•ç”¨çš„å‡ºç°è€Œ&lt;strong>æ”¾å®½&lt;/strong>&lt;sup id="fnref:2">&lt;a href="#fn:2" class="footnote-ref" role="doc-noteref">2&lt;/a>&lt;/sup>äº†è¿™ä¸€åšæ³•ï¼Œä»è€Œäº§ç”Ÿäº†å¼•ç”¨æŠ˜å è§„åˆ™ï¼Œå…è®¸æˆ‘ä»¬å¯¹å¼•ç”¨è¿›è¡Œå¼•ç”¨ï¼Œæ—¢èƒ½å·¦å¼•ç”¨ï¼Œåˆèƒ½å³å¼•ç”¨ã€‚ä½†æ˜¯å´éµå¾ªå¦‚ä¸‹è§„åˆ™ï¼š&lt;/p>
&lt;table>
 &lt;thead>
 &lt;tr>
 &lt;th>å‡½æ•°å½¢å‚ç±»å‹&lt;/th>
 &lt;th>å®å‚ç±»å‹&lt;/th>
 &lt;th>æ¨å¯¼åå‡½æ•°å½¢å‚ç±»å‹&lt;/th>
 &lt;/tr>
 &lt;/thead>
 &lt;tbody>
 &lt;tr>
 &lt;td>&lt;code>T&amp;amp;&lt;/code>&lt;/td>
 &lt;td>å·¦å¼•ç”¨&lt;/td>
 &lt;td>&lt;code>T&amp;amp;&lt;/code>&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>&lt;code>T&amp;amp;&lt;/code>&lt;/td>
 &lt;td>å³å¼•ç”¨&lt;/td>
 &lt;td>&lt;code>T&amp;amp;&lt;/code>&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>&lt;code>T&amp;amp;&amp;amp;&lt;/code>&lt;/td>
 &lt;td>å·¦å¼•ç”¨&lt;/td>
 &lt;td>&lt;code>T&amp;amp;&lt;/code>&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>&lt;code>T&amp;amp;&amp;amp;&lt;/code>&lt;/td>
 &lt;td>å³å¼•ç”¨&lt;/td>
 &lt;td>&lt;code>T&amp;amp;&amp;amp;&lt;/code>&lt;/td>
 &lt;/tr>
 &lt;/tbody>
&lt;/table>
&lt;h2 id="æ¨¡æ¿å‚æ•°ç±»å‹æ¨å¯¼">æ¨¡æ¿å‚æ•°ç±»å‹æ¨å¯¼&lt;/h2>
&lt;p>å¯¹å‡½æ•°æ¨¡æ¿&lt;code>template&amp;lt;typename T&amp;gt;void foo(T&amp;amp;&amp;amp;);&lt;/code>ï¼Œåº”ç”¨ä¸Šè¿°å¼•ç”¨æŠ˜å è§„åˆ™ï¼Œå¯æ€»ç»“å‡ºä»¥ä¸‹ç»“è®ºï¼š&lt;/p>
&lt;ul>
&lt;li>å¦‚æœå®å‚æ˜¯ç±»å‹Açš„å·¦å€¼ï¼Œåˆ™æ¨¡æ¿å‚æ•°Tçš„ç±»å‹ä¸º&lt;code>A&amp;amp;&lt;/code>ï¼Œå½¢å‚ç±»å‹ä¸º&lt;code>A&amp;amp;&lt;/code>ï¼›&lt;/li>
&lt;li>å¦‚æœå®å‚æ˜¯ç±»å‹Açš„å³å€¼ï¼Œåˆ™æ¨¡æ¿å‚æ•°Tçš„ç±»å‹ä¸º&lt;code>A&amp;amp;&amp;amp;&lt;/code>ï¼Œå½¢å‚ç±»å‹ä¸º&lt;code>A&amp;amp;&amp;amp;&lt;/code>ã€‚&lt;/li>
&lt;/ul>
&lt;p>è¿™åŒæ ·é€‚ç”¨äºç±»æ¨¡æ¿çš„æˆå‘˜å‡½æ•°æ¨¡æ¿çš„ç±»å‹æ¨å¯¼ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-cpp" data-lang="cpp">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">template&lt;/span> &lt;span style="color:#f92672">&amp;lt;&lt;/span>&lt;span style="color:#66d9ef">class&lt;/span> &lt;span style="color:#a6e22e">T&lt;/span>&lt;span style="color:#f92672">&amp;gt;&lt;/span> &lt;span style="color:#66d9ef">class&lt;/span> &lt;span style="color:#a6e22e">vector&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">public&lt;/span>&lt;span style="color:#f92672">:&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// Tæ˜¯ç±»æ¨¡æ¿å‚æ•° â‡’ è¯¥æˆå‘˜å‡½æ•°ä¸éœ€è¦ç±»å‹æ¨å¯¼;è¿™é‡Œçš„å‡½æ•°å‚æ•°ç±»å‹å°±æ˜¯Tçš„å³å€¼å¼•ç”¨
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#66d9ef">void&lt;/span> push_back(T &lt;span style="color:#f92672">&amp;amp;&amp;amp;&lt;/span>x); 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// è¯¥æˆå‘˜å‡½æ•°æ˜¯ä¸ªå‡½æ•°æ¨¡æ¿ï¼Œæœ‰è‡ªå·±çš„æ¨¡æ¿å‚æ•°ï¼Œéœ€è¦ç±»å‹æ¨å¯¼
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#66d9ef">template&lt;/span> &lt;span style="color:#f92672">&amp;lt;&lt;/span>&lt;span style="color:#66d9ef">typename&lt;/span> Args&lt;span style="color:#f92672">&amp;gt;&lt;/span> &lt;span style="color:#66d9ef">void&lt;/span> emplace_back(Args &lt;span style="color:#f92672">&amp;amp;&amp;amp;&lt;/span>args); } 
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>å‡½æ•°æ¨¡æ¿çš„å½¢å‚å¿…é¡»æ˜¯T&amp;amp;&amp;amp;å½¢å¼ï¼Œæ‰éœ€è¦æ¨¡æ¿å‚æ•°ç±»å‹æ¨å¯¼ã€‚å³ä½¿å½¢å‚å£°æ˜ä¸ºconst T&amp;amp;&amp;amp;å½¢å¼ï¼Œå°±åªèƒ½æŒ‰å­—é¢æ„ä¹‰ä½¿ç”¨ï¼Œä¸éœ€è¦æ¨¡æ¿å‚æ•°ç±»å‹æ¨å¯¼ã€‚&lt;/p></description></item><item><title>Cuda ç¼–ç¨‹æ¨¡å‹</title><link>https://fffzlfk.github.io/posts/cuda_%E7%BC%96%E7%A8%8B%E6%A8%A1%E5%9E%8B/</link><pubDate>Wed, 19 Jan 2022 12:55:19 +0800</pubDate><guid>https://fffzlfk.github.io/posts/cuda_%E7%BC%96%E7%A8%8B%E6%A8%A1%E5%9E%8B/</guid><description>&lt;h2 id="kernels">Kernels&lt;/h2>
&lt;p>&lt;code>CUDA C++&lt;/code>å¯¹&lt;code>C++&lt;/code>è¿›è¡Œäº†æ‰©å±•ï¼Œå…è®¸ç¨‹åºå‘˜å®šä¹‰&lt;code>C++&lt;/code>å‡½æ•°ï¼Œç§°ä¸ºå†…æ ¸ï¼Œå½“è¢«è°ƒç”¨æ—¶ï¼Œç”± $N$ ä¸ªä¸åŒçš„&lt;code>CUDA&lt;/code>çº¿ç¨‹å¹¶è¡Œæ‰§è¡Œ $N$ æ¬¡ï¼Œè€Œä¸æ˜¯åƒæ™®é€š&lt;code>C++&lt;/code>å‡½æ•°é‚£æ ·åªæ‰§è¡Œä¸€æ¬¡ã€‚&lt;/p>
&lt;p>&lt;code>kernel&lt;/code>æ˜¯ä½¿ç”¨&lt;code>__global__&lt;/code>å£°æ˜å®šä¹‰çš„ï¼Œå¯¹äºç‰¹å®šçš„å†…æ ¸è°ƒç”¨ï¼Œæ‰§è¡Œè¯¥å†…æ ¸çš„&lt;code>CUDA&lt;/code>çº¿ç¨‹æ•°é‡æ˜¯ä½¿ç”¨&lt;code>&amp;lt;&amp;lt;&amp;lt;...&amp;gt;&amp;gt;&amp;gt;&lt;/code>æ‰§è¡Œé…ç½®è¯­æ³•æŒ‡å®šçš„ï¼ˆ&lt;a href="https://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#c-language-extensions">C++è¯­è¨€æ‰©å±•&lt;/a>ï¼‰ã€‚æ¯ä¸ªæ‰§è¡Œå†…æ ¸çš„çº¿ç¨‹éƒ½æœ‰ä¸€ä¸ªå”¯ä¸€çš„çº¿ç¨‹&lt;code>ID&lt;/code>ï¼Œå¯ä»¥åœ¨å†…æ ¸å†…é€šè¿‡å†…ç½®å˜é‡è®¿é—®ã€‚&lt;/p>
&lt;p>ä½œä¸ºè¯´æ˜ï¼Œä¸‹é¢çš„ç¤ºä¾‹ä»£ç ï¼Œä½¿ç”¨å†…ç½®å˜é‡&lt;code>threadIdx&lt;/code>ï¼Œå°†ä¸¤ä¸ªå¤§å°ä¸º $N$ çš„å‘é‡ $A$ å’Œ $B$ ç›¸åŠ ï¼Œå¹¶å°†ç»“æœå­˜å…¥å‘é‡ $C$ ã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-cpp" data-lang="cpp">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// Kernel definition
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>__global__ &lt;span style="color:#66d9ef">void&lt;/span> &lt;span style="color:#a6e22e">VecAdd&lt;/span>(&lt;span style="color:#66d9ef">float&lt;/span>&lt;span style="color:#f92672">*&lt;/span> A, &lt;span style="color:#66d9ef">float&lt;/span>&lt;span style="color:#f92672">*&lt;/span> B, &lt;span style="color:#66d9ef">float&lt;/span>&lt;span style="color:#f92672">*&lt;/span> C)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">int&lt;/span> i &lt;span style="color:#f92672">=&lt;/span> threadIdx.x;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> C[i] &lt;span style="color:#f92672">=&lt;/span> A[i] &lt;span style="color:#f92672">+&lt;/span> B[i];
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">int&lt;/span> &lt;span style="color:#a6e22e">main&lt;/span>()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ...
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// Kernel invocation with N threads
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> VecAdd&lt;span style="color:#f92672">&amp;lt;&amp;lt;&amp;lt;&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>, N&lt;span style="color:#f92672">&amp;gt;&amp;gt;&amp;gt;&lt;/span>(A, B, C);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ...
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>åœ¨è¿™é‡Œï¼Œæ‰§è¡Œ&lt;code>VecAdd()&lt;/code>çš„ $N$ ä¸ªçº¿ç¨‹ä¸­çš„æ¯ä¸€ä¸ªéƒ½æ‰§è¡Œäº†ä¸€æ¬¡åŠ æ³•ã€‚&lt;/p>
&lt;h2 id="çº¿ç¨‹ä½“ç³»">çº¿ç¨‹ä½“ç³»&lt;/h2>
&lt;p>ä¸ºæ–¹ä¾¿èµ·è§ï¼Œ&lt;code>threadIdx&lt;/code>æ˜¯ä¸€ä¸ª $3$ åˆ†é‡çš„å‘é‡ï¼Œå› æ­¤å¯ä»¥ç”¨ä¸€ç»´ã€äºŒç»´æˆ–ä¸‰ç»´çš„çº¿ç¨‹ç´¢å¼•æ¥è¯†åˆ«çº¿ç¨‹ï¼Œå½¢æˆä¸€ä¸ªä¸€ç»´ã€äºŒç»´æˆ–ä¸‰ç»´çš„çº¿ç¨‹å—ï¼Œç§°ä¸ºçº¿ç¨‹å—ã€‚è¿™æä¾›äº†ä¸€ç§è‡ªç„¶çš„æ–¹å¼æ¥è°ƒç”¨åŸŸä¸­çš„å…ƒç´ è¿›è¡Œè®¡ç®—ï¼Œå¦‚çŸ¢é‡ã€çŸ©é˜µæˆ–ä½“ç§¯ã€‚&lt;/p>
&lt;p>ä¸€ä¸ªä¾‹å­ï¼Œä¸‹é¢çš„ä»£ç å°†ä¸¤ä¸ªå¤§å°ä¸º $N\times N$ çš„çŸ©é˜µ $A$ å’Œ $B$ ç›¸åŠ ï¼Œå¹¶å°†ç»“æœå­˜å…¥çŸ©é˜µ $C$ ã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-cpp" data-lang="cpp">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// Kernel definition
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>__global__ &lt;span style="color:#66d9ef">void&lt;/span> &lt;span style="color:#a6e22e">MatAdd&lt;/span>(&lt;span style="color:#66d9ef">float&lt;/span> A[N][N], &lt;span style="color:#66d9ef">float&lt;/span> B[N][N],
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">float&lt;/span> C[N][N])
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">int&lt;/span> i &lt;span style="color:#f92672">=&lt;/span> threadIdx.x;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">int&lt;/span> j &lt;span style="color:#f92672">=&lt;/span> threadIdx.y;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> C[i][j] &lt;span style="color:#f92672">=&lt;/span> A[i][j] &lt;span style="color:#f92672">+&lt;/span> B[i][j];
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">int&lt;/span> &lt;span style="color:#a6e22e">main&lt;/span>()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ...
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// Kernel invocation with one block of N * N * 1 threads
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#66d9ef">int&lt;/span> numBlocks &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> dim3 threadsPerBlock(N, N);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> MatAdd&lt;span style="color:#f92672">&amp;lt;&amp;lt;&amp;lt;&lt;/span>numBlocks, threadsPerBlock&lt;span style="color:#f92672">&amp;gt;&amp;gt;&amp;gt;&lt;/span>(A, B, C);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ...
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>æ¯ä¸ªå—çš„çº¿ç¨‹æ•°é‡æ˜¯æœ‰é™åˆ¶çš„ï¼Œå› ä¸ºä¸€ä¸ªå—çš„æ‰€æœ‰çº¿ç¨‹éƒ½è¦é©»ç•™åœ¨åŒä¸€ä¸ªå¤„ç†å™¨æ ¸å¿ƒä¸Šï¼Œå¹¶ä¸”å¿…é¡»åˆ†äº«è¯¥æ ¸å¿ƒçš„æœ‰é™å†…å­˜èµ„æºã€‚åœ¨ç›®å‰çš„&lt;code>GPU&lt;/code>ä¸Šï¼Œä¸€ä¸ªçº¿ç¨‹å—æœ€å¤šå¯ä»¥åŒ…å« $1024$ ä¸ªçº¿ç¨‹ã€‚&lt;/p></description></item><item><title>Cuda ç¡¬ä»¶å®ç°</title><link>https://fffzlfk.github.io/posts/cuda_%E7%A1%AC%E4%BB%B6%E5%AE%9E%E7%8E%B0/</link><pubDate>Tue, 18 Jan 2022 15:31:10 +0800</pubDate><guid>https://fffzlfk.github.io/posts/cuda_%E7%A1%AC%E4%BB%B6%E5%AE%9E%E7%8E%B0/</guid><description>&lt;h2 id="ä¸€ç»„å¸¦æœ‰-on-chip-å…±äº«å†…å­˜çš„-simd-å¤šå¤„ç†å™¨">ä¸€ç»„å¸¦æœ‰ on-chip å…±äº«å†…å­˜çš„ SIMD å¤šå¤„ç†å™¨&lt;/h2>
&lt;p>è®¾å¤‡å¯ä»¥è¢«çœ‹ä½œä¸€ç»„å¤šå¤„ç†å™¨ï¼Œå¦‚å›¾æ‰€ç¤ºã€‚æ¯ä¸ªå¤šå¤„ç†å™¨ä½¿ç”¨å•æŒ‡ä»¤å¤šæ•°æ®&lt;code>(SIMD)&lt;/code>æ¶æ„ï¼šåœ¨ä»»ä½•ç»™å®šçš„æ—¶é’Ÿå‘¨æœŸå†…ï¼Œå¤šå¤„ç†å™¨çš„æ¯ä¸ªå¤„ç†å™¨æ‰§è¡ŒåŒä¸€æŒ‡ä»¤ï¼Œä½†æ“ä½œä¸åŒçš„æ•°æ®ã€‚&lt;/p>
&lt;p>&lt;img src="https://i.imgur.com/zb9GQPd.png" alt="">&lt;/p>
&lt;p>æ¯ä¸ªå¤šå¤„ç†å™¨ä½¿ç”¨å››ä¸ªä»¥ä¸‹ç±»å‹çš„&lt;code>on-chip&lt;/code>å†…å­˜ï¼š&lt;/p>
&lt;ul>
&lt;li>æ¯ä¸ªå¤„ç†å™¨ä¸€ç»„ $32$ ä½å¯„å­˜å™¨&lt;/li>
&lt;li>å¹¶è¡Œæ•°æ®ç¼“å­˜æˆ–å…±äº«å†…å­˜ï¼Œè¢«æ‰€æœ‰å¤„ç†å™¨å…±äº«å®ç°å†…å­˜ç©ºé—´å…±äº«&lt;/li>
&lt;li>é€šè¿‡è®¾å¤‡å†…å­˜çš„ä¸€ä¸ªåªè¯»åŒºåŸŸï¼Œä¸€ä¸ªåªè¯»å¸¸é‡ç¼“å­˜å™¨è¢«æ‰€æœ‰å¤„ç†å™¨å…±äº«&lt;/li>
&lt;li>é€šè¿‡è®¾å¤‡å†…å­˜çš„ä¸€ä¸ªåªè¯»åŒºåŸŸï¼Œä¸€ä¸ªåªè¯»çº¹ç†ç¼“å­˜å™¨è¢«æ‰€æœ‰å¤„ç†å™¨å…±äº«&lt;/li>
&lt;/ul>
&lt;p>æœ¬åœ°å’Œå…¨å±€å†…å­˜ç©ºé—´ä½œä¸ºè®¾å¤‡å†…å­˜çš„è¯»å†™åŒºåŸŸï¼Œè€Œä¸è¢«ç¼“å†²ã€‚
æ¯ä¸ªå¤šå¤„ç†å™¨é€šè¿‡çº¹ç†å•å…ƒè®¿é—®çº¹ç†ç¼“å†²å™¨ï¼Œå®ƒæ‰§è¡Œå„ç§å„æ ·çš„å¯»å€æ¨¡å¼å’Œæ•°æ®è¿‡æ»¤ã€‚&lt;/p>
&lt;h2 id="æ‰§è¡Œæ¨¡å¼">æ‰§è¡Œæ¨¡å¼&lt;/h2>
&lt;p>ä¸€ä¸ªçº¿ç¨‹å—ç½‘æ ¼æ˜¯é€šè¿‡å¤šå¤„ç†å™¨è§„åˆ’æ‰§è¡Œçš„ã€‚æ¯ä¸ªå¤šå¤„ç†å™¨ä¸€ä¸ªæ¥ä¸€ä¸ªçš„å¤„ç†å—æ‰¹å¤„ç†ã€‚ä¸€ä¸ªå—åªè¢«ä¸€ä¸ªå¤šå¤„ç†å™¨å¤„ç†ï¼Œå› æ­¤å¯ä»¥å¯¹é©»ç•™åœ¨&lt;code>on-chip&lt;/code>å…±äº«å†…å­˜çš„å…±äº«å†…å­˜ç©ºé—´å½¢æˆéå¸¸å¿«é€Ÿçš„è®¿é—®ã€‚&lt;/p>
&lt;p>ä¸€ä¸ªæ‰¹å¤„ç†ä¸­æ¯ä¸ªå¤šå¤„ç†å™¨å¯ä»¥å¤„ç†å¤šå°‘ä¸ªå—ï¼Œå–å†³äºæ¯ä¸ªçº¿ç¨‹ä¸­åˆ†é…äº†å¤šå°‘ä¸ªå¯„å­˜å™¨å’Œå·²çŸ¥å†…æ ¸ä¸­æ¯ä¸ªæ—¶é’Ÿéœ€è¦å¤šå°‘çš„å…±äº«å†…å­˜ï¼Œå› ä¸ºå¤šå¤„ç†å™¨çš„å¯„å­˜å™¨å’Œå†…å­˜åœ¨æ‰€æœ‰çš„çº¿ç¨‹ä¸­æ˜¯åˆ†å¼€çš„ã€‚å¦‚æœåœ¨è‡³å°‘ä¸€ä¸ªå—ä¸­ï¼Œæ¯ä¸ªå¤šå¤„ç†å™¨æ²¡æœ‰è¶³å¤Ÿé«˜çš„å¯„å­˜å™¨æˆ–å…±äº«å†…å­˜ç”¨ï¼Œé‚£ä¹ˆå†…æ ¸å°†æ— æ³•å¯åŠ¨ã€‚&lt;/p>
&lt;p>çº¿ç¨‹å—åœ¨ä¸€ä¸ªæ‰¹å¤„ç†ä¸­è¢«ä¸€ä¸ªå¤šå¤„ç†å™¨æ‰§è¡Œï¼Œè¢«ç§°ä¸º&lt;code>active&lt;/code>ï¼Œæ¯ä¸ª&lt;code>active&lt;/code>å—è¢«åˆ’åˆ†æˆ&lt;code>SIMD&lt;/code>çº¿ç¨‹ç»„ï¼Œè¢«ç§°ä¸º&lt;code>warps&lt;/code>ï¼›æ¯ä¸€æ¡è¿™æ ·çš„&lt;code>warp&lt;/code>åŒ…å«æ•°é‡ç›¸åŒçš„çº¿ç¨‹ï¼Œå«åš&lt;code>warp&lt;/code>å¤§å°ï¼Œå¹¶ä¸”åœ¨&lt;code>SIMD&lt;/code>çš„æ–¹å¼ä¸‹é€šè¿‡å¤šå¤„ç†å™¨æ‰§è¡Œï¼Œæ‰§è¡Œè°ƒåº¦ç¨‹åºå‘¨æœŸæ€§åœ°ä»ä¸€æ¡&lt;code>warp&lt;/code>åˆ‡æ¢åˆ°å¦ä¸€æ¡&lt;code>warp&lt;/code>ï¼Œä»¥è¾¾åˆ°å¤šå¤„ç†å™¨è®¡ç®—èµ„æºä½¿ç”¨çš„æœ€å¤§åŒ–ã€‚&lt;/p>
&lt;p>å—è¢«åˆ’åˆ†æˆ&lt;code>warp&lt;/code>çš„æ–¹å¼æ€»æ˜¯ç›¸åŒçš„ï¼›æ¯æ¡&lt;code>warp&lt;/code>åŒ…å«è¿ç»­çš„çº¿ç¨‹ï¼Œçº¿ç¨‹ç´¢å¼•ä»ç¬¬ä¸€ä¸ª&lt;code>warp&lt;/code>åŒ…å«ç€çš„çº¿ç¨‹ 0 å¼€å§‹é€’å¢ã€‚&lt;/p>
&lt;p>ä¸€ä¸ªå¤šå¤„ç†å™¨å¯ä»¥å¹¶å‘åœ°å¤„ç†å‡ ä¸ªå—ï¼Œé€šè¿‡åˆ’åˆ†åœ¨å®ƒä»¬ä¹‹ä¸­çš„å¯„å­˜å™¨å’Œå…±äº«å†…å­˜ã€‚æ›´å‡†ç¡®åœ°è¯´ï¼Œæ¯æ¡çº¿ç¨‹å¯ä½¿ç”¨çš„å¯„å­˜å™¨æ•°é‡ï¼Œç­‰äºæ¯ä¸ªå¤šå¤„ç†å™¨å¯„å­˜å™¨æ€»æ•°é™¤ä»¥å¹¶å‘çš„çº¿ç¨‹æ•°é‡ï¼Œå¹¶å‘çº¿ç¨‹çš„æ•°é‡ç­‰äºå¹¶å‘å—çš„æ•°é‡ä¹˜ä»¥æ¯å—çº¿ç¨‹çš„æ•°é‡ã€‚&lt;/p>
&lt;p>åœ¨ä¸€ä¸ªçº¿ç¨‹å—ç½‘æ ¼å†…çš„å—æ¬¡åºæ˜¯æœªå®šä¹‰çš„ï¼Œå¹¶ä¸”åœ¨å—ä¹‹é—´ä¸å­˜åœ¨åŒæ­¥æœºåˆ¶ï¼Œå› æ­¤æ¥è‡ªåŒä¸€ä¸ªç½‘æ ¼çš„ä¸¤ä¸ªä¸åŒå—çš„çº¿ç¨‹ä¸èƒ½é€šè¿‡å…¨å±€å†…å­˜å½¼æ­¤å®‰å…¨åœ°é€šè®¯ã€‚&lt;/p>
&lt;h2 id="è®¡ç®—å…¼å®¹æ€§">è®¡ç®—å…¼å®¹æ€§&lt;/h2>
&lt;p>è®¾å¤‡çš„å…¼å®¹æ€§ç”±ä¸¤ä¸ªå‚æ•°å®šä¹‰ï¼Œä¸»è¦ç‰ˆæœ¬å·å’Œæ¬¡è¦ç‰ˆæœ¬å·ã€‚è®¾å¤‡æ‹¥æœ‰çš„ä¸»è¦ç‰ˆæœ¬å·ä»£è¡¨ç›¸åŒçš„æ ¸å¿ƒæ¶æ„ã€‚&lt;/p>
&lt;p>æ¬¡è¦ç‰ˆæœ¬å·ä»£è¡¨ä¸€äº›æ”¹è¿›çš„æ ¸å¿ƒæ¶æ„ã€‚æ¯”å¦‚æ–°çš„ç‰¹æ€§ã€‚&lt;/p>
&lt;h2 id="å¤šè®¾å¤‡">å¤šè®¾å¤‡&lt;/h2>
&lt;p>ä¸ºä¸€ä¸ªåº”ç”¨ç¨‹åºä½¿ç”¨å¤š&lt;code>GPU&lt;/code>ä½œä¸º&lt;code>CUDA&lt;/code>è®¾å¤‡ï¼Œå¿…é¡»ä¿è¯è¿™äº›&lt;code>CPU&lt;/code>æ˜¯ä¸€æ ·çš„ç±»å‹ã€‚å¦‚æœç³»ç»Ÿå·¥ä½œåœ¨&lt;code>SLI&lt;/code> æ¨¡å¼ä¸‹ï¼Œé‚£ä¹ˆåªæœ‰ä¸€ä¸ª&lt;code>GPU&lt;/code>å¯ä»¥ä½œä¸º&lt;code>CUDA&lt;/code>è®¾å¤‡ï¼Œç”±äºæ‰€æœ‰çš„&lt;code>GPU&lt;/code>åœ¨é©±åŠ¨å †æ ˆä¸­è¢«åº•å±‚çš„èåˆäº†ã€‚&lt;code>SLI&lt;/code> æ¨¡å¼éœ€è¦åœ¨æ§åˆ¶é¢æ¿ä¸­å…³é—­,è¿™æ ·æ‰èƒ½ä½¿å¤šä¸ª&lt;code>GPU&lt;/code>ä½œä¸º&lt;code>CUDA&lt;/code>è®¾å¤‡&lt;/p></description></item><item><title>OpenCV Canny Detector</title><link>https://fffzlfk.github.io/posts/opencv_canny_detector/</link><pubDate>Mon, 17 Jan 2022 11:35:18 +0800</pubDate><guid>https://fffzlfk.github.io/posts/opencv_canny_detector/</guid><description>&lt;h2 id="ç†è®º">ç†è®º&lt;/h2>
&lt;p>&lt;strong>Cannyè¾¹ç¼˜æ£€æµ‹&lt;/strong>æ˜¯ç”±John F. Cannyåœ¨1986å¹´å¼€å‘çš„ã€‚è®¸å¤šäººä¹Ÿå°†å…¶ç§°ä¸ºæœ€ä½³æ£€æµ‹å™¨ï¼ŒCannyç®—æ³•æ—¨åœ¨æ»¡è¶³ä¸‰ä¸ªä¸»è¦æ ‡å‡†ã€‚&lt;/p>
&lt;ul>
&lt;li>&lt;strong>å¥½çš„æ£€æµ‹&lt;/strong>ï¼šç®—æ³•èƒ½å¤Ÿå°½å¯èƒ½å¤šåœ°æ ‡è¯†å‡ºå›¾åƒä¸­çš„å®é™…è¾¹ç¼˜ã€‚&lt;/li>
&lt;li>&lt;strong>å¥½çš„å®šä½&lt;/strong>ï¼šæ ‡è¯†å‡ºçš„è¾¹ç¼˜è¦ä¸å®é™…å›¾åƒä¸­çš„å®é™…è¾¹ç¼˜å°½å¯èƒ½æ¥è¿‘ã€‚&lt;/li>
&lt;li>&lt;strong>æœ€å°å“åº”&lt;/strong>ï¼šå›¾åƒä¸­çš„è¾¹ç¼˜åªèƒ½æ ‡è¯†ä¸€æ¬¡ï¼Œå¹¶ä¸”å¯èƒ½å­˜åœ¨çš„å›¾åƒé›œè¨Šä¸åº”æ ‡è¯†ä¸ºè¾¹ç¼˜ã€‚&lt;/li>
&lt;/ul>
&lt;h3 id="æ­¥éª¤">æ­¥éª¤&lt;/h3>
&lt;ol>
&lt;li>
&lt;p>&lt;strong>é™å™ª&lt;/strong>ï¼šä½¿ç”¨é«˜æ–¯æ»¤æ³¢æ¥è¾¾åˆ°ï¼Œä¸‹é¢æ˜¯ä¸€ä¸ªå¤§å°ä¸º $5$ çš„é«˜æ–¯æ ¸çš„ä¾‹å­ï¼š
$$
K = \frac{1}{159}\begin{bmatrix}
2 &amp;amp; 4 &amp;amp; 5 &amp;amp; 4 &amp;amp; 2\\
4 &amp;amp; 9 &amp;amp; 12 &amp;amp; 9 &amp;amp; 4\\
5 &amp;amp; 12 &amp;amp; 15 &amp;amp; 12 &amp;amp; 5\\
4 &amp;amp; 9 &amp;amp; 12 &amp;amp; 9 &amp;amp; 4\\
2 &amp;amp; 4 &amp;amp; 5 &amp;amp; 4 &amp;amp; 2
\end{bmatrix}
$$&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>æ‰¾åˆ°å›¾åƒçš„äº®åº¦æ¢¯åº¦&lt;/strong>ï¼šä¸ºæ­¤ï¼Œæˆ‘ä»¬éµå¾ªä¸€ä¸ªç±»ä¼¼äº&lt;code>Sobel&lt;/code>çš„ç¨‹åºï¼š&lt;/p>
&lt;ol>
&lt;li>åº”ç”¨ä¸€å¯¹å·ç§¯&lt;code>masks&lt;/code>ï¼ˆåœ¨ $x$ å’Œ $y$ æ–¹å‘ä¸Šï¼‰ï¼š
$$
G_x = \begin{bmatrix}
-1 &amp;amp; 0 &amp;amp; +1\\
-2 &amp;amp; 0 &amp;amp; +2\\
-1 &amp;amp; 0 &amp;amp; +1
\end{bmatrix}, G_y=\begin{bmatrix}
-1 &amp;amp; -2 &amp;amp; -1\\
0 &amp;amp; 0 &amp;amp; 0\\
+1 &amp;amp; +2 &amp;amp; +1
\end{bmatrix}
$$&lt;/li>
&lt;li>å¯»æ‰¾æ¢¯åº¦å¼ºåº¦å’Œæ–¹å‘ï¼š
$$
G=\sqrt{G_x^2+G_y^2}\\
\theta = \arctan(\frac{G_y}{G_x})
$$
æ–¹å‘è¢«å››èˆäº”å…¥ä¸ºå››ä¸ªå¯èƒ½çš„è§’åº¦ä¹‹ä¸€ï¼ˆå³ $0\degree$ ã€ $45\degree$ ã€ $90\degree$ æˆ– $135\degree$ ï¼‰ã€‚&lt;/li>
&lt;/ol>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>è¿‡æ»¤éæœ€å¤§å€¼&lt;/strong>ï¼šåœ¨é«˜æ–¯æ»¤æ³¢è¿‡ç¨‹ä¸­ï¼Œè¾¹ç¼˜æœ‰å¯èƒ½è¢«æ”¾å¤§äº†ã€‚è¿™ä¸ªæ­¥éª¤ä½¿ç”¨ä¸€ä¸ªè§„åˆ™æ¥è¿‡æ»¤ä¸æ˜¯è¾¹ç¼˜çš„ç‚¹ï¼Œä½¿è¾¹ç¼˜çš„å®½åº¦å°½å¯èƒ½ä¸º1ä¸ªåƒç´ ç‚¹ï¼šå¦‚æœä¸€ä¸ªåƒç´ ç‚¹å±äºè¾¹ç¼˜ï¼Œé‚£ä¹ˆè¿™ä¸ªåƒç´ ç‚¹åœ¨æ¢¯åº¦æ–¹å‘ä¸Šçš„æ¢¯åº¦å€¼æ˜¯æœ€å¤§çš„ã€‚å¦åˆ™ä¸æ˜¯è¾¹ç¼˜ï¼Œå°†ç°åº¦å€¼è®¾ä¸º $0$ ã€‚
$$
M_T(m, n) = \begin{cases}
M(m, n)&amp;amp; \text{if } M(m, n) \lt T\\
0 &amp;amp; \text{otherwise}
\end{cases}
$$&lt;/p></description></item><item><title>OpenCV Laplace Operator</title><link>https://fffzlfk.github.io/posts/opencv_laplace_operator/</link><pubDate>Mon, 17 Jan 2022 08:22:11 +0800</pubDate><guid>https://fffzlfk.github.io/posts/opencv_laplace_operator/</guid><description>&lt;h2 id="ç†è®º">ç†è®º&lt;/h2>
&lt;ol>
&lt;li>
&lt;p>åœ¨ä¹‹å‰çš„æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å­¦ä¹ äº†å¦‚ä½•ä½¿ç”¨&lt;code>Sobel&lt;/code>ç®—å­ã€‚å®ƒæ˜¯åŸºäºè¿™æ ·ä¸€ä¸ªäº‹å®ï¼Œå³åœ¨è¾¹ç¼˜åŒºåŸŸï¼Œåƒç´ å¼ºåº¦æ˜¾ç¤ºäº†ä¸€ä¸ª &amp;ldquo;è·³è·ƒ&amp;quot;æˆ–å¼ºåº¦çš„é«˜å˜åŒ–ã€‚å¾—åˆ°å¼ºåº¦çš„ä¸€é˜¶å¯¼æ•°ï¼Œæˆ‘ä»¬è§‚å¯Ÿåˆ°è¾¹ç¼˜çš„ç‰¹å¾æ˜¯ä¸€ä¸ªæœ€å¤§å€¼ï¼Œå¦‚å›¾æ‰€ç¤ºï¼š
&lt;img src="https://docs.opencv.org/4.5.5/Laplace_Operator_Tutorial_Theory_Previous.jpg" alt="">&lt;/p>
&lt;/li>
&lt;li>
&lt;p>é‚£ä¹ˆï¼Œå¦‚æœæˆ‘ä»¬å–äºŒé˜¶å¯¼æ•°ä¼šæ€æ ·ï¼Ÿ
&lt;img src="https://docs.opencv.org/4.5.5/Laplace_Operator_Tutorial_Theory_ddIntensity.jpg" alt="">
ä½ å¯ä»¥è§‚å¯Ÿåˆ°ï¼Œè¾¹ç¼˜äºŒé˜¶å¯¼æ•°æ˜¯é›¶! å› æ­¤ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨è¿™ä¸ªæ ‡å‡†æ¥å°è¯•æ£€æµ‹å›¾åƒçš„è¾¹ç¼˜ã€‚ç„¶è€Œï¼Œè¯·æ³¨æ„ï¼Œé›¶å€¼ä¸ä»…ä¼šå‡ºç°åœ¨è¾¹ç¼˜ï¼ˆå®ƒä»¬å®é™…ä¸Šå¯ä»¥å‡ºç°åœ¨å…¶ä»–æ— æ„ä¹‰çš„ä½ç½®ï¼‰ï¼›è¿™å¯ä»¥é€šè¿‡åœ¨éœ€è¦æ—¶ä½¿ç”¨è¿‡æ»¤æ¥è§£å†³ã€‚&lt;/p>
&lt;/li>
&lt;/ol>
&lt;h3 id="æ‹‰æ™®æ‹‰æ–¯ç®—å­">æ‹‰æ™®æ‹‰æ–¯ç®—å­&lt;/h3>
&lt;ol>
&lt;li>ä»ä¸Šé¢çš„è§£é‡Šä¸­ï¼Œæˆ‘ä»¬å¯ä»¥æ¨æ–­å‡ºï¼ŒäºŒé˜¶å¯¼æ•°å¯ä»¥ç”¨æ¥æ£€æµ‹è¾¹ç¼˜ã€‚ç”±äºå›¾åƒæ˜¯äºŒç»´çš„ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ä¸¤ä¸ªç»´åº¦ä¸Šå–å¯¼æ•°ã€‚è¿™é‡Œï¼Œæ‹‰æ™®æ‹‰æ–¯ç®—å­å°±æ´¾ä¸Šç”¨åœºäº†ã€‚
æ‹‰æ™®æ‹‰æ–¯ç®—å­çš„å®šä¹‰æ˜¯ï¼š
$$
Laplace(f) = \frac{\partial^2f}{\partial x^2}+\frac{\partial^2f}{\partial y^2}
$$&lt;/li>
&lt;li>æ‹‰æ™®æ‹‰æ–¯ç®—å­åœ¨OpenCVä¸­æ˜¯ç”±å‡½æ•°&lt;code>Laplacian()&lt;/code>å®ç°çš„ã€‚äº‹å®ä¸Šï¼Œç”±äºæ‹‰æ™®æ‹‰æ–¯ç®—å­ä½¿ç”¨å›¾åƒçš„æ¢¯åº¦ï¼Œå®ƒåœ¨å†…éƒ¨è°ƒç”¨ç´¢è´å°”ç®—å­æ¥è¿›è¡Œè®¡ç®—çš„ã€‚&lt;/li>
&lt;/ol>
&lt;h2 id="code">Code&lt;/h2>
&lt;p>&lt;a href="https://github.com/fffzlfk/opencv_learning/blob/main/src/transformations/laplace.cpp">ä»£ç é“¾æ¥&lt;/a>&lt;/p>
&lt;h3 id="explanation">Explanation&lt;/h3>
&lt;h4 id="å˜é‡å£°æ˜">å˜é‡å£°æ˜&lt;/h4>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-cpp" data-lang="cpp">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// Declare the variables we are going to use
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>Mat src, src_gray, dst;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">int&lt;/span> kernel_size &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">3&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">int&lt;/span> scale &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">int&lt;/span> delta &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">int&lt;/span> ddepth &lt;span style="color:#f92672">=&lt;/span> CV_16S;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#66d9ef">char&lt;/span>&lt;span style="color:#f92672">*&lt;/span> window_name &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;Laplace Demo&amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h4 id="åŠ è½½å›¾åƒ">åŠ è½½å›¾åƒ&lt;/h4>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-cpp" data-lang="cpp">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#66d9ef">char&lt;/span>&lt;span style="color:#f92672">*&lt;/span> imageName &lt;span style="color:#f92672">=&lt;/span> argc &lt;span style="color:#f92672">&amp;gt;=&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#f92672">?&lt;/span> argv[&lt;span style="color:#ae81ff">1&lt;/span>] &lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#e6db74">&amp;#34;./images/lena.jpg&amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>src &lt;span style="color:#f92672">=&lt;/span> imread( samples&lt;span style="color:#f92672">::&lt;/span>findFile( imageName ), IMREAD_COLOR ); &lt;span style="color:#75715e">// Load an image
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// Check if image is loaded fine
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#66d9ef">if&lt;/span>(src.empty()){
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> printf(&lt;span style="color:#e6db74">&amp;#34; Error opening image&lt;/span>&lt;span style="color:#ae81ff">\n&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> printf(&lt;span style="color:#e6db74">&amp;#34; Program Arguments: [image_name -- default lena.jpg] &lt;/span>&lt;span style="color:#ae81ff">\n&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#f92672">-&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h4 id="æ¶ˆé™¤å™ªå£°">æ¶ˆé™¤å™ªå£°&lt;/h4>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-cpp" data-lang="cpp">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// Reduce noise by blurring with a Gaussian filter ( kernel size = 3 )
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>GaussianBlur( src, src, Size(&lt;span style="color:#ae81ff">3&lt;/span>, &lt;span style="color:#ae81ff">3&lt;/span>), &lt;span style="color:#ae81ff">0&lt;/span>, &lt;span style="color:#ae81ff">0&lt;/span>, BORDER_DEFAULT );
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h4 id="ç°åº¦åŒ–">ç°åº¦åŒ–&lt;/h4>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-cpp" data-lang="cpp">&lt;span style="display:flex;">&lt;span>cvtColor( src, src_gray, COLOR_BGR2GRAY ); &lt;span style="color:#75715e">// Convert the image to grayscale
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h4 id="æ‹‰æ™®æ‹‰æ–¯ç®—å­-1">æ‹‰æ™®æ‹‰æ–¯ç®—å­&lt;/h4>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-cpp" data-lang="cpp">&lt;span style="display:flex;">&lt;span>Laplacian( src_gray, dst, ddepth, kernel_size, scale, delta, BORDER_DEFAULT );
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>å‚æ•°å¦‚ä¸‹ã€‚
&lt;ul>
&lt;li>&lt;code>src_gray&lt;/code>ï¼šè¾“å…¥çš„å›¾åƒã€‚&lt;/li>
&lt;li>&lt;code>dst&lt;/code>ï¼šç›®æ ‡å›¾åƒ&lt;/li>
&lt;li>&lt;code>ddepth&lt;/code>ã€‚ç›®çš„å›¾åƒçš„æ·±åº¦ã€‚ç”±äºæˆ‘ä»¬çš„è¾“å…¥æ˜¯CV_8Uï¼Œæˆ‘ä»¬å®šä¹‰ddepth = CV_16Sä»¥é¿å…æº¢å‡ºã€‚&lt;/li>
&lt;li>&lt;code>kernel_size&lt;/code>ã€‚å†…éƒ¨åº”ç”¨çš„Sobelç®—å­çš„æ ¸å¤§å°ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­æˆ‘ä»¬ä½¿ç”¨3ã€‚&lt;/li>
&lt;li>&lt;code>scale, delta&lt;/code> å’Œ &lt;code>BORDER_DEFAULT&lt;/code>ï¼šæˆ‘ä»¬æŠŠå®ƒä»¬ä½œä¸ºé»˜è®¤å€¼ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h4 id="å°†è¾“å‡ºè½¬æ¢ä¸ºcv_8uå›¾åƒ">å°†è¾“å‡ºè½¬æ¢ä¸ºCV_8Uå›¾åƒ&lt;/h4>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-cpp" data-lang="cpp">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// converting back to CV_8U
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>convertScaleAbs( dst, abs_dst );
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="ç»“æœ">ç»“æœ&lt;/h2>
&lt;ol>
&lt;li>
&lt;p>ç¼–è¯‘å®Œä¸Šé¢çš„ä»£ç åï¼Œæˆ‘ä»¬å¯ä»¥è¿è¡Œå®ƒï¼Œå¹¶å°†å›¾åƒçš„è·¯å¾„ä½œä¸ºå‚æ•°ã€‚ä¾‹å¦‚ï¼Œä»¥ä¸‹å›¾è¾“å…¥ä¸ºä¾‹ï¼š
&lt;img src="https://docs.opencv.org/4.5.5/Laplace_Operator_Tutorial_Original_Image.jpg" alt="">&lt;/p></description></item><item><title>OpenCV Sobel Derivatives</title><link>https://fffzlfk.github.io/posts/opencv_sobel_derivatives/</link><pubDate>Sun, 16 Jan 2022 12:18:12 +0800</pubDate><guid>https://fffzlfk.github.io/posts/opencv_sobel_derivatives/</guid><description>&lt;h2 id="ç†è®º">ç†è®º&lt;/h2>
&lt;ol>
&lt;li>
&lt;p>åœ¨ä¹‹å‰çš„ä¸¤ä¸ªæ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å·²ç»çœ‹åˆ°äº†å·ç§¯çš„åº”ç”¨å®ä¾‹ã€‚æœ€é‡è¦çš„å·ç§¯ä¹‹ä¸€æ˜¯è®¡ç®—å›¾åƒä¸­çš„å¯¼æ•°ï¼ˆæˆ–å¯¹å®ƒä»¬çš„è¿‘ä¼¼å€¼ï¼‰&lt;/p>
&lt;/li>
&lt;li>
&lt;p>ä¸ºä»€ä¹ˆå›¾åƒä¸­çš„å¯¼æ•°è®¡ç®—å¯èƒ½æ˜¯é‡è¦çš„ï¼Ÿè®©æˆ‘ä»¬è®¾æƒ³ä¸€ä¸‹ï¼Œæˆ‘ä»¬è¦æ£€æµ‹å›¾åƒä¸­å­˜åœ¨çš„è¾¹ç¼˜ã€‚æ¯”å¦‚è¯´ï¼š
&lt;img src="https://docs.opencv.org/4.5.5/Sobel_Derivatives_Tutorial_Theory_0.jpg" alt="">
ä½ å¯ä»¥å¾ˆå®¹æ˜“åœ°æ³¨æ„åˆ°ï¼Œåœ¨ä¸€ä¸ªè¾¹ç¼˜ï¼Œåƒç´ å¼ºåº¦çš„å˜åŒ–æ˜¯å¾ˆæ˜æ˜¾çš„ã€‚ä¸€ä¸ªè¡¨è¾¾å˜åŒ–çš„å¥½æ–¹æ³•æ˜¯ä½¿ç”¨å¯¼æ•°ã€‚æ¢¯åº¦çš„é«˜å˜åŒ–è¡¨ç¤ºå›¾åƒä¸­çš„ä¸€ä¸ªé‡å¤§å˜åŒ–ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>ä¸ºäº†æ›´åŠ å½¢è±¡ï¼Œè®©æˆ‘ä»¬å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªä¸€ç»´å›¾åƒã€‚åœ¨ä¸‹é¢çš„å›¾ä¸­ï¼Œä¸€ä¸ªè¾¹ç¼˜ç”±å¼ºåº¦çš„ &amp;ldquo;è·³è·ƒ &amp;ldquo;æ¥è¡¨ç¤ºï¼š
&lt;img src="https://docs.opencv.org/4.5.5/Sobel_Derivatives_Tutorial_Theory_Intensity_Function.jpg" alt="">&lt;/p>
&lt;/li>
&lt;li>
&lt;p>å¦‚æœæˆ‘ä»¬å–ç¬¬ä¸€ä¸ªå¯¼æ•°ï¼Œå¯ä»¥æ›´å®¹æ˜“åœ°çœ‹åˆ°è¾¹ç¼˜çš„ &amp;ldquo;è·³è·ƒ&amp;rdquo;ï¼ˆå®é™…ä¸Šï¼Œè¿™é‡Œå‡ºç°çš„æ˜¯ä¸€ä¸ªæœ€å¤§å€¼ï¼‰ï¼š
&lt;img src="https://docs.opencv.org/4.5.5/Sobel_Derivatives_Tutorial_Theory_dIntensity_Function.jpg" alt="">&lt;/p>
&lt;/li>
&lt;li>
&lt;p>å› æ­¤ï¼Œä»ä¸Šé¢çš„è§£é‡Šä¸­ï¼Œæˆ‘ä»¬å¯ä»¥æ¨æ–­å‡ºï¼Œæ£€æµ‹å›¾åƒä¸­çš„è¾¹ç¼˜çš„æ–¹æ³•å¯ä»¥é€šè¿‡å®šä½æ¢¯åº¦é«˜äºå…¶é‚»å±…çš„åƒç´ ä½ç½®ï¼ˆæˆ–è€…æ¦‚æ‹¬åœ°è¯´ï¼Œé«˜äºä¸€ä¸ªé˜ˆå€¼ï¼‰æ¥è¿›è¡Œã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>æ›´è¯¦ç»†çš„è§£é‡Šï¼Œè¯·å‚è€ƒBradskiå’ŒKaehlerçš„&lt;a href="https://www.amazon.com/Learning-OpenCV-Computer-Vision-Library/dp/0596516134">ã€ŠLearning OpenCVã€‹&lt;/a>ã€‚&lt;/p>
&lt;/li>
&lt;/ol>
&lt;h3 id="sobel-ç®—å­">Sobel ç®—å­&lt;/h3>
&lt;ol>
&lt;li>Sobelç®—å­æ˜¯ä¸€ä¸ªç¦»æ•£çš„å¾®åˆ†ç®—å­ï¼Œå®ƒè®¡ç®—å›¾åƒå¼ºåº¦å‡½æ•°çš„æ¢¯åº¦çš„è¿‘ä¼¼å€¼ã€‚&lt;/li>
&lt;li>Sobelç®—å­ç»“åˆäº†&lt;code>Gaussian smoothing&lt;/code>å’Œå¾®åˆ†ã€‚&lt;/li>
&lt;/ol>
&lt;h3 id="formulation">Formulation&lt;/h3>
&lt;p>å‡è®¾è¦æ“ä½œçš„å›¾åƒä¸º $I$:&lt;/p>
&lt;ol>
&lt;li>æˆ‘ä»¬è®¡ç®—ä¸¤ä¸ªå¯¼æ•°ï¼š
&lt;ol>
&lt;li>&lt;strong>æ°´å¹³å˜åŒ–&lt;/strong>ï¼šè¿™æ˜¯é€šè¿‡ç”¨å¥‡æ•°å¤§å°çš„å†…æ ¸ $G_x$ å¯¹ $I$ è¿›è¡Œå·ç§¯è®¡ç®—çš„ã€‚ä¾‹å¦‚ï¼Œå¯¹äºå†…æ ¸å¤§å°ä¸º $3$ ï¼Œ $G_x$ å°†è¢«è®¡ç®—ä¸ºï¼š
$$
G_x=\begin{bmatrix}
-1 &amp;amp; 0 &amp;amp; +1\\
-2 &amp;amp; 0 &amp;amp; +2\\
-1 &amp;amp; 0 &amp;amp; +1
\end{bmatrix} * I
$$&lt;/li>
&lt;li>&lt;strong>å‚ç›´å˜åŒ–&lt;/strong>ï¼šè¿™æ˜¯é€šè¿‡ç”¨å¥‡æ•°å¤§å°çš„å†…æ ¸ $G_y$ å¯¹ $I$ è¿›è¡Œå·ç§¯è®¡ç®—çš„ã€‚ä¾‹å¦‚ï¼Œå¯¹äºå†…æ ¸å¤§å°ä¸º $3$ ï¼Œ $G_y$ å°†è¢«è®¡ç®—ä¸ºï¼š
$$
G_y = \begin{bmatrix}
-1 &amp;amp; -2 &amp;amp; -1\\
0 &amp;amp; 0 &amp;amp; 0\\
+1 &amp;amp; +2 &amp;amp; + 1
\end{bmatrix} * I
$$&lt;/li>
&lt;/ol>
&lt;/li>
&lt;li>åœ¨å›¾åƒçš„æ¯ä¸€ç‚¹ä¸Šï¼Œæˆ‘ä»¬é€šè¿‡ç»“åˆä¸Šè¿°ä¸¤ä¸ªç»“æœè®¡ç®—å‡ºè¯¥ç‚¹çš„æ¢¯åº¦è¿‘ä¼¼å€¼ï¼š
$$
G = \sqrt{G_{x}^{2}+G_{y}^{2}}
$$
æœ‰æ—¶ä¼šä½¿ç”¨ä»¥ä¸‹æ›´ç®€å•çš„æ–¹ç¨‹å¼ï¼š
$$
G = |G_x|+|G_y|
$$&lt;/li>
&lt;/ol>
&lt;blockquote>
&lt;p>å½“æ ¸çš„å¤§å°ä¸º $3$ æ—¶ï¼Œä¸Šé¢æ˜¾ç¤ºçš„ &lt;code>Sobel&lt;/code>æ ¸å¯èƒ½ä¼šäº§ç”Ÿæ˜æ˜¾çš„ä¸å‡†ç¡®ï¼ˆæ¯•ç«Ÿï¼Œ &lt;code>Sobel&lt;/code> åªæ˜¯ä¸€ä¸ªå¯¼æ•°çš„è¿‘ä¼¼å€¼ï¼‰ã€‚OpenCVé€šè¿‡ä½¿ç”¨ &lt;code>Scharr()&lt;/code> å‡½æ•°æ¥è§£å†³è¿™ç§å¤§å°ä¸º $3$ çš„æ ¸çš„ä¸ç²¾ç¡®æ€§ã€‚è¿™å’Œæ ‡å‡†çš„ &lt;code>Sobel&lt;/code> å‡½æ•°ä¸€æ ·å¿«ï¼Œä½†æ¯”å®ƒæ›´å‡†ç¡®ã€‚å®ƒå¯ä»¥å®ç°ä»¥ä¸‹å†…æ ¸
$$
G_x=\begin{bmatrix}
-3 &amp;amp; 0 &amp;amp; +3\\
-10 &amp;amp; 0 &amp;amp; +10\\
-3 &amp;amp; 0 &amp;amp; +3
\end{bmatrix},
G_y=\begin{bmatrix}
-3 &amp;amp; -10 &amp;amp; -3\\
0 &amp;amp; 0 &amp;amp; 0\\
+3 &amp;amp; +10 &amp;amp; +3
\end{bmatrix}
$$&lt;/p></description></item><item><title>OpenCV Erosion Dilatation</title><link>https://fffzlfk.github.io/posts/opencv_erosion_dilatation/</link><pubDate>Sun, 09 Jan 2022 12:25:24 +0800</pubDate><guid>https://fffzlfk.github.io/posts/opencv_erosion_dilatation/</guid><description>&lt;h2 id="å½¢æ€å­¦æ“ä½œ">å½¢æ€å­¦æ“ä½œ&lt;/h2>
&lt;ul>
&lt;li>ç®€è€Œè¨€ä¹‹ï¼šä¸€å¥—åŸºäºå½¢çŠ¶å¤„ç†å›¾åƒçš„æ“ä½œã€‚å½¢æ€å­¦æ“ä½œå°†ä¸€ä¸ªç»“æ„åŒ–å…ƒç´ åº”ç”¨äºè¾“å…¥å›¾åƒï¼Œå¹¶ç”Ÿæˆä¸€ä¸ªè¾“å‡ºå›¾åƒã€‚&lt;/li>
&lt;li>æœ€åŸºæœ¬çš„å½¢æ€å­¦æ“ä½œæ˜¯ã€‚è…èš€å’Œè†¨èƒ€ã€‚å®ƒä»¬æœ‰å¹¿æ³›çš„ç”¨é€”ï¼Œå³
&lt;ul>
&lt;li>å»é™¤å™ªéŸ³&lt;/li>
&lt;li>éš”ç¦»å•ä¸ªå…ƒç´ å’Œè¿æ¥å›¾åƒä¸­ä¸åŒçš„å…ƒç´ &lt;/li>
&lt;li>å¯»æ‰¾å›¾åƒä¸­çš„å¼ºåº¦å‡¹å‡¸ç‚¹æˆ–æ´&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>æˆ‘ä»¬å°†ä»¥ä¸‹é¢çš„å›¾åƒä¸ºä¾‹ï¼Œç®€è¦åœ°è§£é‡Šè†¨èƒ€å’Œä¾µèš€ã€‚
&lt;img src="https://docs.opencv.org/4.5.5/Morphology_1_Tutorial_Theory_Original_Image.png" alt="">&lt;/li>
&lt;/ul>
&lt;h3 id="dilationè†¨èƒ€">Dilationï¼ˆè†¨èƒ€ï¼‰&lt;/h3>
&lt;ul>
&lt;li>è¿™ç§æ“ä½œåŒ…æ‹¬å°†å›¾åƒAä¸ä¸€äº›&lt;code>kernel B&lt;/code>è¿›è¡Œå·ç§¯ï¼Œå†…æ ¸å¯ä»¥æœ‰ä»»ä½•å½¢çŠ¶æˆ–å¤§å°ï¼Œé€šå¸¸æ˜¯ä¸€ä¸ªæ­£æ–¹å½¢æˆ–åœ†å½¢ã€‚&lt;/li>
&lt;li>&lt;code>kernel B&lt;/code>æœ‰ä¸€ä¸ªå®šä¹‰çš„é”šç‚¹(&lt;code>anchor point&lt;/code>)ï¼Œé€šå¸¸æ˜¯æ ¸çš„ä¸­å¿ƒã€‚&lt;/li>
&lt;li>å½“&lt;code>kernel B&lt;/code>åœ¨å›¾åƒä¸Šæ‰«ææ—¶ï¼Œæˆ‘ä»¬è®¡ç®—å‡ºè¢«Bé‡å çš„æœ€å¤§åƒç´ å€¼ï¼Œå¹¶ç”¨è¯¥æœ€å¤§å€¼æ›¿æ¢é”šç‚¹ä½ç½®çš„å›¾åƒåƒç´ ã€‚æ­£å¦‚ä½ å¯ä»¥æ¨æ–­çš„é‚£æ ·ï¼Œè¿™ç§æœ€å¤§åŒ–çš„æ“ä½œä¼šä½¿å›¾åƒä¸­çš„æ˜äº®åŒºåŸŸ &amp;ldquo;å¢é•¿&amp;rdquo;ï¼ˆå› æ­¤è¢«ç§°ä¸ºè†¨èƒ€ï¼‰ã€‚&lt;/li>
&lt;li>è†¨èƒ€æ“ä½œï¼š $dst(x, y)=max(x^{&amp;rsquo;}, y^{&amp;rsquo;})_{:element(x^{&amp;rsquo;}, y^{&amp;rsquo;}) \ne 0} src(x+x^{&amp;rsquo;}, y+y^{&amp;rsquo;})$&lt;/li>
&lt;li>ä»¥ä¸Šé¢çš„å›¾åƒä¸ºä¾‹ã€‚åº”ç”¨è†¨èƒ€çš„æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°
&lt;img src="https://docs.opencv.org/4.5.5/Morphology_1_Tutorial_Theory_Dilation.png" alt="">&lt;/li>
&lt;/ul>
&lt;h3 id="è…èš€">è…èš€&lt;/h3>
&lt;ul>
&lt;li>å®ƒåœ¨ç»™å®šå†…æ ¸çš„åŒºåŸŸå†…è®¡ç®—å±€éƒ¨æœ€å°å€¼ã€‚å½“å†…æ ¸Båœ¨å›¾åƒä¸Šè¢«æ‰«ææ—¶ï¼Œæˆ‘ä»¬è®¡ç®—å‡ºè¢«Bé‡å çš„æœ€å°åƒç´ å€¼ï¼Œå¹¶ç”¨è¯¥æœ€å°å€¼æ›¿æ¢é”šç‚¹ä¸‹çš„å›¾åƒåƒç´ ã€‚&lt;/li>
&lt;li>è…èš€æ“ä½œä¸ºï¼š$dst(x, y)=min(x^{&amp;rsquo;}, y^{&amp;rsquo;})_{:element(x^{&amp;rsquo;}, y^{&amp;rsquo;}) \ne 0} src(x+x^{&amp;rsquo;}, y+y^{&amp;rsquo;})$&lt;/li>
&lt;li>ä¸è†¨èƒ€çš„ä¾‹å­ç±»ä¼¼ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹åŸå§‹å›¾åƒåº”ç”¨è…èš€ç®—å­ï¼ˆå¦‚ä¸Šå›¾ï¼‰ã€‚ä½ å¯ä»¥åœ¨ä¸‹é¢çš„ç»“æœä¸­çœ‹åˆ°ï¼Œå›¾åƒçš„äº®åŒºå˜è–„äº†ï¼Œè€Œæš—åŒºå˜å¤§äº†ã€‚
&lt;img src="https://docs.opencv.org/4.5.5/Morphology_1_Tutorial_Theory_Erosion.png" alt="">&lt;/li>
&lt;/ul>
&lt;h2 id="code">Code&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-cpp" data-lang="cpp">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#include&lt;/span> &lt;span style="color:#75715e">&amp;#34;basic/erosion_dilatation.hpp&amp;#34;&lt;/span>&lt;span style="color:#75715e">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">namespace&lt;/span> basic {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">namespace&lt;/span> erosion_dilatation {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">namespace&lt;/span> impl {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Mat src, erosion_dst, dilation_dst;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">int&lt;/span> erosion_elem &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">int&lt;/span> erosion_size &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">int&lt;/span> dilation_elem &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">int&lt;/span> dilation_size &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">int&lt;/span> &lt;span style="color:#66d9ef">const&lt;/span> max_elem &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">2&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">int&lt;/span> &lt;span style="color:#66d9ef">const&lt;/span> max_kernel_size &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">21&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">int&lt;/span> &lt;span style="color:#a6e22e">work&lt;/span>(&lt;span style="color:#66d9ef">int&lt;/span> argc, &lt;span style="color:#66d9ef">char&lt;/span> &lt;span style="color:#f92672">**&lt;/span>argv) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> CommandLineParser parser(argc, argv,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;{@input | ./images/LinuxLogo.jpg | input image}&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> src &lt;span style="color:#f92672">=&lt;/span> imread(samples&lt;span style="color:#f92672">::&lt;/span>findFile(parser.get&lt;span style="color:#f92672">&amp;lt;&lt;/span>String&lt;span style="color:#f92672">&amp;gt;&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;@input&amp;#34;&lt;/span>)), IMREAD_COLOR);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> (src.empty()) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> cout &lt;span style="color:#f92672">&amp;lt;&amp;lt;&lt;/span> &lt;span style="color:#e6db74">&amp;#34;Could not open or find the image!&lt;/span>&lt;span style="color:#ae81ff">\n&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&lt;/span> &lt;span style="color:#f92672">&amp;lt;&amp;lt;&lt;/span> endl;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> cout &lt;span style="color:#f92672">&amp;lt;&amp;lt;&lt;/span> &lt;span style="color:#e6db74">&amp;#34;Usage: &amp;#34;&lt;/span> &lt;span style="color:#f92672">&amp;lt;&amp;lt;&lt;/span> argv[&lt;span style="color:#ae81ff">0&lt;/span>] &lt;span style="color:#f92672">&amp;lt;&amp;lt;&lt;/span> &lt;span style="color:#e6db74">&amp;#34; &amp;lt;Input image&amp;gt;&amp;#34;&lt;/span> &lt;span style="color:#f92672">&amp;lt;&amp;lt;&lt;/span> endl;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#f92672">-&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> namedWindow(&lt;span style="color:#e6db74">&amp;#34;Erosion Demo&amp;#34;&lt;/span>, WINDOW_AUTOSIZE);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> namedWindow(&lt;span style="color:#e6db74">&amp;#34;Dilation Demo&amp;#34;&lt;/span>, WINDOW_AUTOSIZE);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> moveWindow(&lt;span style="color:#e6db74">&amp;#34;Dilation Demo&amp;#34;&lt;/span>, src.cols, &lt;span style="color:#ae81ff">0&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> createTrackbar(&lt;span style="color:#e6db74">&amp;#34;Element:&lt;/span>&lt;span style="color:#ae81ff">\n&lt;/span>&lt;span style="color:#e6db74"> 0: Rect &lt;/span>&lt;span style="color:#ae81ff">\n&lt;/span>&lt;span style="color:#e6db74"> 1: Cross &lt;/span>&lt;span style="color:#ae81ff">\n&lt;/span>&lt;span style="color:#e6db74"> 2: Ellipse&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;Erosion Demo&amp;#34;&lt;/span>, &lt;span style="color:#f92672">&amp;amp;&lt;/span>erosion_elem, max_elem, Erosion);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> createTrackbar(&lt;span style="color:#e6db74">&amp;#34;Kernel size:&lt;/span>&lt;span style="color:#ae81ff">\n&lt;/span>&lt;span style="color:#e6db74"> 2n +1&amp;#34;&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;Erosion Demo&amp;#34;&lt;/span>, &lt;span style="color:#f92672">&amp;amp;&lt;/span>erosion_size,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> max_kernel_size, Erosion);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> createTrackbar(&lt;span style="color:#e6db74">&amp;#34;Element:&lt;/span>&lt;span style="color:#ae81ff">\n&lt;/span>&lt;span style="color:#e6db74"> 0: Rect &lt;/span>&lt;span style="color:#ae81ff">\n&lt;/span>&lt;span style="color:#e6db74"> 1: Cross &lt;/span>&lt;span style="color:#ae81ff">\n&lt;/span>&lt;span style="color:#e6db74"> 2: Ellipse&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;Dilation Demo&amp;#34;&lt;/span>, &lt;span style="color:#f92672">&amp;amp;&lt;/span>dilation_elem, max_elem, Dilation);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> createTrackbar(&lt;span style="color:#e6db74">&amp;#34;Kernel size:&lt;/span>&lt;span style="color:#ae81ff">\n&lt;/span>&lt;span style="color:#e6db74"> 2n +1&amp;#34;&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;Dilation Demo&amp;#34;&lt;/span>, &lt;span style="color:#f92672">&amp;amp;&lt;/span>dilation_size,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> max_kernel_size, Dilation);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Erosion(&lt;span style="color:#ae81ff">0&lt;/span>, &lt;span style="color:#ae81ff">0&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Dilation(&lt;span style="color:#ae81ff">0&lt;/span>, &lt;span style="color:#ae81ff">0&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> waitKey(&lt;span style="color:#ae81ff">0&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">void&lt;/span> &lt;span style="color:#a6e22e">Erosion&lt;/span>(&lt;span style="color:#66d9ef">int&lt;/span>, &lt;span style="color:#66d9ef">void&lt;/span> &lt;span style="color:#f92672">*&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">int&lt;/span> erosion_type &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> (erosion_elem &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> erosion_type &lt;span style="color:#f92672">=&lt;/span> MORPH_RECT;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> } &lt;span style="color:#66d9ef">else&lt;/span> &lt;span style="color:#66d9ef">if&lt;/span> (erosion_elem &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> erosion_type &lt;span style="color:#f92672">=&lt;/span> MORPH_CROSS;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> } &lt;span style="color:#66d9ef">else&lt;/span> &lt;span style="color:#66d9ef">if&lt;/span> (erosion_elem &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#ae81ff">2&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> erosion_type &lt;span style="color:#f92672">=&lt;/span> MORPH_ELLIPSE;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Mat element &lt;span style="color:#f92672">=&lt;/span> getStructuringElement(
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> erosion_type, Size(&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#f92672">*&lt;/span> erosion_size &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>, &lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#f92672">*&lt;/span> erosion_size &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>),
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Point(erosion_size, erosion_size));
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> erode(src, erosion_dst, element);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> imshow(&lt;span style="color:#e6db74">&amp;#34;Erosion Demo&amp;#34;&lt;/span>, erosion_dst);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">void&lt;/span> &lt;span style="color:#a6e22e">Dilation&lt;/span>(&lt;span style="color:#66d9ef">int&lt;/span>, &lt;span style="color:#66d9ef">void&lt;/span> &lt;span style="color:#f92672">*&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">int&lt;/span> dilation_type &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> (dilation_elem &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> dilation_type &lt;span style="color:#f92672">=&lt;/span> MORPH_RECT;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> } &lt;span style="color:#66d9ef">else&lt;/span> &lt;span style="color:#66d9ef">if&lt;/span> (dilation_elem &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> dilation_type &lt;span style="color:#f92672">=&lt;/span> MORPH_CROSS;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> } &lt;span style="color:#66d9ef">else&lt;/span> &lt;span style="color:#66d9ef">if&lt;/span> (dilation_elem &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#ae81ff">2&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> dilation_type &lt;span style="color:#f92672">=&lt;/span> MORPH_ELLIPSE;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Mat element &lt;span style="color:#f92672">=&lt;/span> getStructuringElement(
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> dilation_type, Size(&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#f92672">*&lt;/span> dilation_size &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>, &lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#f92672">*&lt;/span> dilation_size &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>),
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Point(dilation_size, dilation_size));
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> dilate(src, dilation_dst, element);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> imshow(&lt;span style="color:#e6db74">&amp;#34;Dilation Demo&amp;#34;&lt;/span>, dilation_dst);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>} &lt;span style="color:#75715e">// namespace impl
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>} &lt;span style="color:#75715e">// namespace erosion_dilatation
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>} &lt;span style="color:#75715e">// namespace basic
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h4 id="ç¨‹åºåŠŸèƒ½">ç¨‹åºåŠŸèƒ½&lt;/h4>
&lt;ul>
&lt;li>åŠ è½½ä¸€ä¸ªå›¾åƒï¼ˆå¯ä»¥æ˜¯BGRæˆ–ç°åº¦ï¼‰ã€‚&lt;/li>
&lt;li>åˆ›å»ºä¸¤ä¸ªçª—å£ï¼ˆä¸€ä¸ªç”¨äºè†¨èƒ€è¾“å‡ºï¼Œå¦ä¸€ä¸ªç”¨äºä¾µèš€ï¼‰&lt;/li>
&lt;li>ä¸ºæ¯ä¸ªæ“ä½œåˆ›å»ºä¸€ç»„ä¸¤ä¸ª&lt;code>TraceBar&lt;/code>
&lt;ul>
&lt;li>&lt;code>erosion_elem&lt;/code> æˆ– &lt;code>dilation_elem&lt;/code>ï¼ˆçŸ©å½¢ã€åå­—ã€æ¤­åœ†ï¼‰&lt;/li>
&lt;li>å†…æ ¸å¤§å°&lt;code>kernel size&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h2 id="ç»“æœ">ç»“æœ&lt;/h2>
&lt;p>&lt;img src="https://i.imgur.com/4ZpgH4P.png" alt="">&lt;/p></description></item><item><title>OpenCV Blurring</title><link>https://fffzlfk.github.io/posts/opencv_blurring/</link><pubDate>Sun, 09 Jan 2022 07:37:09 +0800</pubDate><guid>https://fffzlfk.github.io/posts/opencv_blurring/</guid><description>&lt;h2 id="ç†è®º">ç†è®º&lt;/h2>
&lt;ul>
&lt;li>
&lt;p>&lt;code>Smoothing&lt;/code>ä¹Ÿå«&lt;code>blurring&lt;/code>ï¼ˆæ¨¡ç³ŠåŒ–ï¼‰ï¼Œæ˜¯ä¸€ä¸ªç®€å•è€Œå¸¸ç”¨çš„å›¾åƒå¤„ç†æ“ä½œã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;code>Smoothing&lt;/code>æœ‰å¾ˆå¤šåŸå› ã€‚åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†é‡ç‚¹è®¨è®ºå¹³æ»‘æ“ä½œï¼Œä»¥å‡å°‘å™ªéŸ³ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>ä¸ºäº†è¿›è¡Œå¹³æ»‘æ“ä½œï¼Œæˆ‘ä»¬å°†å¯¹æˆ‘ä»¬çš„å›¾åƒåº”ç”¨ä¸€ä¸ª&lt;code>filter&lt;/code>ã€‚æœ€å¸¸è§çš„&lt;code>filter&lt;/code>æ˜¯çº¿æ€§çš„ï¼Œå…¶ä¸­è¾“å‡ºåƒç´ çš„å€¼ï¼ˆå³ $g(i,j)$ ï¼‰ä¸ºè¾“å…¥åƒç´ å€¼çš„åŠ æƒå’Œï¼ˆå³ $f(i+k,j+l)$ ï¼‰ã€‚&lt;/p>
&lt;/li>
&lt;/ul>
&lt;p>$$
g(i, j) = \sum_{k, l}{f(i+k, j+l)h(k, l)}
$$&lt;/p>
&lt;ul>
&lt;li>
&lt;p>$h(k,l)$ è¢«ç§°ä¸º&lt;code>kernel&lt;/code>ï¼Œå®ƒåªä¸è¿‡æ˜¯&lt;code>filter&lt;/code>çš„ç³»æ•°ã€‚è¿™æœ‰åŠ©äºæŠŠæ»¤æ³¢å™¨æƒ³è±¡æˆä¸€ä¸ªåœ¨å›¾åƒä¸Šæ»‘åŠ¨çš„ç³»æ•°çª—å£ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>æ»¤æ³¢å™¨æœ‰å¾ˆå¤šç§ç±»ï¼Œè¿™é‡Œæˆ‘ä»¬å°†æåˆ°æœ€å¸¸ç”¨çš„å‡ ç§ã€‚&lt;/p>
&lt;/li>
&lt;/ul>
&lt;h2 id="normalized-box-filterå½’ä¸€åŒ–å—æ»¤æ³¢å™¨">Normalized Box Filterï¼ˆå½’ä¸€åŒ–å—æ»¤æ³¢å™¨ï¼‰&lt;/h2>
&lt;ul>
&lt;li>è¿™ä¸ªæ»¤æ³¢å™¨æ˜¯æœ€ç®€å•çš„ï¼Œæ¯ä¸ªè¾“å‡ºåƒç´ éƒ½æ˜¯å…¶å†…æ ¸é‚»å±…çš„å¹³å‡å€¼ï¼ˆæ‰€æœ‰çš„åƒç´ éƒ½æœ‰ç›¸åŒçš„æƒé‡ï¼‰ã€‚&lt;/li>
&lt;/ul>
&lt;p>$$
K = \frac{1}{K_{width} \cdot k_{height}}
\begin{bmatrix}
1 &amp;amp; 1 &amp;amp; 1 &amp;amp; &amp;hellip;&amp;amp; 1\\
1 &amp;amp; 1 &amp;amp; 1 &amp;amp; &amp;hellip;&amp;amp; 1\\
. &amp;amp; . &amp;amp; . &amp;amp; &amp;hellip;&amp;amp; 1\\
1 &amp;amp; 1 &amp;amp; 1 &amp;amp; &amp;hellip;&amp;amp; 1
\end{bmatrix}
$$&lt;/p>
&lt;h2 id="gaussian-filteré«˜æ–¯æ»¤æ³¢å™¨">Gaussian Filterï¼ˆé«˜æ–¯æ»¤æ³¢å™¨ï¼‰&lt;/h2>
&lt;ul>
&lt;li>
&lt;p>å¯èƒ½æ˜¯æœ€æœ‰ç”¨çš„æ»¤æ³¢å™¨ï¼ˆå°½ç®¡ä¸æ˜¯æœ€å¿«çš„ï¼‰ã€‚é«˜æ–¯æ»¤æ³¢æ˜¯é€šè¿‡ç”¨é«˜æ–¯å†…æ ¸å¯¹è¾“å…¥é˜µåˆ—ä¸­çš„æ¯ä¸ªç‚¹è¿›è¡Œå·ç§¯ï¼Œç„¶åå°†å®ƒä»¬å…¨éƒ¨ç›¸åŠ æ¥äº§ç”Ÿè¾“å‡ºé˜µåˆ—çš„ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>è®©æˆ‘ä»¬å›é¡¾ä¸€ä¸‹&lt;code>1D Gaussian kernel&lt;/code>æ˜¯ä»€ä¹ˆæ ·å­ï¼š
&lt;img src="https://docs.opencv.org/4.5.5/Smoothing_Tutorial_theory_gaussian_0.jpg" alt="">&lt;/p></description></item><item><title>Cudaè½¯ä»¶æ¶æ„</title><link>https://fffzlfk.github.io/posts/cuda%E8%BD%AF%E4%BB%B6%E6%9E%B6%E6%9E%84/</link><pubDate>Sat, 08 Jan 2022 06:27:04 +0800</pubDate><guid>https://fffzlfk.github.io/posts/cuda%E8%BD%AF%E4%BB%B6%E6%9E%B6%E6%9E%84/</guid><description>&lt;h2 id="ç¡¬ä»¶">ç¡¬ä»¶&lt;/h2>
&lt;ul>
&lt;li>
&lt;p>&lt;code>SP(Streaming Processor)&lt;/code>ï¼šæµå¤„ç†å™¨ï¼Œæ˜¯GPUæœ€åŸºæœ¬çš„å¤„ç†å•å…ƒï¼Œåœ¨&lt;code>fermi&lt;/code>æ¶æ„å¼€å§‹è¢«å«åš&lt;code>CUDA core&lt;/code>ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;code>SM(Streaming MultiProcessor)&lt;/code>ï¼šä¸€ä¸ªSMç”±å¤šä¸ª&lt;code>CUDA core&lt;/code>ç»„æˆã€‚&lt;/p>
&lt;/li>
&lt;/ul>
&lt;p>æ¯”å¦‚è¯´ï¼Œå¦‚æœä¸€ä¸ªGPUæœ‰ $4$ ä¸ª&lt;code>SM&lt;/code>ï¼Œå¹¶ä¸”æ¯ä¸ª&lt;code>SM&lt;/code>æœ‰ $768$ ä¸ª&lt;code>SP&lt;/code>(Aka &lt;code>CUDA core&lt;/code>)ï¼›é‚£ä¹ˆåœ¨æŸä¸€æ—¶åˆ»ï¼ŒçœŸæ­£å¹¶è¡Œè¿è¡Œçš„çº¿ç¨‹æ•°ä¸ä¼šè¶…è¿‡ $4 \times 768$ ä¸ªã€‚&lt;/p>
&lt;h2 id="è½¯ä»¶">è½¯ä»¶&lt;/h2>
&lt;p>&lt;code>threads&lt;/code>è¢«ç»„ç»‡æˆ&lt;code>blocks&lt;/code>ã€‚ä¸€ä¸ª&lt;code>block&lt;/code>çš„çº¿ç¨‹å¯ä»¥ç”¨&lt;code>1Dimension(x)&lt;/code>, &lt;code>2Dimensions(x, y)&lt;/code>æˆ–è€…&lt;code>3Dim indexs(x, y, z)&lt;/code> ç´¢å¼•ï¼Œ&lt;/p>
&lt;p>æ˜¾ç„¶ï¼Œå¦‚æœä½ éœ€è¦ $4 \times 768$ ä¸ªä»¥ä¸Šçš„&lt;code>threads&lt;/code>çš„è¯ä½ éœ€è¦ $4$ ä¸ªä»¥ä¸Šçš„&lt;code>blocks&lt;/code>ã€‚&lt;code>blocks&lt;/code>ä¹Ÿå¯ä»¥ä½¿ç”¨&lt;code>1D&lt;/code>, &lt;code>2D&lt;/code>æˆ–&lt;code>3D&lt;/code>ç´¢å¼•ï¼Œè¿™äº›&lt;code>blocks&lt;/code>è¢«æ”¾åœ¨ç­‰å¾…é˜Ÿåˆ—ä¸Šè¿›å…¥GPUæ‰§è¡Œã€‚&lt;/p>
&lt;h2 id="wrap">Wrap&lt;/h2>
&lt;p>å½“ä¸€ä¸ª&lt;code>kernel&lt;/code>è¢«æ‰§è¡Œæ—¶ï¼Œ&lt;code>grid&lt;/code>ä¸­çš„çº¿ç¨‹å—è¢«åˆ†é…åˆ°&lt;code>SM&lt;/code>ä¸Šã€‚ä¸€ä¸ª&lt;code>CUDA core&lt;/code>å¯ä»¥æ‰§è¡Œä¸€ä¸ª&lt;code>thread&lt;/code>ï¼Œä¸€ä¸ª&lt;code>SM&lt;/code>çš„&lt;code>CUDA core&lt;/code>ä¼šåˆ†æˆå‡ ä¸ª&lt;code>wrap&lt;/code>ï¼Œç”±&lt;code>wrap scheduler&lt;/code>è´Ÿè´£è°ƒåº¦ã€‚&lt;/p>
&lt;p>ä¸€ä¸ª&lt;code>wrap&lt;/code>ä¸­çš„çº¿ç¨‹åœ¨åŒä¸€ä¸ª&lt;code>block&lt;/code>ä¸­ï¼Œå¦‚æœ&lt;code>block&lt;/code>æ‰€å«çº¿ç¨‹æ•°ä¸æ˜¯&lt;code>wrap&lt;/code>çš„å¤§å°çš„æ•´æ•°å€ï¼Œé‚£ä¹ˆå¤šå‡ºæ¥çš„é‚£äº›&lt;code>thread&lt;/code>æ‰€åœ¨çš„&lt;code>wrap&lt;/code>ä¸­ï¼Œä¼šå‰©ä½™ä¸€äº›&lt;code>inactive&lt;/code>çš„&lt;code>thread&lt;/code>ã€‚&lt;/p>
&lt;h2 id="ä¸€ä¸ªç®€å•çš„case">ä¸€ä¸ªç®€å•çš„case&lt;/h2>
&lt;p>å¤„ç†ä¸€å¼  $512 \times 512$ çš„å›¾ç‰‡ã€‚&lt;/p>
&lt;p>å‡è®¾æˆ‘ä»¬å¸Œæœ›ä¸€ä¸ªçº¿ç¨‹å¤„ç†ä¸€ä¸ªåƒç´ &lt;code>pixel(i, j)&lt;/code>ã€‚&lt;/p>
&lt;p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ¯ $64$ ä¸ªçº¿ç¨‹çš„åŒºå—ã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦ $\frac{512 \times 512 }{64} = 4096$ ä¸ªåŒºå—ï¼ˆä¸ºäº†æ‹¥æœ‰ $512 \times 512 $ ä¸ªçº¿ç¨‹ ï¼‰ã€‚&lt;/p>
&lt;p>é€šå¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å°†çº¿ç¨‹ç»„ç»‡åœ¨&lt;code>2D&lt;/code>åŒºå—ä¸­ï¼ˆä¸ºäº†æ›´å®¹æ˜“ç´¢å¼•å›¾åƒåƒç´ ï¼‰ã€‚&lt;code>blockDim&lt;/code>= $8 * 8$ ï¼Œæˆ‘æ›´å–œæ¬¢å«å®ƒ&lt;code>threadsPerBlock&lt;/code>ã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-cpp" data-lang="cpp">&lt;span style="display:flex;">&lt;span>dim3 &lt;span style="color:#a6e22e">threadsPerBlock&lt;/span>(&lt;span style="color:#ae81ff">8&lt;/span>, &lt;span style="color:#ae81ff">8&lt;/span>);
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>è¿˜æœ‰&lt;code>2D&lt;/code>çš„&lt;code>gridDim&lt;/code>= $64 \times 64$ ï¼ˆéœ€è¦ $4096$ ä¸ªåŒºå—ï¼‰ã€‚æˆ‘æ›´å–œæ¬¢å«å®ƒ&lt;code>numBlocks&lt;/code>ã€‚&lt;/p></description></item><item><title>CodeForces 762</title><link>https://fffzlfk.github.io/posts/codeforces-762/</link><pubDate>Sun, 26 Dec 2021 17:18:09 +0800</pubDate><guid>https://fffzlfk.github.io/posts/codeforces-762/</guid><description>Codeforces Round #762 (Div. 3)</description></item><item><title>ä»æ¨¡æ¿å…ƒç¼–ç¨‹åˆ°constexpr(C++)</title><link>https://fffzlfk.github.io/posts/%E4%BB%8E%E6%A8%A1%E6%9D%BF%E5%85%83%E7%BC%96%E7%A8%8B%E5%88%B0constexprc++/</link><pubDate>Sun, 28 Nov 2021 19:43:10 +0800</pubDate><guid>https://fffzlfk.github.io/posts/%E4%BB%8E%E6%A8%A1%E6%9D%BF%E5%85%83%E7%BC%96%E7%A8%8B%E5%88%B0constexprc++/</guid><description>C++å…ƒç¼–ç¨‹</description></item><item><title>Goè®¾è®¡æ¨¡å¼</title><link>https://fffzlfk.github.io/posts/go%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/</link><pubDate>Sun, 18 Jul 2021 22:52:35 +0800</pubDate><guid>https://fffzlfk.github.io/posts/go%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/</guid><description>Go Design Scheme</description></item><item><title>ç½‘ç»œåº”ç”¨ç¨‹åºè®¾è®¡</title><link>https://fffzlfk.github.io/posts/%E7%BD%91%E7%BB%9C%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1/</link><pubDate>Wed, 07 Apr 2021 20:48:12 +0800</pubDate><guid>https://fffzlfk.github.io/posts/%E7%BD%91%E7%BB%9C%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1/</guid><description>Network Program Design for Application</description></item><item><title>åˆ†å¸ƒå¼è®¡ç®—</title><link>https://fffzlfk.github.io/posts/%E5%88%86%E5%B8%83%E5%BC%8F%E8%AE%A1%E7%AE%97/</link><pubDate>Sat, 13 Mar 2021 13:57:34 +0800</pubDate><guid>https://fffzlfk.github.io/posts/%E5%88%86%E5%B8%83%E5%BC%8F%E8%AE%A1%E7%AE%97/</guid><description>Distributed Computing</description></item><item><title>ç¼–è¯‘åŸç†</title><link>https://fffzlfk.github.io/posts/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86/</link><pubDate>Thu, 11 Mar 2021 10:51:32 +0800</pubDate><guid>https://fffzlfk.github.io/posts/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86/</guid><description>Compiler Principles</description></item><item><title>ç‰›é¡¿æ³•æ±‚å¹³æ–¹æ ¹</title><link>https://fffzlfk.github.io/posts/%E7%89%9B%E9%A1%BF%E6%B3%95%E6%B1%82%E5%B9%B3%E6%96%B9%E6%A0%B9/</link><pubDate>Tue, 23 Feb 2021 17:18:19 +0800</pubDate><guid>https://fffzlfk.github.io/posts/%E7%89%9B%E9%A1%BF%E6%B3%95%E6%B1%82%E5%B9%B3%E6%96%B9%E6%A0%B9/</guid><description>Newton&amp;rsquo;s method for the square root</description></item><item><title>å­æ•°ç»„å’Œé—®é¢˜</title><link>https://fffzlfk.github.io/posts/%E5%AD%90%E6%95%B0%E7%BB%84%E5%92%8C%E9%97%AE%E9%A2%98/</link><pubDate>Sun, 21 Feb 2021 22:46:48 +0800</pubDate><guid>https://fffzlfk.github.io/posts/%E5%AD%90%E6%95%B0%E7%BB%84%E5%92%8C%E9%97%AE%E9%A2%98/</guid><description>the Sum of Subsequence</description></item><item><title>Pythonè£…é¥°å™¨</title><link>https://fffzlfk.github.io/posts/python%E8%A3%85%E9%A5%B0%E5%99%A8/</link><pubDate>Tue, 02 Feb 2021 14:23:44 +0800</pubDate><guid>https://fffzlfk.github.io/posts/python%E8%A3%85%E9%A5%B0%E5%99%A8/</guid><description>Python decorator</description></item><item><title>æ¯æ—¥ä¸€é¢˜</title><link>https://fffzlfk.github.io/posts/%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98/</link><pubDate>Sun, 10 Jan 2021 00:00:00 +0000</pubDate><guid>https://fffzlfk.github.io/posts/%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98/</guid><description>Algorithms Problems</description></item><item><title>SQL</title><link>https://fffzlfk.github.io/posts/sql/</link><pubDate>Sat, 24 Oct 2020 20:22:42 +0800</pubDate><guid>https://fffzlfk.github.io/posts/sql/</guid><description>SQL è¯­å¥</description></item><item><title>å¾®æœºåŸç†</title><link>https://fffzlfk.github.io/posts/%E5%BE%AE%E6%9C%BA%E5%8E%9F%E7%90%86/</link><pubDate>Sat, 17 Oct 2020 21:07:26 +0800</pubDate><guid>https://fffzlfk.github.io/posts/%E5%BE%AE%E6%9C%BA%E5%8E%9F%E7%90%86/</guid><description>è¥¿ç”µå¾®æœºåŸç†</description></item><item><title>C++(ä¸´æ—¶å¯¹è±¡çš„åˆ†æ)</title><link>https://fffzlfk.github.io/posts/c++%E4%B8%B4%E6%97%B6%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%88%86%E6%9E%90/</link><pubDate>Sat, 10 Oct 2020 00:00:00 +0000</pubDate><guid>https://fffzlfk.github.io/posts/c++%E4%B8%B4%E6%97%B6%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%88%86%E6%9E%90/</guid><description>å…³é—­ç¼–è¯‘å™¨ä¼˜åŒ–</description></item><item><title>ç®—æ³•ï¼ˆç¬¬å››ç‰ˆï¼‰</title><link>https://fffzlfk.github.io/posts/algorithm4th/</link><pubDate>Fri, 09 Oct 2020 00:00:00 +0000</pubDate><guid>https://fffzlfk.github.io/posts/algorithm4th/</guid><description>The solution of algs4&amp;rsquo;s exercise</description></item><item><title>OOP(C++)</title><link>https://fffzlfk.github.io/posts/oopc++/</link><pubDate>Tue, 06 Oct 2020 12:25:11 +0800</pubDate><guid>https://fffzlfk.github.io/posts/oopc++/</guid><description>Object-Oriented Programming</description></item><item><title>æ³°å‹’å…¬å¼æ€»ç»“</title><link>https://fffzlfk.github.io/posts/%E6%B3%B0%E5%8B%92%E5%85%AC%E5%BC%8F%E6%80%BB%E7%BB%93/</link><pubDate>Fri, 31 Jul 2020 22:41:12 +0800</pubDate><guid>https://fffzlfk.github.io/posts/%E6%B3%B0%E5%8B%92%E5%85%AC%E5%BC%8F%E6%80%BB%E7%BB%93/</guid><description>Taylor formula</description></item><item><title>Archive</title><link>https://fffzlfk.github.io/archives/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://fffzlfk.github.io/archives/</guid><description>archives</description></item><item><title>Search</title><link>https://fffzlfk.github.io/search/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://fffzlfk.github.io/search/</guid><description/></item></channel></rss>